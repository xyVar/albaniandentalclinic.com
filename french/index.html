<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Clinique Dentaire Albanaise - R√©seau de cliniques dentaires certifi√©es en Albanie. √âconomisez jusqu'√† 75% sur les implants et traitements dentaires. 10+ ans d'exp√©rience, 4.8 √©toiles Google.">
    <meta name="theme-color" content="#1a365d">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Meta Domain Verification -->
    <meta name="facebook-domain-verification" content="ryldelrcctqjjaxntgw0e8b5afd218" />

    <title>Clinique Dentaire Albanaise | R√©seau de Cliniques Certifi√©es | √âconomisez 75%</title>

    <!-- Consent Mode v2 - Initialize FIRST -->
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('consent', 'default', {
        'ad_storage': 'granted',
        'analytics_storage': 'granted',
        'ad_user_data': 'granted',
        'ad_personalization': 'granted'
    });
    </script>

    <!-- Google tag (gtag.js) - GA4 + Google Ads -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-74JG2X3NB8"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-74JG2X3NB8', {
        'send_page_view': true,
        'allow_google_signals': true,
        'allow_ad_personalization_signals': true,
        'cookie_flags': 'SameSite=None;Secure'
    });
    gtag('config', 'AW-17825998174', {
        'allow_enhanced_conversions': true
    });
    </script>

    <!-- Meta Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1140066248291201');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1140066248291201&ev=PageView&noscript=1"/></noscript>
    <!-- End Meta Pixel Code -->

    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* ========================================
           CSS RESET & BASE
           ======================================== */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --primary: #1a365d;
            --primary-light: #2c5282;
            --accent: #e53e3e;
            --accent-hover: #c53030;
            --success: #38a169;
            --gold: #d69e2e;
            --white: #ffffff;
            --gray-50: #f7fafc;
            --gray-100: #edf2f7;
            --gray-200: #e2e8f0;
            --gray-500: #718096;
            --gray-700: #4a5568;
            --gray-900: #1a202c;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 25px rgba(0,0,0,0.15);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
        }

        html {
            font-size: 16px;
            -webkit-text-size-adjust: 100%;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.5;
            color: var(--gray-900);
            background: var(--white);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }

        img {
            max-width: 100%;
            height: auto;
            display: block;
        }

        a {
            color: inherit;
            text-decoration: none;
        }

        button {
            font-family: inherit;
            cursor: pointer;
            border: none;
            background: none;
        }

        /* ========================================
           UTILITY CLASSES
           ======================================== */
        .container {
            width: 100%;
            max-width: 480px;
            margin: 0 auto;
            padding: 0 16px;
        }

        @media (min-width: 768px) {
            .container {
                max-width: 720px;
                padding: 0 24px;
            }
        }

        @media (min-width: 992px) {
            .container {
                max-width: 1200px;
                padding: 0 40px;
            }
        }

        @media (min-width: 1200px) {
            .container {
                max-width: 1400px;
                padding: 0 60px;
            }
        }

        @media (min-width: 1600px) {
            .container {
                max-width: 1600px;
                padding: 0 80px;
            }
        }

        .text-center { text-align: center; }
        .text-white { color: var(--white); }
        .text-accent { color: var(--accent); }
        .text-success { color: var(--success); }
        .text-gold { color: var(--gold); }
        .text-gray { color: var(--gray-500); }
        .font-bold { font-weight: 700; }
        .font-extrabold { font-weight: 800; }

        /* Scroll offset for fixed navbar */
        [id] {
            scroll-margin-top: 120px;
        }

        section[id] {
            scroll-margin-top: 120px;
        }

        /* ========================================
           TRUST BAR (Top) - Horizontal Scroll
           ======================================== */
        .trust-bar {
            background: var(--primary);
            color: var(--white);
            padding: 0;
            overflow: hidden;
            height: 40px;
            position: relative;
        }

        .trust-bar-scroll {
            display: flex;
            gap: 0;
            animation: scrollTrustBar 30s linear infinite;
            width: max-content;
            height: 100%;
            align-items: center;
        }

        .trust-bar-scroll:hover {
            animation-play-state: paused;
        }

        @keyframes scrollTrustBar {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .trust-bar-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            white-space: nowrap;
            font-size: 0.8rem;
            font-weight: 500;
            border-right: 1px solid rgba(255,255,255,0.1);
            cursor: pointer;
            transition: background 0.2s ease;
            text-decoration: none;
            color: var(--white);
            height: 100%;
        }

        .trust-bar-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .trust-bar-item i {
            color: var(--gold);
            font-size: 0.9rem;
        }

        /* ========================================
           HEADER / NAVIGATION - San Marco Style
           ======================================== */
        .navbar {
            background: var(--white);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
        }

        .navbar-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1600px;
            margin: 0 auto;
            padding: 12px 20px;
            width: 100%;
        }

        /* Logo Styling - Christmas Theme */
        .navbar-logo {
            display: flex;
            align-items: center;
            gap: 4px;
            text-decoration: none;
        }

        .navbar-logo-img {
            height: 50px;
            width: auto;
        }

        .navbar-logo-text {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .navbar-logo-main {
            font-family: 'Times New Roman', Georgia, serif;
            font-size: 2.2rem;
            font-weight: 700;
            color: #8B0000;
            letter-spacing: 8px;
            line-height: 1;
            position: relative;
            display: flex;
        }

        .navbar-logo-main .letter-a {
            position: relative;
        }

        /* Santa hat removed */

        .navbar-logo-sub {
            display: flex;
            gap: 8px;
            font-family: 'Times New Roman', Georgia, serif;
            font-size: 0.5rem;
            color: #8B0000;
            letter-spacing: 0.5px;
            margin-top: 4px;
        }

        .navbar-logo-sub span {
            position: relative;
        }

        /* Christmas garland decoration */
        .navbar-logo-text::after {
            content: 'üéÑ';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.6rem;
            display: none;
        }

        /* Desktop Navigation Menu */
        .navbar-menu {
            display: none;
            list-style: none;
            gap: 4px;
            margin: 0;
            padding: 0;
            align-items: center;
        }

        .navbar-menu li {
            position: relative;
        }

        .navbar-menu a {
            display: block;
            padding: 12px 18px;
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--gray-700);
            transition: all 0.2s ease;
            white-space: nowrap;
            border-radius: var(--radius-sm);
        }

        .navbar-menu a:hover {
            color: var(--primary);
            background: var(--gray-50);
        }

        /* Dropdown Menu */
        .navbar-dropdown {
            position: relative;
        }

        .navbar-dropdown > a {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .navbar-dropdown > a::after {
            content: '';
            border: solid var(--gray-500);
            border-width: 0 2px 2px 0;
            padding: 3px;
            transform: rotate(45deg);
            transition: transform 0.2s;
            margin-left: 2px;
        }

        .navbar-dropdown.open > a::after {
            transform: rotate(-135deg);
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background: var(--white);
            min-width: 260px;
            border-radius: var(--radius-md);
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.3s ease;
            padding: 12px 0;
            z-index: 100;
        }

        .navbar-dropdown.open .dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-menu a {
            padding: 14px 24px;
            font-size: 0.9rem;
            border-radius: 0;
            display: flex;
            align-items: center;
        }

        .dropdown-menu a:hover {
            background: linear-gradient(90deg, var(--gray-50) 0%, transparent 100%);
            color: var(--primary);
            padding-left: 28px;
        }

        .dropdown-menu a i {
            width: 24px;
            font-size: 0.85rem;
        }

        /* CTA Button */
        .navbar-cta {
            display: none;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: var(--white);
            padding: 14px 28px;
            border-radius: 100px;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
            white-space: nowrap;
        }

        .navbar-cta:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.5);
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
        }

        /* Mobile Menu Toggle */
        .navbar-toggle {
            display: flex;
            flex-direction: column;
            gap: 5px;
            padding: 8px;
            cursor: pointer;
            background: none;
            border: none;
        }

        .navbar-toggle span {
            width: 24px;
            height: 2px;
            background: var(--gray-700);
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .navbar-toggle.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        .navbar-toggle.active span:nth-child(2) {
            opacity: 0;
        }

        .navbar-toggle.active span:nth-child(3) {
            transform: rotate(-45deg) translate(5px, -5px);
        }

        /* Mobile Header CTA */
        .navbar-mobile-cta {
            background: var(--accent);
            color: var(--white);
            padding: 10px 16px;
            border-radius: 100px;
            font-size: 0.85rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: background 0.2s;
        }

        .navbar-mobile-cta:active {
            background: var(--accent-hover);
        }

        /* Header Form Button (Red) - Desktop Only */
        .navbar-form-btn {
            display: none;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
            border: none;
            border-radius: 100px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(220,38,38,0.4);
            transition: all 0.3s ease;
            color: white;
            font-size: 0.95rem;
            font-weight: 600;
        }

        .navbar-form-btn i {
            font-size: 0.9rem;
        }

        .navbar-form-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(220,38,38,0.5);
        }

        .navbar-form-btn:active {
            transform: scale(0.95);
        }

        @media (min-width: 992px) {
            .navbar-form-btn {
                display: flex;
            }
        }

        /* Mobile Slide-out Menu */
        .mobile-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
            z-index: 1001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .mobile-menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .mobile-menu {
            position: fixed;
            top: 0;
            right: -100%;
            width: 85%;
            max-width: 320px;
            height: 100%;
            background: var(--white);
            z-index: 1002;
            transition: right 0.3s ease;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .mobile-menu.active {
            right: 0;
        }

        .mobile-menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid var(--gray-200);
        }

        .mobile-menu-close {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--gray-100);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--gray-700);
            cursor: pointer;
            border: none;
        }

        .mobile-menu-nav {
            flex: 1;
            padding: 16px 0;
        }

        .mobile-menu-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .mobile-menu-nav a {
            display: block;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 500;
            color: var(--gray-700);
            border-bottom: 1px solid var(--gray-100);
            transition: all 0.2s;
        }

        .mobile-menu-nav a:hover,
        .mobile-menu-nav a:active {
            background: var(--gray-50);
            color: var(--primary);
        }

        .mobile-menu-nav .menu-section-title {
            padding: 14px 24px 8px;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: none;
        }

        .mobile-menu-footer {
            padding: 20px;
            border-top: 1px solid var(--gray-200);
            background: var(--gray-50);
        }

        .mobile-menu-footer .btn {
            width: 100%;
            margin-bottom: 12px;
        }

        .mobile-menu-footer .btn:last-child {
            margin-bottom: 0;
        }

        .mobile-menu-contact {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--gray-200);
        }

        .mobile-menu-contact a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 0;
            font-size: 0.9rem;
            color: var(--gray-700);
            border-bottom: none;
        }

        .mobile-menu-contact i {
            width: 20px;
            color: var(--accent);
        }

        /* Desktop Breakpoint */
        @media (min-width: 992px) {
            .navbar-container {
                padding: 20px 50px;
            }

            .navbar-toggle {
                display: none;
            }

            .navbar-mobile-cta {
                display: none;
            }

            .navbar-menu {
                display: flex;
            }

            .navbar-cta {
                display: block;
            }

            .navbar-logo-main {
                font-size: 3.5rem;
                letter-spacing: 12px;
            }

            .navbar-logo-sub {
                font-size: 0.8rem;
                gap: 24px;
                letter-spacing: 2px;
            }

            .navbar-menu a {
                padding: 14px 22px;
                font-size: 1.1rem;
            }

            .navbar-cta {
                padding: 18px 36px;
                font-size: 1.1rem;
            }
        }

        /* Large Desktop */
        @media (min-width: 1200px) {
            .navbar-container {
                padding: 24px 80px;
            }

            .navbar-logo-main {
                font-size: 4rem;
                letter-spacing: 14px;
            }

            .navbar-logo-sub {
                font-size: 0.9rem;
                gap: 28px;
            }

            .navbar-menu a {
                padding: 16px 26px;
                font-size: 1.2rem;
            }

            .navbar-cta {
                padding: 20px 40px;
                font-size: 1.2rem;
            }
        }

        /* Old header classes for backward compatibility */
        .header {
            display: none;
        }

        /* ========================================
           HERO SECTION
           ======================================== */
        .hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: var(--white);
            padding: 32px 16px 40px;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            pointer-events: none;
        }

        .hero .container {
            width: 100%;
        }

        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            padding: 6px 12px;
            border-radius: 100px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .hero-badge i {
            color: var(--gold);
        }

        .hero h1 {
            font-size: 1.75rem;
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: 12px;
            letter-spacing: -0.5px;
        }

        .hero-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 24px;
            line-height: 1.5;
        }

        .hero-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        /* Hero Desktop Layout */
        @media (min-width: 992px) {
            .hero {
                padding: 60px 16px 80px;
            }

            .hero .container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 60px;
                align-items: center;
            }

            .hero-content {
                text-align: left;
            }

            .hero h1 {
                font-size: 2.8rem;
                margin-bottom: 20px;
            }

            .hero-subtitle {
                font-size: 1.2rem;
                margin-bottom: 0;
            }

            .hero-badge {
                margin-bottom: 24px;
            }
        }

        @media (min-width: 1200px) {
            .hero h1 {
                font-size: 3.5rem;
            }

            .hero-subtitle {
                font-size: 1.3rem;
            }
        }

        @media (min-width: 1600px) {
            .hero {
                padding: 80px 16px 100px;
            }

            .hero h1 {
                font-size: 4rem;
            }

            .hero-subtitle {
                font-size: 1.5rem;
            }
        }

        /* Hero Clinic Card - with Carousel */
        .hero-clinic-card {
            position: relative;
            border-radius: var(--radius-lg);
            overflow: hidden;
            cursor: pointer;
            box-shadow: var(--shadow-xl);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-top: 20px;
        }

        .hero-clinic-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .hero-clinic-card:active {
            transform: scale(0.98);
        }

        /* Hero Carousel Container */
        .hero-carousel {
            position: relative;
            width: 100%;
            height: 220px;
            overflow: hidden;
        }

        .hero-carousel-track {
            display: flex;
            height: 100%;
            transition: transform 0.5s ease;
        }

        .hero-carousel-slide {
            min-width: 100%;
            height: 100%;
        }

        .hero-carousel-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Carousel Dots */
        .hero-carousel-dots {
            position: absolute;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 6px;
            z-index: 10;
        }

        .hero-carousel-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .hero-carousel-dot.active {
            background: var(--white);
            width: 18px;
            border-radius: 3px;
        }

        .hero-clinic-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            padding: 40px 16px 16px;
        }

        .hero-clinic-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: var(--success);
            color: var(--white);
            padding: 4px 10px;
            border-radius: 100px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .hero-clinic-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 4px;
        }

        .hero-clinic-cta {
            font-size: 0.85rem;
            color: var(--gold);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        @media (min-width: 768px) {
            .hero-carousel {
                height: 280px;
            }

            .hero-clinic-overlay {
                padding: 50px 20px 20px;
            }

            .hero-clinic-name {
                font-size: 1.4rem;
            }
        }

        @media (min-width: 992px) {
            .hero-clinic-card {
                margin-top: 0;
                max-width: 550px;
            }

            .hero-carousel {
                height: 320px;
            }

            .hero-clinic-badge {
                font-size: 0.8rem;
                padding: 6px 12px;
            }

            .hero-clinic-name {
                font-size: 1.5rem;
            }

            .hero-clinic-cta {
                font-size: 0.95rem;
            }
        }

        @media (min-width: 1200px) {
            .hero-clinic-card {
                max-width: 600px;
            }

            .hero-carousel {
                height: 360px;
            }

            .hero-clinic-name {
                font-size: 1.6rem;
            }
        }

        @media (min-width: 1600px) {
            .hero-clinic-card {
                max-width: 700px;
            }

            .hero-carousel {
                height: 400px;
            }

            .hero-clinic-overlay {
                padding: 60px 24px 24px;
            }

            .hero-clinic-name {
                font-size: 1.8rem;
            }

            .hero-clinic-cta {
                font-size: 1rem;
            }
        }

        /* ========================================
           NEW HERO - PRICE FOCUSED (Premium)
           ======================================== */
        .hero-price-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin: 28px 0;
            max-width: 100%;
        }

        .hero-price-card {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 16px;
            padding: 24px 18px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(26,54,93,0.08);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0,0,0,0.12);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .hero-price-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #d69e2e, #ecc94b, #d69e2e);
        }

        .hero-price-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(214,158,46,0.08), transparent);
            transition: left 0.5s ease;
            pointer-events: none;
        }

        .hero-price-card:hover::after {
            left: 100%;
        }

        .hero-price-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 48px rgba(0,0,0,0.18);
            border-color: rgba(214,158,46,0.4);
        }

        .hero-price-card:active {
            transform: scale(0.98);
        }

        .hero-price-icon {
            width: 52px;
            height: 52px;
            margin: 0 auto 14px;
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: #ecc94b;
            box-shadow: 0 4px 16px rgba(26,54,93,0.35);
            flex-shrink: 0;
        }

        .hero-price-title {
            font-size: 0.72rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            margin-bottom: 10px;
            color: #1a365d;
        }

        .hero-price-main {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #1a365d, #2c5282);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
            margin-bottom: 8px;
        }

        .hero-price-detail {
            font-size: 0.7rem;
            color: #4a5568;
            margin-bottom: 10px;
            line-height: 1.4;
            font-weight: 500;
            min-height: 2.8em;
        }

        .hero-price-comparison {
            display: inline-block;
            font-size: 0.65rem;
            color: #718096;
            margin-bottom: 16px;
            padding: 5px 12px;
            background: #f0f4f8;
            border-radius: 20px;
            font-weight: 500;
        }

        .hero-price-cta {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            background: linear-gradient(135deg, #d69e2e 0%, #ecc94b 50%, #d69e2e 100%);
            background-size: 200% 100%;
            color: #1a365d;
            padding: 14px 18px;
            border-radius: 10px;
            font-size: 0.72rem;
            font-weight: 700;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            box-shadow: 0 4px 16px rgba(214,158,46,0.4);
            margin-top: auto;
        }

        .hero-price-cta-call {
            background: linear-gradient(135deg, #22c55e 0%, #4ade80 50%, #22c55e 100%);
            background-size: 200% 100%;
            box-shadow: 0 4px 16px rgba(34,197,94,0.4);
            color: #ffffff;
        }

        .hero-price-cta i {
            font-size: 0.9rem;
        }

        .hero-price-card:hover .hero-price-cta {
            background-position: 100% 0;
            box-shadow: 0 6px 24px rgba(214,158,46,0.55);
            transform: scale(1.02);
        }

        .hero-price-card:hover .hero-price-cta-call {
            box-shadow: 0 6px 24px rgba(34,197,94,0.55);
        }

        .hero-trust-bar {
            display: flex;
            justify-content: center;
            gap: 12px;
            font-size: 0.72rem;
            flex-wrap: wrap;
            margin-top: 16px;
        }

        .hero-trust-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            background: rgba(255,255,255,0.12);
            border-radius: 24px;
            backdrop-filter: blur(4px);
        }

        .hero-trust-item i {
            color: #ecc94b;
            font-size: 0.8rem;
        }

        @media (min-width: 768px) {
            .hero-price-cards {
                max-width: 500px;
                margin: 36px auto;
                gap: 24px;
            }
            .hero-price-card {
                padding: 28px 24px 24px;
            }
            .hero-price-icon {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
                margin-bottom: 16px;
            }
            .hero-price-title {
                font-size: 0.78rem;
                margin-bottom: 12px;
            }
            .hero-price-main {
                font-size: 2.8rem;
                margin-bottom: 10px;
            }
            .hero-price-detail {
                font-size: 0.75rem;
            }
            .hero-price-cta {
                padding: 16px 22px;
                font-size: 0.78rem;
            }
        }

        @media (min-width: 992px) {
            .hero-price-cards {
                max-width: 540px;
                margin: 36px 0;
            }
        }

        /* ========================================
           BRAND LOGOS STRIP - Premium Professional
           ======================================== */
        .hero-brands {
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 50%, #1a365d 100%);
            border-radius: 14px;
            padding: 22px 20px;
            margin: 24px 0;
            border: 2px solid rgba(255,255,255,0.12);
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .hero-brands::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.08), transparent);
            transition: left 0.5s ease;
            pointer-events: none;
        }

        .hero-brands:hover::before {
            left: 100%;
        }

        .hero-brands:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.3);
            border-color: rgba(255,255,255,0.2);
        }

        .hero-brands-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 16px;
        }

        .hero-brands-icon {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #d69e2e, #ecc94b);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1a365d;
            font-size: 0.8rem;
            flex-shrink: 0;
        }

        .hero-brands-label {
            font-size: 0.68rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: rgba(255,255,255,0.95);
            font-weight: 700;
        }

        .hero-brands-logos {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-bottom: 16px;
            justify-items: center;
            align-items: center;
        }

        .hero-brand-logo {
            height: 36px;
            width: 100%;
            max-width: 60px;
            object-fit: contain;
            background: white;
            padding: 6px 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .hero-brand-logo:hover {
            transform: scale(1.1) translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }

        .hero-brands-cta {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            color: #ecc94b;
            font-size: 0.72rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .hero-brands-cta i {
            transition: transform 0.3s ease;
            font-size: 0.8rem;
        }

        .hero-brands:hover .hero-brands-cta i {
            transform: translateX(4px);
        }

        @media (min-width: 768px) {
            .hero-brands {
                max-width: 560px;
                margin: 28px auto;
                padding: 24px 32px;
            }
            .hero-brand-logo {
                height: 40px;
                max-width: 72px;
                padding: 8px 10px;
            }
            .hero-brands-logos {
                gap: 14px;
            }
            .hero-brands-label {
                font-size: 0.72rem;
                letter-spacing: 2px;
            }
            .hero-brands-cta {
                font-size: 0.76rem;
            }
        }

        @media (min-width: 992px) {
            .hero-brands {
                max-width: 580px;
                margin: 28px 0;
            }
            .hero-brand-logo {
                height: 44px;
                max-width: 80px;
            }
            .hero-brands-logos {
                gap: 18px;
            }
        }

        /* Mobile: 3 + 2 layout for 5 logos */
        @media (max-width: 400px) {
            .hero-brands-logos {
                grid-template-columns: repeat(3, 1fr);
            }
            .hero-brand-logo:nth-child(4),
            .hero-brand-logo:nth-child(5) {
                grid-column: span 1;
            }
            .hero-brand-logo {
                max-width: 55px;
                height: 32px;
            }
        }

        /* ========================================
           PRICING CARDS - 3D INTERACTIVE BUTTONS
           ======================================== */
        .pricing-section {
            padding: 32px 16px;
            background: var(--gray-50);
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 8px;
            color: var(--gray-900);
        }

        .section-subtitle {
            font-size: 0.9rem;
            color: var(--gray-500);
            text-align: center;
            margin-bottom: 24px;
        }

        .pricing-grid {
            display: grid;
            gap: 16px;
        }

        @media (min-width: 768px) {
            .pricing-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 24px;
            }
        }

        @media (min-width: 992px) {
            .pricing-section {
                padding: 60px 16px;
            }

            .pricing-grid {
                gap: 32px;
            }

            .section-title {
                font-size: 2rem;
                margin-bottom: 12px;
            }

            .section-subtitle {
                font-size: 1.1rem;
                margin-bottom: 40px;
            }
        }

        .pricing-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 0;
            box-shadow: 0 4px 0 var(--gray-300), var(--shadow-lg);
            cursor: pointer;
            transition: all 0.15s ease;
            transform: translateY(0);
            border: 2px solid var(--gray-100);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .pricing-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 0 var(--gray-300), var(--shadow-xl);
        }

        .pricing-card:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 var(--gray-300), var(--shadow-sm);
        }

        .pricing-card-image {
            width: 100%;
            height: 120px;
            object-fit: contain;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 16px;
        }

        @media (min-width: 768px) {
            .pricing-card-image {
                height: 160px;
                padding: 20px;
            }

            .pricing-info h3 {
                font-size: 1.1rem;
            }

            .pricing-value .price-range {
                font-size: 1.2rem;
            }
        }

        @media (min-width: 992px) {
            .pricing-card-image {
                height: 180px;
            }

            .pricing-card-content {
                padding: 20px;
            }

            .pricing-card:hover {
                transform: translateY(-6px);
                box-shadow: 0 10px 0 var(--gray-300), var(--shadow-xl);
            }
        }

        .pricing-card-content {
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--white);
        }

        .pricing-info {
            flex: 1;
        }

        .pricing-info h3 {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 4px;
            color: var(--gray-900);
        }

        .pricing-info .brand {
            font-size: 0.75rem;
            color: var(--gray-500);
            display: block;
        }

        .pricing-value {
            text-align: right;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .pricing-value .price-label {
            font-size: 0.65rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 2px;
        }

        .pricing-value .price-range {
            font-size: 1.1rem;
            font-weight: 800;
            color: var(--accent);
            line-height: 1.2;
        }

        .pricing-value .tap-hint {
            font-size: 0.7rem;
            color: var(--primary);
            margin-top: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
            font-weight: 600;
        }

        /* ========================================
           SERVICE CATEGORIES SECTION (San Marco Style)
           ======================================== */
        .service-categories-section {
            padding: 60px 16px;
            background: linear-gradient(180deg, #f8fafc 0%, #ffffff 100%);
        }

        .service-categories-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .service-categories-header .label {
            color: var(--primary);
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 12px;
            display: block;
        }

        .service-categories-header h2 {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--gray-900);
            margin-bottom: 16px;
        }

        .service-categories-header p {
            color: var(--gray-600);
            font-size: 1rem;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .service-categories-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        @media (min-width: 576px) {
            .service-categories-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 992px) {
            .service-categories-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            .service-categories-header h2 {
                font-size: 2.2rem;
            }
        }

        .service-category-card {
            background: linear-gradient(145deg, #e8f4fc 0%, #f0f7fc 50%, #e0f0fa 100%);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid rgba(59, 130, 246, 0.1);
        }

        .service-category-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(59, 130, 246, 0.15);
        }

        .service-category-card h3 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 8px;
        }

        .service-category-card .price-from {
            font-size: 0.9rem;
            color: var(--gray-500);
            margin-bottom: 16px;
        }

        .service-category-card .card-image {
            width: 100%;
            height: 140px;
            object-fit: contain;
            margin-bottom: 16px;
        }

        .service-category-card .btn-scopri {
            background: white;
            color: var(--gray-700);
            border: 1px solid var(--gray-300);
            padding: 10px 24px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .service-category-card .btn-scopri:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* ========================================
           ALL-ON-4 TREATMENT PLAN SECTION
           ======================================== */
        .treatment-plan-section {
            padding: 60px 16px;
            background: white;
        }

        .treatment-plan-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .treatment-plan-header h2 {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--gray-900);
            margin-bottom: 12px;
        }

        .treatment-plan-header p {
            color: var(--gray-600);
            font-size: 1rem;
        }

        @media (min-width: 992px) {
            .treatment-plan-header h2 {
                font-size: 2.2rem;
            }
        }

        .treatment-plan-grid {
            display: flex;
            flex-direction: column;
            gap: 24px;
            max-width: 1200px;
            margin: 0 auto;
            align-items: center;
        }

        @media (min-width: 768px) {
            .treatment-plan-grid {
                flex-direction: row;
                justify-content: center;
                align-items: stretch;
            }
        }

        .treatment-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            max-width: 360px;
            width: 100%;
            border: 2px solid var(--gray-200);
            transition: all 0.3s ease;
        }

        .treatment-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.12);
        }

        .treatment-card.featured {
            border-color: var(--primary);
            box-shadow: 0 8px 30px rgba(37, 99, 235, 0.2);
        }

        .treatment-card-header {
            padding: 24px 20px;
            text-align: center;
        }

        .treatment-card-header.dark {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d4a6f 100%);
            color: white;
        }

        .treatment-card-header.light {
            background: white;
            color: var(--gray-900);
            border-bottom: 1px solid var(--gray-200);
        }

        .treatment-card-header .seduta-label {
            font-size: 0.85rem;
            font-weight: 500;
            opacity: 0.9;
            margin-bottom: 4px;
        }

        .treatment-card-header h3 {
            font-size: 1.2rem;
            font-weight: 800;
            margin: 0;
        }

        .treatment-card-price {
            padding: 20px;
            text-align: center;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .treatment-card-price .price-description {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .treatment-card-price .price-value {
            font-size: 2.5rem;
            font-weight: 800;
            line-height: 1;
        }

        .treatment-card-price .price-unit {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-top: 4px;
        }

        .treatment-card-features {
            padding: 24px 20px;
            background: white;
        }

        .treatment-card-features ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .treatment-card-features li {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
            font-size: 0.95rem;
            color: var(--gray-700);
        }

        .treatment-card-features li i {
            color: var(--primary);
            font-size: 0.8rem;
        }

        .treatment-card-cta {
            padding: 0 20px 24px;
        }

        .treatment-card-cta .btn {
            width: 100%;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .treatment-card-cta .btn:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.4);
        }

        .treatment-connector {
            display: none;
            font-size: 2rem;
            color: var(--gray-400);
            font-weight: 300;
        }

        @media (min-width: 768px) {
            .treatment-connector {
                display: flex;
                align-items: center;
                padding: 0 8px;
            }
        }

        /* ========================================
           PRODUCT MODAL & CAROUSEL
           ======================================== */
        .product-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(8px);
            z-index: 3000;
            display: none;
            align-items: flex-end;
            justify-content: center;
        }

        .product-modal-overlay.active {
            display: flex;
        }

        .product-modal {
            background: var(--white);
            width: 100%;
            max-width: 480px;
            max-height: 85vh;
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            overflow: hidden;
            animation: slideUp 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        /* Desktop Modal Styles */
        @media (min-width: 768px) {
            .product-modal-overlay {
                align-items: center;
                padding: 40px;
            }

            .product-modal {
                max-width: 900px;
                max-height: 85vh;
                border-radius: var(--radius-xl);
                display: flex;
                flex-direction: column;
            }

            .product-modal-header {
                padding: 24px 32px;
                flex-shrink: 0;
            }

            .product-modal-header h3 {
                font-size: 1.6rem;
            }

            .product-carousel-container {
                padding: 24px 0;
                flex: 1;
                overflow: hidden;
                min-height: 0;
            }

            .product-carousel {
                padding: 0 32px 24px;
                gap: 24px;
            }

            .product-card {
                flex: 0 0 280px;
                max-width: 280px;
            }

            .product-card-image {
                height: 240px;
            }

            .product-card-content {
                padding: 20px;
            }

            .product-card-brand {
                font-size: 1.3rem;
            }

            .product-card-desc {
                font-size: 0.95rem;
                min-height: 60px;
            }

            .product-card-price {
                font-size: 2.2rem;
            }

            .carousel-nav {
                padding: 12px 32px 16px;
                flex-shrink: 0;
            }

            .carousel-arrow {
                width: 48px;
                height: 48px;
                font-size: 18px;
            }

            .carousel-dot {
                width: 14px;
                height: 14px;
            }

            .product-modal-cta {
                padding: 20px 32px;
                flex-shrink: 0;
                background: var(--gray-100);
            }

            .product-modal-cta .btn {
                max-width: 500px;
                margin: 0 auto;
                padding: 18px 40px;
                font-size: 1.1rem;
            }
        }

        @media (min-width: 992px) {
            .product-modal {
                max-width: 1200px;
            }

            .product-card {
                flex: 0 0 340px;
                max-width: 340px;
            }

            .product-card-image {
                height: 220px;
            }

            .product-modal-header h3 {
                font-size: 1.8rem;
            }

            .product-card-content {
                padding: 24px;
            }

            .product-card-brand {
                font-size: 1.4rem;
            }

            .product-card-desc {
                font-size: 1rem;
                min-height: 70px;
            }
        }

        @media (min-width: 1400px) {
            .product-modal {
                max-width: 1500px;
            }

            .product-card {
                flex: 0 0 420px;
                max-width: 420px;
            }

            .product-card-image {
                height: 280px;
            }

            .product-card-content {
                padding: 28px;
            }

            .product-card-brand {
                font-size: 1.6rem;
            }

            .product-card-desc {
                font-size: 1.1rem;
            }

            .product-card-price {
                font-size: 2.5rem;
            }
        }

        /* ========================================
           CLINIC GALLERY MODAL - Bigger Size
           ======================================== */
        .clinic-gallery-card {
            flex: 0 0 300px !important;
            max-width: 300px !important;
        }

        .clinic-gallery-image {
            height: 220px !important;
            object-fit: cover;
        }

        #clinic-modal-overlay .product-modal {
            max-height: 90vh;
        }

        @media (min-width: 768px) {
            .clinic-gallery-card {
                flex: 0 0 380px !important;
                max-width: 380px !important;
            }

            .clinic-gallery-image {
                height: 280px !important;
            }

            #clinic-modal-overlay .product-modal {
                max-width: 95vw;
            }
        }

        @media (min-width: 992px) {
            .clinic-gallery-card {
                flex: 0 0 450px !important;
                max-width: 450px !important;
            }

            .clinic-gallery-image {
                height: 340px !important;
            }

            #clinic-modal-overlay .product-modal {
                max-width: 1400px;
            }

            #clinic-modal-overlay .product-card-desc {
                font-size: 1rem;
                line-height: 1.6;
                min-height: 80px;
            }
        }

        @media (min-width: 1400px) {
            .clinic-gallery-card {
                flex: 0 0 520px !important;
                max-width: 520px !important;
            }

            .clinic-gallery-image {
                height: 400px !important;
            }

            #clinic-modal-overlay .product-modal {
                max-width: 1600px;
            }

            #clinic-modal-overlay .product-card-desc {
                font-size: 1.1rem;
                min-height: 90px;
            }
        }

        .product-modal-header {
            background: var(--primary);
            color: var(--white);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        .product-modal-header h3 {
            font-size: 1.2rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .product-modal-header h3 img {
            height: 32px;
            width: auto;
        }

        .product-modal-close {
            width: 36px;
            height: 36px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--white);
            cursor: pointer;
        }

        .product-carousel-container {
            padding: 16px 0;
            overflow: hidden;
            flex: 1;
            min-height: 0;
        }

        .product-carousel {
            display: flex;
            gap: 12px;
            padding: 0 16px 16px;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
            scroll-padding-left: 16px;
        }

        .product-carousel::-webkit-scrollbar {
            display: none;
        }

        .product-card {
            flex: 0 0 calc(100vw - 80px);
            max-width: 300px;
            background: var(--white);
            border-radius: var(--radius-lg);
            overflow: hidden;
            scroll-snap-align: center;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--gray-200);
            transition: transform 0.2s;
        }

        .product-card:active {
            transform: scale(0.98);
        }

        .product-card-image {
            width: 100%;
            height: 220px;
            object-fit: contain;
            background: #ffffff;
            padding: 16px;
            border-bottom: 3px solid var(--accent);
        }

        .product-card-content {
            padding: 16px;
        }

        .product-card-brand {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 4px;
        }

        .product-card-origin {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            background: linear-gradient(135deg, rgba(0,166,153,0.08) 0%, rgba(0,166,153,0.04) 100%);
            border-radius: 4px;
            width: fit-content;
        }

        .product-card-origin i {
            font-size: 0.7rem;
        }

        .product-card-desc {
            font-size: 0.85rem;
            color: var(--gray-600);
            margin-bottom: 12px;
            line-height: 1.5;
            min-height: 50px;
        }

        .product-card-price {
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--danger);
        }

        .product-card-price span {
            font-size: 0.85rem;
            color: var(--gray-500);
            font-weight: 400;
        }

        .product-card-quality {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid var(--gray-200);
        }

        .product-card-quality i {
            color: #ffc107;
            font-size: 0.7rem;
        }

        .product-card-quality span {
            font-size: 0.7rem;
            color: var(--gray-500);
            font-weight: 500;
        }

        .carousel-nav-hint {
            display: none;
        }

        .carousel-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
            padding: 12px 20px 16px;
            flex-shrink: 0;
        }

        .carousel-arrow {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--gray-200);
            color: var(--gray-500);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            font-size: 14px;
        }

        .carousel-arrow:hover {
            background: var(--gray-300);
            color: var(--gray-700);
        }

        .carousel-arrow:active {
            transform: scale(0.95);
            background: var(--primary);
            color: white;
        }

        .carousel-dots {
            display: none;
        }

        .carousel-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--gray-300);
            border: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .carousel-dot:hover {
            background: var(--gray-400);
        }

        .carousel-dot:active {
            transform: scale(0.9);
        }

        .carousel-dot.active {
            background: var(--primary);
            transform: scale(1.3);
        }

        .product-modal-cta {
            padding: 16px 20px;
            padding-bottom: max(16px, env(safe-area-inset-bottom));
            background: var(--gray-100);
            border-top: 1px solid var(--gray-200);
            flex-shrink: 0;
        }

        .product-modal-cta .btn {
            width: 100%;
        }

        /* ========================================
           TRUST SECTION
           ======================================== */
        .trust-section {
            padding: 32px 16px;
            background: var(--white);
        }

        .trust-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        @media (min-width: 768px) {
            .trust-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 24px;
            }
        }

        @media (min-width: 992px) {
            .trust-section {
                padding: 60px 16px;
            }

            .trust-card {
                padding: 24px;
            }

            .trust-card i {
                font-size: 2rem;
                margin-bottom: 12px;
            }

            .trust-card h4 {
                font-size: 1rem;
            }

            .trust-card p {
                font-size: 0.85rem;
            }
        }

        .trust-card {
            background: var(--gray-50);
            border-radius: var(--radius-md);
            padding: 16px;
            text-align: center;
        }

        .trust-card i {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .trust-card h4 {
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .trust-card p {
            font-size: 0.75rem;
            color: var(--gray-500);
        }

        /* ========================================
           GOOGLE REVIEWS
           ======================================== */
        .reviews-section {
            padding: 32px 16px;
            background: var(--gray-50);
        }

        .google-rating {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 24px;
            padding: 16px;
            background: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
        }

        .google-logo {
            width: 40px;
            height: 40px;
        }

        .google-rating-info {
            text-align: left;
        }

        .google-rating-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--gray-900);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .google-stars {
            color: #fbbf24;
        }

        .google-rating-count {
            font-size: 0.8rem;
            color: var(--gray-500);
        }

        .review-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 12px;
            box-shadow: var(--shadow-sm);
        }

        .review-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .review-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--primary);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .review-meta h4 {
            font-size: 0.95rem;
            font-weight: 600;
        }

        .review-meta .stars {
            color: #fbbf24;
            font-size: 0.85rem;
        }

        .review-meta .date {
            font-size: 0.75rem;
            color: var(--gray-500);
        }

        .review-text {
            font-size: 0.9rem;
            color: var(--gray-700);
            line-height: 1.6;
        }

        /* Reviews Desktop */
        @media (min-width: 768px) {
            .reviews-container {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 24px;
            }
        }

        @media (min-width: 992px) {
            .reviews-section {
                padding: 60px 16px;
            }

            .google-rating {
                max-width: 400px;
                margin-left: auto;
                margin-right: auto;
            }

            .review-card {
                padding: 28px;
            }

            .review-text {
                font-size: 1rem;
            }
        }

        /* ========================================
           ENHANCED REVIEWS - ELFSIGHT STYLE
           ======================================== */
        .reviews-section-enhanced {
            padding: 50px 16px;
            background: var(--gray-50);
        }

        .reviews-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            margin-bottom: 30px;
            text-align: center;
        }

        .reviews-brand {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .reviews-clinic-logo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
        }

        .reviews-clinic-logo-link {
            text-decoration: none;
        }

        .reviews-clinic-logo.youtube-logo {
            background: #FF0000;
            border: 2px solid #FF0000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .reviews-clinic-logo.youtube-logo i {
            color: white;
            font-size: 1.5rem;
        }

        .reviews-clinic-info h3 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--gray-900);
            margin: 0;
        }

        .reviews-rating-summary {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 4px;
        }

        .reviews-score {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--gray-900);
        }

        .reviews-stars {
            color: #fbbf24;
            font-size: 0.9rem;
        }

        .reviews-count {
            font-size: 0.85rem;
            color: var(--gray-500);
        }

        .reviews-write-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: var(--white);
            border: 2px solid #4285F4;
            color: #4285F4;
            font-weight: 600;
            font-size: 0.9rem;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .reviews-write-btn:hover {
            background: #4285F4;
            color: white;
        }

        .reviews-carousel-container {
            position: relative;
            overflow: hidden;
        }

        .reviews-carousel {
            display: flex;
            gap: 16px;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            padding: 10px 5px;
            scrollbar-width: none;
        }

        .reviews-carousel::-webkit-scrollbar {
            display: none;
        }

        .review-card-enhanced {
            flex: 0 0 calc(100% - 20px);
            scroll-snap-align: start;
            background: var(--white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            min-height: 180px;
        }

        .review-card-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
        }

        .review-avatar-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .review-info {
            flex: 1;
        }

        .review-info h4 {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--gray-900);
            margin: 0 0 4px 0;
        }

        .review-stars {
            color: #fbbf24;
            font-size: 0.85rem;
            margin-bottom: 2px;
        }

        .review-date {
            font-size: 0.75rem;
            color: var(--gray-500);
        }

        .google-review-icon {
            flex-shrink: 0;
            margin-left: auto;
        }

        .review-text-enhanced {
            font-size: 0.9rem;
            color: var(--gray-700);
            line-height: 1.6;
            margin: 0;
        }

        .reviews-nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--white);
            border: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            cursor: pointer;
            z-index: 10;
            display: none;
            align-items: center;
            justify-content: center;
            color: var(--gray-700);
            transition: all 0.2s ease;
        }

        .reviews-nav-btn:hover {
            background: var(--primary);
            color: white;
        }

        .reviews-prev {
            left: 5px;
        }

        .reviews-next {
            right: 5px;
        }

        .reviews-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 20px;
        }

        .reviews-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--gray-300);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .reviews-dot.active {
            background: var(--primary);
            width: 24px;
            border-radius: 4px;
        }

        .reviews-view-all {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 24px;
            padding: 14px 28px;
            background: var(--white);
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            color: var(--gray-700);
            font-weight: 600;
            font-size: 0.95rem;
            text-decoration: none;
            transition: all 0.2s ease;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .reviews-view-all:hover {
            border-color: #4285F4;
            color: #4285F4;
        }

        /* Desktop Reviews Enhanced */
        @media (min-width: 768px) {
            .reviews-header {
                flex-direction: row;
                justify-content: space-between;
                text-align: left;
            }

            .review-card-enhanced {
                flex: 0 0 calc(50% - 12px);
            }

            .reviews-nav-btn {
                display: flex;
            }
        }

        @media (min-width: 992px) {
            .reviews-section-enhanced {
                padding: 70px 16px;
            }

            .review-card-enhanced {
                flex: 0 0 calc(33.333% - 14px);
            }

            .reviews-clinic-logo {
                width: 60px;
                height: 60px;
            }

            .reviews-clinic-info h3 {
                font-size: 1.25rem;
            }
        }

        /* ========================================
           CLINIC SECTION
           ======================================== */
        .clinic-section {
            padding: 32px 16px;
            background: var(--white);
        }

        .clinic-card {
            background: var(--gray-50);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-md);
        }

        .clinic-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .clinic-content {
            padding: 20px;
        }

        .clinic-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: var(--success);
            color: var(--white);
            padding: 4px 10px;
            border-radius: 100px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .clinic-name {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .clinic-name img {
            height: 28px;
            width: auto;
        }

        .clinic-features {
            list-style: none;
            margin-bottom: 16px;
        }

        .clinic-features li {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--gray-700);
            margin-bottom: 8px;
        }

        .clinic-features li i {
            color: var(--success);
            width: 16px;
        }

        /* Clinic Desktop */
        @media (min-width: 768px) {
            .clinic-card {
                display: grid;
                grid-template-columns: 1fr 1fr;
            }

            .clinic-image {
                height: 100%;
                min-height: 300px;
            }
        }

        @media (min-width: 992px) {
            .clinic-section {
                padding: 60px 16px;
            }

            .clinic-content {
                padding: 32px;
            }

            .clinic-name {
                font-size: 1.5rem;
            }

            .clinic-features li {
                font-size: 1rem;
                margin-bottom: 12px;
            }
        }

        /* ========================================
           PROCESS SECTION
           ======================================== */
        .process-section {
            padding: 32px 16px;
            background: var(--primary);
            color: var(--white);
        }

        .process-section .section-title,
        .process-section .section-subtitle {
            color: var(--white);
        }

        .process-section .section-subtitle {
            opacity: 0.8;
        }

        .process-steps {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .process-step {
            display: flex;
            gap: 16px;
            align-items: flex-start;
        }

        .process-number {
            width: 36px;
            height: 36px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }

        .process-content h4 {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .process-content p {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        /* Process Desktop */
        @media (min-width: 768px) {
            .process-steps {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }

            .process-step {
                flex: 0 0 calc(50% - 16px);
                flex-direction: column;
                text-align: center;
            }

            .process-number {
                margin-bottom: 12px;
            }
        }

        @media (min-width: 992px) {
            .process-section {
                padding: 60px 16px;
            }

            .process-step {
                flex: 0 0 calc(25% - 24px);
            }

            .process-number {
                width: 48px;
                height: 48px;
                font-size: 1.2rem;
            }

            .process-content h4 {
                font-size: 1.1rem;
                margin-bottom: 8px;
            }

            .process-content p {
                font-size: 0.9rem;
            }
        }

        /* ========================================
           COME FUNZIONA DETAILED SECTION
           ======================================== */
        .come-funziona-section {
            padding: 0;
            background: var(--white);
        }

        /* 4-Step Quick Overview */
        .cf-overview {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 50px 16px;
        }

        .cf-overview-container {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .cf-overview-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--gray-900);
            margin-bottom: 8px;
        }

        .cf-overview-title span {
            color: var(--primary);
        }

        .cf-overview-subtitle {
            font-size: 1rem;
            color: var(--gray-600);
            margin-bottom: 40px;
        }

        .cf-overview-steps {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
        }

        .cf-overview-step {
            background: var(--white);
            border-radius: 16px;
            padding: 24px 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            position: relative;
            text-align: center;
            transition: all 0.3s ease;
        }

        .cf-overview-step:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }

        .cf-overview-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 16px;
            border-radius: 50%;
            overflow: hidden;
            background: var(--gray-100);
        }

        .cf-overview-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cf-overview-icon-large {
            width: 100px;
            height: 100px;
            border: 3px solid var(--primary);
            box-shadow: 0 4px 15px rgba(26, 54, 93, 0.2);
        }

        .cf-overview-icon-large img {
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }

        .cf-overview-number {
            position: absolute;
            top: 12px;
            right: 16px;
            font-size: 2rem;
            font-weight: 900;
            color: var(--primary);
            opacity: 0.2;
        }

        .cf-overview-step h3 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 8px;
        }

        .cf-overview-step p {
            font-size: 0.9rem;
            color: var(--gray-600);
            line-height: 1.5;
            margin: 0;
        }

        .cf-overview-step-clickable {
            cursor: pointer;
        }

        .cf-overview-step-clickable:hover {
            border: 2px solid var(--primary);
        }

        .cf-overview-step-highlight {
            background: linear-gradient(135deg, #f0f7ff 0%, #e8f4fd 100%);
            border: 2px solid rgba(26, 54, 93, 0.15);
            position: relative;
            overflow: visible;
        }

        .cf-overview-step-highlight::before {
            content: '‚≠ê START HERE';
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 20px;
            white-space: nowrap;
            box-shadow: 0 2px 10px rgba(245, 158, 11, 0.4);
        }

        .cf-overview-step-highlight:hover {
            border-color: var(--primary);
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 12px 40px rgba(26, 54, 93, 0.2);
        }

        .cf-overview-step-highlight h3 {
            color: var(--primary);
        }

        .cf-overview-step-flight {
            background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);
            border: 2px solid rgba(234, 88, 12, 0.15);
            position: relative;
        }

        .cf-overview-step-flight::before {
            content: '‚úàÔ∏è LOW COST FLIGHTS';
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ea580c 0%, #c2410c 100%);
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 20px;
            white-space: nowrap;
            box-shadow: 0 2px 10px rgba(234, 88, 12, 0.4);
        }

        .cf-overview-step-flight:hover {
            border-color: #ea580c;
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 12px 40px rgba(234, 88, 12, 0.2);
        }

        .cf-overview-step-flight h3 {
            color: #ea580c;
        }

        .cf-overview-btn-flight {
            background: linear-gradient(135deg, #ea580c 0%, #c2410c 100%) !important;
        }

        .cf-overview-btn-flight:hover {
            box-shadow: 0 4px 15px rgba(234, 88, 12, 0.4) !important;
        }

        /* Step 3 - Booking Style (Green) */
        .cf-overview-step-booking {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 2px solid rgba(34, 197, 94, 0.15);
            position: relative;
        }

        .cf-badge-booking {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 20px;
            white-space: nowrap;
            box-shadow: 0 2px 10px rgba(34, 197, 94, 0.4);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .cf-overview-step-booking:hover {
            border-color: #22c55e;
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 12px 40px rgba(34, 197, 94, 0.2);
        }

        .cf-overview-step-booking h3 {
            color: #16a34a;
        }

        .cf-overview-btn-booking {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%) !important;
        }

        .cf-overview-btn-booking:hover {
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4) !important;
        }

        /* Step 4 - Tirana Experience Style (Purple) */
        .cf-overview-step-tirana {
            background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
            border: 2px solid rgba(139, 92, 246, 0.15);
            position: relative;
        }

        .cf-badge-tirana {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%);
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 20px;
            white-space: nowrap;
            box-shadow: 0 2px 10px rgba(139, 92, 246, 0.4);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .cf-overview-step-tirana:hover {
            border-color: #8b5cf6;
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 12px 40px rgba(139, 92, 246, 0.2);
        }

        .cf-overview-step-tirana h3 {
            color: #6d28d9;
        }

        .cf-overview-btn-tirana {
            background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%) !important;
        }

        .cf-overview-btn-tirana:hover {
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4) !important;
        }

        .cf-overview-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 15px;
            padding: 10px 18px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cf-overview-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(26, 54, 93, 0.3);
        }

        .cf-overview-btn i {
            font-size: 0.9rem;
        }

        @media (min-width: 576px) {
            .cf-overview-steps {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 992px) {
            .cf-overview {
                padding: 70px 16px;
            }

            .cf-overview-title {
                font-size: 2.4rem;
            }

            .cf-overview-subtitle {
                font-size: 1.15rem;
            }

            .cf-overview-steps {
                grid-template-columns: repeat(4, 1fr);
                gap: 30px;
            }

            .cf-overview-icon {
                width: 100px;
                height: 100px;
            }

            .cf-overview-step h3 {
                font-size: 1.2rem;
            }

            .cf-overview-step p {
                font-size: 0.95rem;
            }
        }

        /* Hero with Video - Two Column Layout */
        .cf-hero {
            background: linear-gradient(135deg, var(--primary) 0%, #2c5282 100%);
            color: var(--white);
            padding: 32px 16px 40px;
            position: relative;
            overflow: hidden;
        }

        .cf-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            pointer-events: none;
        }

        .cf-hero-container {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        .cf-hero-content {
            margin-bottom: 24px;
        }

        .cf-hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            padding: 6px 12px;
            border-radius: 100px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .cf-hero-badge i {
            color: var(--gold);
        }

        .cf-hero h1 {
            font-size: 1.75rem;
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: 12px;
            letter-spacing: -0.5px;
        }

        .cf-hero h1 span {
            color: var(--gold);
        }

        .cf-hero-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            line-height: 1.5;
        }

        .cf-video-card {
            position: relative;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            margin-top: 20px;
        }

        .cf-video-container {
            position: relative;
            width: 100%;
            aspect-ratio: 9 / 16;
            max-height: 450px;
            overflow: hidden;
            border-radius: var(--radius-lg);
            background: #000;
            margin: 0 auto;
        }

        .cf-video-container video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: var(--radius-lg);
        }

        @media (min-width: 992px) {
            .cf-video-container {
                max-height: 500px;
            }
        }

        @media (min-width: 1200px) {
            .cf-video-container {
                max-height: 550px;
            }
        }

        .cf-video-play-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70px;
            height: 70px;
            background: rgba(255,255,255,0.95);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            z-index: 10;
        }

        .cf-video-play-btn i {
            font-size: 1.8rem;
            color: var(--primary);
            margin-left: 5px;
        }

        .cf-video-play-btn:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 6px 30px rgba(0,0,0,0.4);
        }

        .cf-video-play-btn.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* Video Controls - Simple & User Friendly */
        .video-controls {
            position: absolute;
            bottom: 16px;
            left: 50%;
            transform: translateX(-50%);
            display: none;
            flex-direction: row;
            gap: 12px;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 50px;
            z-index: 15;
        }

        .video-controls.visible {
            display: flex;
        }

        .video-control-btn {
            width: 44px;
            height: 44px;
            border: none;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            -webkit-tap-highlight-color: transparent;
        }

        .video-control-btn:active {
            background: rgba(255, 255, 255, 0.7);
            transform: scale(0.95);
        }

        /* Desktop layout for How It Works Hero */
        @media (min-width: 768px) {
            /* Video uses aspect-ratio now */
        }

        @media (min-width: 992px) {
            .cf-hero {
                padding: 60px 16px 80px;
            }

            .cf-hero-container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 60px;
                align-items: center;
            }

            .cf-hero-content {
                margin-bottom: 0;
                text-align: left;
            }

            .cf-hero h1 {
                font-size: 2.8rem;
                margin-bottom: 20px;
            }

            .cf-hero-subtitle {
                font-size: 1.2rem;
            }

            .cf-video-card {
                margin-top: 0;
                max-width: 550px;
            }
        }

        @media (min-width: 1200px) {
            .cf-hero h1 {
                font-size: 3.5rem;
            }

            .cf-hero-subtitle {
                font-size: 1.3rem;
            }

            .cf-video-card {
                max-width: 600px;
            }
        }

        @media (min-width: 1600px) {
            .cf-hero {
                padding: 80px 16px 100px;
            }

            .cf-hero h1 {
                font-size: 4rem;
            }

            .cf-hero-subtitle {
                font-size: 1.5rem;
            }

            .cf-video-card {
                max-width: 700px;
            }
        }

        /* Step Sections */
        .cf-step {
            padding: 48px 16px;
        }

        .cf-step:nth-child(even) {
            background: var(--gray-50);
        }

        .cf-step-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .cf-step-content {
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        .cf-step-image {
            order: 1;
        }

        .cf-step-image img {
            width: 100%;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            object-fit: cover;
        }

        .cf-step-text {
            order: 2;
        }

        .cf-step-number {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--primary);
            color: var(--white);
            padding: 8px 16px;
            border-radius: 100px;
            font-size: 0.85rem;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .cf-step-number span {
            font-size: 1.2rem;
        }

        .cf-step h2 {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--gray-900);
            margin-bottom: 16px;
            line-height: 1.3;
        }

        .cf-step h2 span {
            color: var(--primary);
        }

        .cf-step-description {
            font-size: 1rem;
            color: var(--gray-700);
            line-height: 1.7;
            margin-bottom: 24px;
        }

        .cf-step-features {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .cf-step-features li {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
            font-size: 0.95rem;
            color: var(--gray-700);
        }

        .cf-step-features li i {
            color: var(--success);
            margin-top: 4px;
            flex-shrink: 0;
        }

        .cf-step-cta {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: var(--primary);
            color: var(--white);
            padding: 14px 28px;
            border-radius: 100px;
            font-size: 0.95rem;
            font-weight: 600;
            margin-top: 24px;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
        }

        .cf-step-cta:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* Treatment Phases Section */
        .cf-phases {
            background: var(--gray-900);
            color: var(--white);
            padding: 48px 16px;
        }

        .cf-phases-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .cf-phases-header h2 {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 12px;
        }

        .cf-phases-header h2 span {
            color: var(--gold);
        }

        .cf-phases-header p {
            font-size: 1rem;
            opacity: 0.8;
        }

        .cf-phases-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .cf-phase-card {
            background: rgba(255,255,255,0.05);
            border-radius: var(--radius-lg);
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .cf-phase-video {
            position: relative;
            width: 100%;
            aspect-ratio: 9/16;
            max-height: 400px;
            background: #000;
            overflow: hidden;
            border-radius: var(--radius-lg);
            margin: 0 auto;
        }

        .cf-phase-video video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: var(--radius-lg);
        }

        @media (min-width: 768px) {
            .cf-phase-video {
                max-height: 450px;
            }
        }

        @media (min-width: 992px) {
            .cf-phase-video {
                max-height: 500px;
            }
        }

        .cf-phase-video-play {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            background: rgba(255,255,255,0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cf-phase-video-play i {
            font-size: 1.5rem;
            color: var(--gray-900);
            margin-left: 4px;
        }

        .cf-phase-video-play:hover {
            transform: translate(-50%, -50%) scale(1.1);
        }

        .cf-phase-video-play.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .cf-phase-content {
            padding: 20px;
        }

        .cf-phase-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: var(--gold);
            color: var(--gray-900);
            border-radius: 50%;
            font-size: 0.85rem;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .cf-phase-content h3 {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .cf-phase-content p {
            font-size: 0.9rem;
            opacity: 0.8;
            line-height: 1.6;
        }

        /* Final CTA */
        .cf-final-cta {
            background: linear-gradient(135deg, var(--accent) 0%, #c53030 100%);
            color: var(--white);
            padding: 48px 16px;
            text-align: center;
        }

        .cf-final-cta h2 {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 12px;
        }

        .cf-final-cta p {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 24px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .cf-cta-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: 400px;
            margin: 0 auto;
        }

        .cf-cta-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 16px 24px;
            border-radius: 100px;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
        }

        .cf-cta-btn-primary {
            background: var(--white);
            color: var(--accent);
        }

        .cf-cta-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .cf-cta-btn-whatsapp {
            background: #25d366;
            color: var(--white);
        }

        .cf-cta-btn-whatsapp:hover {
            background: #20bd5a;
            transform: translateY(-2px);
        }

        /* ========================================
           MOBILE OPTIMIZATION - Premium Layout
           ======================================== */
        /* Mobile Step Images - Constrained Height */
        @media (max-width: 767px) {
            .cf-step-image img {
                max-height: 260px;
                width: 100%;
                object-fit: cover;
                border-radius: 12px;
            }

            .cf-step {
                padding: 36px 16px;
            }

            .cf-step-content {
                gap: 24px;
            }

            .cf-step h2 {
                font-size: 1.35rem;
                line-height: 1.25;
            }

            .cf-step-description {
                font-size: 0.92rem;
                margin-bottom: 16px;
            }

            .cf-step-features li {
                font-size: 0.88rem;
                margin-bottom: 8px;
            }

            /* Mobile Video Phases - Better Containment */
            .cf-phase-video {
                max-height: 320px;
                border-radius: 12px;
            }

            .cf-phases {
                padding: 40px 16px;
            }

            .cf-phases-header {
                margin-bottom: 28px;
            }

            .cf-phases-header h2 {
                font-size: 1.35rem;
            }

            .cf-phases-grid {
                gap: 20px;
            }

            .cf-phase-content {
                padding: 16px;
            }

            .cf-phase-content h3 {
                font-size: 1rem;
            }

            .cf-phase-content p {
                font-size: 0.85rem;
            }

            /* Mobile Final CTA - Compact */
            .cf-final-cta {
                padding: 36px 16px;
            }

            .cf-final-cta h2 {
                font-size: 1.35rem;
            }

            .cf-final-cta p {
                font-size: 0.92rem;
                margin-bottom: 20px;
            }

            /* Mobile Treatment Plan Cards */
            .treatment-plan-grid {
                gap: 20px;
            }

            .treatment-card {
                max-width: 100%;
            }

            .treatment-card-header {
                padding: 18px 16px;
            }

            .treatment-card-header h3 {
                font-size: 1.1rem;
            }

            .treatment-card-price .price-value {
                font-size: 2.2rem;
            }

            .treatment-card-features {
                padding: 18px 16px;
            }

            .treatment-card-features li {
                font-size: 0.88rem;
                padding: 6px 0;
            }

            /* Mobile Pricing Cards */
            .pricing-section {
                padding: 28px 16px;
            }

            .pricing-card-image {
                height: 100px;
            }

            .pricing-card-content {
                padding: 12px;
            }

            /* Mobile Service Categories */
            .service-categories-section {
                padding: 40px 16px;
            }

            .service-categories-header {
                margin-bottom: 28px;
            }

            .service-categories-header h2 {
                font-size: 1.5rem;
            }

            .service-category-card {
                padding: 20px 16px;
            }

            .service-category-card .card-image {
                height: 120px;
            }

            /* Mobile 4-Step Overview - Better Spacing */
            .cf-overview {
                padding: 40px 16px;
            }

            .cf-overview-title {
                font-size: 1.5rem;
            }

            .cf-overview-subtitle {
                font-size: 0.92rem;
                margin-bottom: 28px;
            }

            .cf-overview-steps {
                gap: 20px;
            }

            .cf-overview-step {
                padding: 20px 16px;
            }

            .cf-overview-icon-large {
                width: 85px;
                height: 85px;
            }

            .cf-overview-step h3 {
                font-size: 1rem;
            }

            .cf-overview-step p {
                font-size: 0.85rem;
            }

            .cf-overview-btn {
                padding: 10px 16px;
                font-size: 0.82rem;
            }

            /* Mobile Video Hero - Better Fit */
            .cf-hero {
                padding: 28px 16px 36px;
            }

            .cf-hero h1 {
                font-size: 1.5rem;
            }

            .cf-hero-subtitle {
                font-size: 0.92rem;
            }

            .cf-video-container {
                max-height: 380px;
            }

            .cf-video-play-btn {
                width: 56px;
                height: 56px;
            }

            .cf-video-play-btn i {
                font-size: 1.4rem;
            }

            /* Mobile Reviews Section */
            .reviews-section-enhanced {
                padding: 36px 16px;
            }

            .reviews-header {
                margin-bottom: 24px;
            }

            .reviews-clinic-info h3 {
                font-size: 1rem;
            }

            .reviews-score {
                font-size: 1.2rem;
            }

            .reviews-write-btn {
                padding: 8px 16px;
                font-size: 0.82rem;
            }

            .review-card-enhanced {
                padding: 16px;
                min-height: 160px;
            }

            .review-info h4 {
                font-size: 0.9rem;
            }

            .review-text-enhanced {
                font-size: 0.85rem;
            }

            /* Mobile Treatment Plan Section */
            .treatment-plan-section {
                padding: 40px 16px;
            }

            .treatment-plan-header {
                margin-bottom: 28px;
            }

            .treatment-plan-header h2 {
                font-size: 1.5rem;
            }
        }

        /* Extra Small Mobile (under 400px) */
        @media (max-width: 400px) {
            .cf-step-image img {
                max-height: 220px;
            }

            .cf-step h2 {
                font-size: 1.2rem;
            }

            .cf-phase-video {
                max-height: 280px;
            }

            .cf-overview-icon-large {
                width: 70px;
                height: 70px;
            }

            .treatment-card-price .price-value {
                font-size: 1.9rem;
            }

            .cf-hero h1 {
                font-size: 1.35rem;
            }

            .cf-video-container {
                max-height: 320px;
            }
        }

        /* How It Works Steps Desktop Styles */
        @media (min-width: 768px) {
            .cf-step {
                padding: 64px 24px;
            }

            .cf-step-content {
                flex-direction: row;
                align-items: center;
            }

            .cf-step-image,
            .cf-step-text {
                flex: 1;
            }

            .cf-step-image {
                order: 1;
            }

            .cf-step-text {
                order: 2;
            }

            /* Reverse for odd steps */
            .cf-step:nth-child(odd) .cf-step-image {
                order: 2;
            }

            .cf-step:nth-child(odd) .cf-step-text {
                order: 1;
            }

            .cf-step h2 {
                font-size: 1.8rem;
            }

            .cf-phases-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .cf-cta-buttons {
                flex-direction: row;
                max-width: 500px;
            }
        }

        @media (min-width: 992px) {
            .cf-step {
                padding: 80px 40px;
            }

            .cf-step-content {
                gap: 60px;
            }

            .cf-step h2 {
                font-size: 2.2rem;
            }

            .cf-step-description {
                font-size: 1.1rem;
            }

            .cf-step-features li {
                font-size: 1rem;
            }

            .cf-phases {
                padding: 80px 40px;
            }

            .cf-phases-header h2 {
                font-size: 2rem;
            }

            .cf-phases-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 32px;
            }

            .cf-final-cta {
                padding: 80px 40px;
            }

            .cf-final-cta h2 {
                font-size: 2rem;
            }
        }

        @media (min-width: 1200px) {
            .cf-step-content {
                gap: 80px;
            }

            .cf-step h2 {
                font-size: 2.5rem;
            }

            .cf-step-image img {
                height: 450px;
            }
        }

        @media (min-width: 1600px) {
            .cf-step h2 {
                font-size: 2.8rem;
            }

            .cf-step-image img {
                height: 500px;
            }
        }

        /* ========================================
           CTA SECTION
           ======================================== */
        .cta-section {
            padding: 32px 16px;
            background: linear-gradient(135deg, var(--accent) 0%, #c53030 100%);
            color: var(--white);
            text-align: center;
        }

        .cta-section h2 {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .cta-section p {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 24px;
        }

        .cta-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 16px 24px;
            border-radius: 100px;
            font-size: 1rem;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-primary {
            background: var(--white);
            color: var(--accent);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: var(--white);
            border: 2px solid rgba(255,255,255,0.5);
        }

        .btn-whatsapp {
            background: #25d366;
            color: var(--white);
        }

        /* CTA Desktop */
        @media (min-width: 768px) {
            .cta-buttons {
                flex-direction: row;
                justify-content: center;
                gap: 16px;
            }

            .cta-buttons .btn {
                flex: 0 0 auto;
            }
        }

        @media (min-width: 992px) {
            .cta-section {
                padding: 60px 16px;
            }

            .cta-section h2 {
                font-size: 2rem;
            }

            .cta-section p {
                font-size: 1.1rem;
                margin-bottom: 32px;
            }

            .cta-buttons .btn {
                padding: 18px 36px;
                font-size: 1.1rem;
            }
        }

        /* ========================================
           FLOATING CTA BAR (Mobile only)
           ======================================== */
        .floating-cta-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--white);
            padding: 12px 16px;
            padding-bottom: max(12px, env(safe-area-inset-bottom));
            box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
            z-index: 1000;
            display: flex;
            gap: 10px;
        }

        .floating-cta-bar .btn {
            flex: 1;
            padding: 14px 16px;
            font-size: 0.95rem;
        }

        /* Hide CTA bar on desktop */
        @media (min-width: 992px) {
            .floating-cta-bar {
                display: none;
            }

            .footer-new {
                padding-bottom: 40px;
            }
        }

        /* ========================================
           LIVE CHAT WIDGET
           ======================================== */
        .live-chat-widget {
            position: fixed;
            bottom: 90px;
            right: 20px;
            z-index: 10001;
            font-family: 'Inter', -apple-system, sans-serif;
        }

        @media (min-width: 992px) {
            .live-chat-widget {
                bottom: 30px;
                right: 30px;
            }
        }

        /* Chat Toggle Button */
        .chat-toggle-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            animation: floatPulse 2s ease-in-out infinite;
        }

        .chat-toggle-btn .chat-label {
            background: white;
            color: #1a1a2e;
            padding: 10px 18px;
            border-radius: 24px;
            font-size: 0.95rem;
            font-weight: 600;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }

        .chat-toggle-btn .chat-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 25px rgba(102, 126, 234, 0.5);
            transition: all 0.3s ease;
            position: relative;
        }

        .chat-toggle-btn .chat-icon i {
            font-size: 28px;
            color: white;
        }

        .chat-toggle-btn .chat-icon .notification-dot {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 14px;
            height: 14px;
            background: #ff4757;
            border-radius: 50%;
            border: 2px solid white;
            animation: pulse 1.5s infinite;
        }

        .chat-toggle-btn:hover .chat-icon {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(102, 126, 234, 0.6);
        }

        @keyframes floatPulse {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Chat Window */
        .chat-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 380px;
            max-width: calc(100vw - 40px);
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.2);
            overflow: hidden;
            transform: scale(0.8) translateY(20px);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            transform-origin: bottom right;
        }

        .chat-window.active {
            transform: scale(1) translateY(0);
            opacity: 1;
            visibility: visible;
        }

        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .chat-header-avatar {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .chat-header-info h4 {
            margin: 0 0 4px 0;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .chat-header-info p {
            margin: 0;
            font-size: 0.85rem;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .chat-header-info .online-dot {
            width: 8px;
            height: 8px;
            background: #2ecc71;
            border-radius: 50%;
        }

        .chat-close {
            margin-left: auto;
            background: rgba(255,255,255,0.2);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            color: white;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .chat-close:hover {
            background: rgba(255,255,255,0.3);
        }

        .chat-messages {
            height: 280px;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
        }

        .chat-message {
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
        }

        .chat-message.bot .message-avatar {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
            flex-shrink: 0;
        }

        .chat-message .message-bubble {
            background: white;
            padding: 12px 16px;
            border-radius: 18px;
            border-top-left-radius: 4px;
            max-width: 80%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .chat-message.user {
            flex-direction: row-reverse;
        }

        .chat-message.user .message-bubble {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-top-left-radius: 18px;
            border-top-right-radius: 4px;
        }

        .chat-input-area {
            padding: 15px 20px;
            background: white;
            border-top: 1px solid #eee;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chat-input {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid #e8e8e8;
            border-radius: 25px;
            font-size: 0.95rem;
            outline: none;
            transition: border-color 0.2s;
        }

        .chat-input:focus {
            border-color: #667eea;
        }

        .chat-input::placeholder {
            color: #aaa;
        }

        .chat-send-btn {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-send-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .chat-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Mobile adjustments */
        @media (max-width: 480px) {
            .chat-window {
                width: calc(100vw - 40px);
                bottom: 75px;
            }

            .chat-toggle-btn .chat-label {
                display: none;
            }
        }

        /* ========================================
           SUCCESS MODAL
           ======================================== */
        .success-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .success-modal-overlay.active {
            display: flex;
        }

        .success-modal {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            margin: 20px;
            animation: scaleIn 0.4s ease;
        }

        @keyframes scaleIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .success-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            animation: bounceIn 0.6s ease;
        }

        @keyframes bounceIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .success-icon i {
            font-size: 40px;
            color: white;
        }

        .success-modal h3 {
            font-size: 1.8rem;
            color: #1a365d;
            margin-bottom: 12px;
        }

        .success-modal p {
            color: #4a5568;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .success-modal .success-subtitle {
            color: #718096;
            font-size: 0.9rem;
            margin-bottom: 24px;
        }

        .success-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 14px 32px;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .success-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        /* ========================================
           FOOTER
           ======================================== */
        .footer {
            background: var(--gray-900);
            color: var(--white);
            padding: 32px 16px;
            padding-bottom: calc(80px + env(safe-area-inset-bottom));
            text-align: center;
        }

        .footer-logo {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .footer-tagline {
            font-size: 0.8rem;
            opacity: 0.7;
            margin-bottom: 24px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 24px;
            margin-bottom: 24px;
        }

        .footer-links a {
            font-size: 0.85rem;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .footer-links a:hover {
            opacity: 1;
        }

        .footer-social {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .footer-social a {
            width: 44px;
            height: 44px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: background 0.2s;
        }

        .footer-social a:hover {
            background: rgba(255,255,255,0.2);
        }

        .footer-legal {
            font-size: 0.7rem;
            opacity: 0.5;
        }

        /* ========================================
           FORM POPUP
           ======================================== */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(4px);
            z-index: 10001;
            display: none;
            align-items: flex-end;
            justify-content: center;
        }

        .popup-overlay.active {
            display: flex;
        }

        .popup-container {
            background: var(--white);
            width: 100%;
            max-width: 480px;
            max-height: 90vh;
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        /* Desktop Popup Styles */
        @media (min-width: 768px) {
            .popup-overlay {
                align-items: center;
                padding: 40px;
            }

            .popup-container {
                max-width: 500px;
                border-radius: var(--radius-xl);
            }

            .popup-header {
                padding: 32px;
            }

            .popup-header h3 {
                font-size: 1.5rem;
            }

            .popup-form {
                padding: 32px;
            }

            .form-group {
                margin-bottom: 20px;
            }

            .form-control {
                padding: 16px 18px;
            }

            .form-submit {
                padding: 18px;
                font-size: 1.1rem;
            }
        }

        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .popup-header {
            background: var(--primary);
            color: var(--white);
            padding: 24px 20px;
            position: relative;
        }

        .popup-close {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 32px;
            height: 32px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--white);
        }

        .popup-header h3 {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .popup-header p {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .popup-form {
            padding: 24px 20px;
            padding-bottom: max(24px, env(safe-area-inset-bottom));
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--gray-700);
        }

        .form-control {
            width: 100%;
            padding: 14px 16px;
            font-size: 16px; /* Prevents iOS zoom */
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-md);
            transition: border-color 0.2s;
            -webkit-appearance: none;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-control::placeholder {
            color: var(--gray-500);
        }

        select.form-control {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23718096' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            padding-right: 40px;
        }

        .form-submit {
            width: 100%;
            padding: 16px;
            background: var(--accent);
            color: var(--white);
            border: none;
            border-radius: 100px;
            font-size: 1rem;
            font-weight: 600;
            margin-top: 8px;
        }

        .form-submit:active {
            background: var(--accent-hover);
        }

        .form-note {
            text-align: center;
            font-size: 0.75rem;
            color: var(--gray-500);
            margin-top: 16px;
        }

        .form-note i {
            color: var(--success);
        }

        /* ========================================
           ANIMATIONS
           ======================================== */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* ========================================
           NEW FOOTER - San Marco Style
           ======================================== */
        .footer-new {
            background: var(--gray-900);
            color: var(--white);
            padding: 40px 16px;
            padding-bottom: calc(100px + env(safe-area-inset-bottom));
        }

        .footer-container {
            max-width: 480px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        .footer-column {
            text-align: center;
        }

        /* Logo & Brand Section */
        .footer-brand {
            margin-bottom: 8px;
        }

        .footer-logo-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 8px;
        }

        .footer-logo-cda {
            font-family: 'Times New Roman', Georgia, serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: #8B0000;
            letter-spacing: 8px;
            line-height: 1;
            display: flex;
            justify-content: center;
        }

        .footer-logo-cda .letter-a {
            position: relative;
        }

        /* Santa hat removed from footer */

        .footer-logo-sub {
            font-family: 'Times New Roman', Georgia, serif;
            font-size: 0.6rem;
            color: #8B0000;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 6px;
        }

        .footer-new .footer-tagline {
            font-size: 0.85rem;
            color: var(--gray-500);
            margin-bottom: 16px;
        }

        .footer-follow {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }

        .footer-follow span {
            font-size: 0.8rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .footer-social-icons {
            display: flex;
            gap: 12px;
        }

        .footer-social-icons a {
            width: 44px;
            height: 44px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--white);
            transition: all 0.3s ease;
        }

        .footer-social-icons a:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }

        .footer-social-icons a .fa-instagram {
            background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .footer-social-icons a:hover .fa-instagram {
            -webkit-text-fill-color: white;
            background: none;
        }

        .footer-social-icons a .fa-facebook-f {
            color: #1877f2;
        }

        .footer-social-icons a:hover .fa-facebook-f {
            color: white;
        }

        .footer-social-icons a .fa-youtube {
            color: #ff0000;
        }

        .footer-social-icons a:hover .fa-youtube {
            color: white;
        }

        /* Footer Titles */
        .footer-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            padding-bottom: 12px;
        }

        .footer-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 2px;
            background: var(--accent);
        }

        /* Footer Menu Links */
        .footer-menu {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .footer-menu li {
            margin-bottom: 10px;
        }

        .footer-menu a {
            font-size: 0.85rem;
            color: var(--gray-400);
            transition: color 0.2s ease;
            display: inline-block;
        }

        .footer-menu a:hover {
            color: var(--white);
        }

        /* Footer Contact Section */
        .footer-contact {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .footer-contact li {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 12px;
            font-size: 0.85rem;
            color: var(--gray-400);
        }

        .footer-contact li i {
            width: 20px;
            color: var(--accent);
            font-size: 1rem;
        }

        .footer-contact li a {
            color: var(--gray-400);
            transition: color 0.2s ease;
        }

        .footer-contact li a:hover {
            color: var(--white);
        }

        .footer-contact li .fa-whatsapp {
            color: #25d366;
        }

        /* Footer Bottom */
        .footer-bottom {
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid rgba(255,255,255,0.1);
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .footer-bottom p {
            font-size: 0.75rem;
            color: var(--gray-500);
            margin: 0;
        }

        .footer-bottom a {
            font-size: 0.75rem;
            color: var(--gray-500);
            transition: color 0.2s ease;
        }

        .footer-bottom a:hover {
            color: var(--white);
        }

        .footer-legal-links {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .footer-legal-links span {
            color: var(--gray-500);
            font-size: 0.75rem;
        }

        /* Desktop adjustments for footer */
        @media (min-width: 600px) {
            .footer-container {
                max-width: 900px;
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: space-between;
            }

            .footer-column {
                text-align: left;
                flex: 1;
                min-width: 200px;
            }

            .footer-brand {
                flex: 1 1 100%;
                text-align: center;
                margin-bottom: 24px;
            }

            .footer-title::after {
                left: 0;
                transform: none;
            }

            .footer-contact li {
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>

<!-- Trust Bar - Horizontal Scroll -->
<div class="trust-bar">
    <div class="trust-bar-scroll">
        <!-- First set -->
        <a href="#reviews" class="trust-bar-item">
            <i class="fas fa-star"></i>
            <span>4.8/5 Google</span>
        </a>
        <a href="#come-funziona" class="trust-bar-item">
            <i class="fas fa-certificate"></i>
            <span>ISO Certified</span>
        </a>
        <a href="#come-funziona" class="trust-bar-item">
            <i class="fas fa-clock"></i>
            <span>10+ Years Experience</span>
        </a>
        <a href="#pricing" class="trust-bar-item">
            <i class="fas fa-shield-alt"></i>
            <span>Lifetime Warranty</span>
        </a>
        <a href="#come-funziona" class="trust-bar-item">
            <i class="fas fa-user-md"></i>
            <span>English Staff</span>
        </a>
        <a href="#come-funziona" class="trust-bar-item">
            <i class="fas fa-plane"></i>
            <span>Free Transfer</span>
        </a>
        <a href="#pricing" class="trust-bar-item">
            <i class="fas fa-teeth"></i>
            <span>Tecnologia 3D</span>
        </a>
        <a href="#pricing" class="trust-bar-item">
            <i class="fas fa-euro-sign"></i>
            <span>-75% vs Italia</span>
        </a>
        <!-- Duplicate for infinite scroll -->
        <a href="#reviews" class="trust-bar-item">
            <i class="fas fa-star"></i>
            <span>4.8/5 Google</span>
        </a>
        <a href="#come-funziona" class="trust-bar-item">
            <i class="fas fa-certificate"></i>
            <span>ISO Certified</span>
        </a>
        <a href="#come-funziona" class="trust-bar-item">
            <i class="fas fa-clock"></i>
            <span>10+ Years Experience</span>
        </a>
        <a href="#pricing" class="trust-bar-item">
            <i class="fas fa-shield-alt"></i>
            <span>Lifetime Warranty</span>
        </a>
        <a href="#come-funziona" class="trust-bar-item">
            <i class="fas fa-user-md"></i>
            <span>English Staff</span>
        </a>
        <a href="#come-funziona" class="trust-bar-item">
            <i class="fas fa-plane"></i>
            <span>Free Transfer</span>
        </a>
        <a href="#pricing" class="trust-bar-item">
            <i class="fas fa-teeth"></i>
            <span>Tecnologia 3D</span>
        </a>
        <a href="#pricing" class="trust-bar-item">
            <i class="fas fa-euro-sign"></i>
            <span>-75% vs Italia</span>
        </a>
    </div>
</div>

<!-- Navigation Bar -->
<nav class="navbar">
    <div class="navbar-container">
        <!-- Logo -->
        <a href="#" class="navbar-logo">
            <div class="navbar-logo-text">
                <span class="navbar-logo-main"><span>A</span><span>D</span><span class="letter-a">C</span></span>
                <div class="navbar-logo-sub">
                    <span>Albanian</span>
                    <span>Dental</span>
                    <span>Clinic</span>
                </div>
            </div>
        </a>

        <!-- Desktop Menu -->
        <ul class="navbar-menu">
            <li><a href="#" onclick="window.scrollTo({top: 0, behavior: 'smooth'}); return false;">Home</a></li>
            <li class="navbar-dropdown">
                <a href="chi-siamo.html">√Ä Propos</a>
                <div class="dropdown-menu">
                    <a href="chi-siamo.html#missione">Notre Mission</a>
                    <a href="chi-siamo.html#ruolo">Notre R√¥le</a>
                    <a href="chi-siamo.html#tutela">Protection des Patients</a>
                    <a href="chi-siamo.html#prezzi">Prix les Plus Bas</a>
                    <a href="chi-siamo.html#esperienza">Votre Exp√©rience</a>
                </div>
            </li>
            <li><a href="#pricing">Tarifs</a></li>
            <li class="navbar-dropdown">
                <a href="#pricing">Traitements</a>
                <div class="dropdown-menu">
                    <a href="#" onclick="openProductModal('impianti'); return false;"><i class="fas fa-tooth" style="margin-right: 10px; color: var(--primary);"></i>Implants Dentaires</a>
                    <a href="#" onclick="openProductModal('corone'); return false;"><i class="fas fa-crown" style="margin-right: 10px; color: var(--primary);"></i>Couronnes et Facettes</a>
                    <a href="#" onclick="openProductModal('arcata'); return false;"><i class="fas fa-teeth" style="margin-right: 10px; color: var(--primary);"></i>All-on-4 / All-on-6</a>
                    <a href="#" onclick="openProductModal('impianti'); return false;"><i class="fas fa-bone" style="margin-right: 10px; color: var(--primary);"></i>Solutions Perte Osseuse</a>
                </div>
            </li>
            <li><a href="#come-funziona">Comment √áa Marche</a></li>
            <li><a href="#reviews">T√©moignages</a></li>
        </ul>

        <!-- Form CTA Button (Red) - Desktop & Mobile -->
        <button class="navbar-form-btn open-popup-btn" aria-label="Request Quote">
            <i class="fas fa-paper-plane"></i>
            <span>Quote</span>
        </button>
        <button class="navbar-toggle" onclick="toggleMobileMenu()">
            <span></span>
            <span></span>
            <span></span>
        </button>
    </div>
</nav>

<!-- Mobile Menu Overlay -->
<div class="mobile-menu-overlay" onclick="closeMobileMenu()"></div>

<!-- Mobile Slide-out Menu -->
<div class="mobile-menu">
    <div class="mobile-menu-header">
        <a href="#" class="navbar-logo" style="transform: scale(0.8); transform-origin: left;">
            <div class="navbar-logo-text">
                <span class="navbar-logo-main"><span>A</span><span>D</span><span class="letter-a">C</span></span>
                <div class="navbar-logo-sub">
                    <span>Albanian</span>
                    <span>Dental</span>
                    <span>Clinic</span>
                </div>
            </div>
        </a>
        <button class="mobile-menu-close" onclick="closeMobileMenu()">&times;</button>
    </div>
    <div class="mobile-menu-nav">
        <ul>
            <li><a href="#" onclick="closeMobileMenu()">Home</a></li>
            <li><a href="#pricing" onclick="closeMobileMenu()">Tarifs</a></li>
            <li><a href="#come-funziona" onclick="closeMobileMenu()">Comment √áa Marche</a></li>
            <li><a href="#reviews" onclick="closeMobileMenu()">Testimonials</a></li>
        </ul>
        <div class="menu-section-title">√Ä Propos</div>
        <ul>
            <li><a href="chi-siamo.html#missione" onclick="closeMobileMenu()">Notre Mission</a></li>
            <li><a href="chi-siamo.html#ruolo" onclick="closeMobileMenu()">Notre R√¥le</a></li>
            <li><a href="chi-siamo.html#tutela" onclick="closeMobileMenu()">Protection des Patients</a></li>
            <li><a href="chi-siamo.html#prezzi" onclick="closeMobileMenu()">Prix les Plus Bas</a></li>
            <li><a href="chi-siamo.html#esperienza" onclick="closeMobileMenu()">Votre Exp√©rience</a></li>
        </ul>
        <div class="menu-section-title">Traitements</div>
        <ul>
            <li><a href="#" onclick="openProductModal('impianti'); closeMobileMenu(); return false;">Implants Dentaires</a></li>
            <li><a href="#" onclick="openProductModal('corone'); closeMobileMenu(); return false;">Couronnes et Facettes</a></li>
            <li><a href="#" onclick="openProductModal('arcata'); closeMobileMenu(); return false;">All-on-4 / All-on-6</a></li>
            <li><a href="#" onclick="openProductModal('impianti'); closeMobileMenu(); return false;">Solutions Perte Osseuse</a></li>
        </ul>
    </div>
    <div class="mobile-menu-footer">
        <button class="btn btn-primary open-popup-btn" onclick="closeMobileMenu()">
            <i class="fas fa-calendar-check"></i>
            Demander un Devis Gratuit
        </button>
        <div class="mobile-menu-contact">
            <a href="tel:+37254450188" onclick="trackPhoneClick();">
                <i class="fas fa-phone"></i>
                +372 5445 0188
            </a>
            <a href="mailto:info@albaniandentalclinic.com">
                <i class="fas fa-envelope"></i>
                info@albaniandentalclinic.com
            </a>
        </div>
    </div>
</div>

<!-- Hero Section - PRICE FOCUSED + CAROUSEL -->
<section class="hero" id="home">
    <div class="container">
        <div class="hero-content">
            <h1>R√©server Maintenant</h1>
            <p class="hero-subtitle">Les prix les plus bas d'Albanie. Qualit√© europ√©enne certifi√©e.</p>

            <!-- Price Cards -->
            <div class="hero-price-cards">
                <!-- Impianto Card -->
                <div class="hero-price-card" onclick="openPopup()">
                    <div class="hero-price-icon"><i class="fas fa-tooth"></i></div>
                    <div class="hero-price-title">Implant Dentaire</div>
                    <div class="hero-price-main">‚Ç¨320</div>
                    <div class="hero-price-detail">Implant + Pilier inclus</div>
                    <div class="hero-price-comparison">Ailleurs: ‚Ç¨430</div>
                    <div class="hero-price-cta hero-price-cta-call">
                        <i class="fas fa-phone-alt"></i>
                        <span>Demander un Appel</span>
                    </div>
                </div>

                <!-- Corona Card -->
                <div class="hero-price-card" onclick="openQuoteSimulator()">
                    <div class="hero-price-icon"><i class="fas fa-gem"></i></div>
                    <div class="hero-price-title">Couronne Zircone</div>
                    <div class="hero-price-main">‚Ç¨160</div>
                    <div class="hero-price-detail">Zircone premium inclus</div>
                    <div class="hero-price-comparison">Ailleurs: ‚Ç¨200+</div>
                    <div class="hero-price-cta">
                        <i class="fas fa-calculator"></i>
                        <span>Calculer Maintenant</span>
                    </div>
                </div>
            </div>

            <!-- Brand Logos Strip - Premium -->
            <div class="hero-brands" onclick="openProductModal('impianti')">
                <div class="hero-brands-header">
                    <div class="hero-brands-icon">
                        <i class="fas fa-medal"></i>
                    </div>
                    <div class="hero-brands-label">Implants Premium Certifi√©s</div>
                </div>
                <div class="hero-brands-logos">
                    <img src="../images/strauman.grou[p.brand.JPG" alt="Straumann" class="hero-brand-logo" title="Straumann - Switzerland">
                    <img src="../images/megage.brand.JPG" alt="Megagen" class="hero-brand-logo" title="Megagen - South Korea">
                    <img src="../images/jddental.brand.JPG" alt="JD Dental Care" class="hero-brand-logo" title="JD Dental Care - Italy">
                    <img src="../images/tecom,brand.JPG" alt="Tecom" class="hero-brand-logo" title="Tecom Implants">
                    <img src="../images/toplan.ostem.brand.JPG" alt="Toplan Osstem" class="hero-brand-logo" title="Toplan / Osstem">
                </div>
                <div class="hero-brands-cta">
                    <span>D√©couvrir Tous les Implants</span>
                    <i class="fas fa-arrow-right"></i>
                </div>
            </div>

            <!-- Trust Bar -->
            <div class="hero-trust-bar">
                <div class="hero-trust-item">
                    <i class="fas fa-star"></i>
                    <span>4.8/5 Google</span>
                </div>
                <div class="hero-trust-item">
                    <i class="fas fa-users"></i>
                    <span>2,847 patients</span>
                </div>
                <div class="hero-trust-item">
                    <i class="fas fa-certificate"></i>
                    <span>Garantie √† Vie</span>
                </div>
            </div>
        </div>

        <!-- San Marco Clinic Card - Carousel -->
        <div class="hero-clinic-card" onclick="openClinicModal()">
            <div class="hero-carousel" id="heroCarousel">
                <div class="hero-carousel-track" id="heroCarouselTrack">
                    <!-- Treatment Images FIRST - for immediate engagement -->
                    <div class="hero-carousel-slide">
                        <img src="../images/arcatacompleta.PNG" alt="Full-Arch Rehabilitation on Implants">
                    </div>
                    <div class="hero-carousel-slide">
                        <img src="../images/arcata completa 2.PNG" alt="All-on-4 Upper Arch">
                    </div>
                    <div class="hero-carousel-slide">
                        <img src="../images/arcata completa3.PNG" alt="All-on-6 Lower Arch">
                    </div>
                    <!-- Clinic Interior Images -->
                    <div class="hero-carousel-slide">
                        <img src="../images/sanmarco9.PNG" alt="San Marco Dental Clinic - Main Hall">
                    </div>
                    <div class="hero-carousel-slide">
                        <img src="../images/sanamrco10.PNG" alt="San Marco Dental Clinic - Sterile Corridors">
                    </div>
                    <div class="hero-carousel-slide">
                        <img src="../images/sanamrco8..PNG" alt="San Marco Dental Clinic - Reception">
                    </div>
                    <div class="hero-carousel-slide">
                        <img src="../images/sanmarco12.PNG" alt="San Marco Dental Clinic - Consultation">
                    </div>
                    <div class="hero-carousel-slide">
                        <img src="../images/sanmarco3.PNG" alt="San Marco Dental Clinic - Welcome Area">
                    </div>
                    <div class="hero-carousel-slide">
                        <img src="../images/sanamrco.5.PNG" alt="San Marco Dental Clinic - Dental Unit">
                    </div>
                    <div class="hero-carousel-slide">
                        <img src="../images/sanmarcodental2..PNG" alt="San Marco Dental Clinic - Design Atrium">
                    </div>
                    <div class="hero-carousel-slide">
                        <img src="../images/sanmarco6.PNG" alt="San Marco Dental Clinic - Diagnostics">
                    </div>
                    <div class="hero-carousel-slide">
                        <img src="../images/sanamarco7.PNG" alt="San Marco Dental Clinic - Laboratory">
                    </div>
                    <div class="hero-carousel-slide">
                        <img src="../images/sanmarcodental.1.PNG" alt="San Marco Dental Clinic - Microscope">
                    </div>
                    <div class="hero-carousel-slide">
                        <img src="../images/sanmarco5.PNG" alt="San Marco Dental Clinic - Operating Room">
                    </div>
                </div>
                <div class="hero-carousel-dots" id="heroCarouselDots">
                    <div class="hero-carousel-dot active" data-index="0"></div>
                    <div class="hero-carousel-dot" data-index="1"></div>
                    <div class="hero-carousel-dot" data-index="2"></div>
                    <div class="hero-carousel-dot" data-index="3"></div>
                    <div class="hero-carousel-dot" data-index="4"></div>
                    <div class="hero-carousel-dot" data-index="5"></div>
                    <div class="hero-carousel-dot" data-index="6"></div>
                    <div class="hero-carousel-dot" data-index="7"></div>
                    <div class="hero-carousel-dot" data-index="8"></div>
                    <div class="hero-carousel-dot" data-index="9"></div>
                    <div class="hero-carousel-dot" data-index="10"></div>
                    <div class="hero-carousel-dot" data-index="11"></div>
                    <div class="hero-carousel-dot" data-index="12"></div>
                    <div class="hero-carousel-dot" data-index="13"></div>
                </div>
            </div>
            <div class="hero-clinic-overlay">
                <div class="hero-clinic-badge">
                    <i class="fas fa-check-circle"></i>
                    Partenaire V√©rifi√©
                </div>
                <h3 class="hero-clinic-name">San Marco Dental Clinic</h3>
                <p class="hero-clinic-cta"><i class="fas fa-images"></i> D√©couvrir la clinique</p>
            </div>
        </div>
    </div>
</section>

<!-- Pricing Section -->
<section class="pricing-section" id="pricing">
    <div class="container">
        <h2 class="section-title">Prix Transparents</h2>
        <span class="label" style="display: block; text-align: center; color: #718096; font-size: 0.9rem; margin-bottom: 8px;">Liste de prix officielle de la Clinique Dentaire Albanaise</span>
        <h3 style="text-align: center; font-size: 1.8rem; font-weight: 700; color: #1a202c; margin-bottom: 16px;">Prix des Services Dentaires en Albanie 2025</h3>
        <p style="text-align: center; color: #718096; max-width: 800px; margin: 0 auto 24px; line-height: 1.6;">Contactez-nous pour un devis pr√©cis. N'oubliez pas que les prix en Albanie peuvent √™tre plus bas, mais la qualit√© est la m√™me. Nous utilisons du zircone de haute qualit√© et les meilleurs implants dentaires, dont Straumann, Megagen, JD Implants et bien d'autres.</p>
        <p class="section-subtitle">Appuyez pour d√©couvrir toutes les options</p>

        <div class="pricing-grid">
            <div class="pricing-card" data-product="impianti" onclick="openProductModal('impianti')">
                <img src="../images/titanio.PNG" alt="Dental Implant" class="pricing-card-image" loading="lazy">
                <div class="pricing-card-content">
                    <div class="pricing-info">
                        <h3>Implant Dentaire</h3>
                        <span class="brand">7 marques disponibles</span>
                    </div>
                    <div class="pricing-value">
                        <span class="price-label">√Ä partir de</span>
                        <span class="price-range">&euro;300 - &euro;600</span>
                        <span class="tap-hint"><i class="fas fa-chevron-right"></i> Voir les options</span>
                    </div>
                </div>
            </div>

            <div class="pricing-card" data-product="corone" onclick="openProductModal('corone')">
                <img src="../images/corona.PNG" alt="Dental Crown" class="pricing-card-image" loading="lazy">
                <div class="pricing-card-content">
                    <div class="pricing-info">
                        <h3>Couronne Dentaire</h3>
                        <span class="brand">Zircone et C√©ramique</span>
                    </div>
                    <div class="pricing-value">
                        <span class="price-label">√Ä partir de</span>
                        <span class="price-range">&euro;100 - &euro;170</span>
                        <span class="tap-hint"><i class="fas fa-chevron-right"></i> Voir les options</span>
                    </div>
                </div>
            </div>

            <div class="pricing-card" data-product="arcata" onclick="openProductModal('arcata')">
                <img src="../images/arcata.PNG" alt="Full Arch" class="pricing-card-image" loading="lazy">
                <div class="pricing-card-content">
                    <div class="pricing-info">
                        <h3>Arcade Compl√®te</h3>
                        <span class="brand">All-on-4 / All-on-6</span>
                    </div>
                    <div class="pricing-value">
                        <span class="price-label">√Ä partir de</span>
                        <span class="price-range">&euro;2.400 - &euro;4.800</span>
                        <span class="tap-hint"><i class="fas fa-chevron-right"></i> Voir les options</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Plan de Traitement ALL ON 4 Section -->
<section class="treatment-plan-section" id="piano-trattamento">
    <div class="container">
        <div class="treatment-plan-header">
            <h2>Plan de Traitement ALL ON 4</h2>
            <p>Le parcours complet vers votre nouveau sourire en deux s√©ances</p>
        </div>

        <div class="treatment-plan-grid">
            <!-- Prima Seduta - Chirurgia -->
            <div class="treatment-card">
                <div class="treatment-card-header dark">
                    <p class="seduta-label">Premi√®re S√©ance:</p>
                    <h3>ALL ON 4 - Chirurgie</h3>
                </div>
                <div class="treatment-card-price">
                    <p class="price-description">Intervention chirurgicale incluse</p>
                    <p class="price-value">1.550 &euro;</p>
                    <p class="price-unit">par arcade</p>
                </div>
                <div class="treatment-card-features">
                    <ul>
                        <li><i class="fas fa-check"></i> 4 implants dentaires</li>
                        <li><i class="fas fa-check"></i> Extraction (si n√©cessaire)</li>
                        <li><i class="fas fa-check"></i> Proth√®se temporaire</li>
                        <li><i class="fas fa-check"></i> Intervention chirurgicale</li>
                        <li><i class="fas fa-check"></i> S√©dation</li>
                    </ul>
                </div>
                <div class="treatment-card-cta">
                    <button class="btn open-popup-btn">Demander un Devis</button>
                </div>
            </div>

            <div class="treatment-connector">+</div>

            <!-- Seconda Seduta - Chirurgia -->
            <div class="treatment-card">
                <div class="treatment-card-header light">
                    <p class="seduta-label">Deuxi√®me S√©ance:</p>
                    <h3>ALL ON 4 - Chirurgie</h3>
                </div>
                <div class="treatment-card-price">
                    <p class="price-description">Intervention chirurgicale incluse</p>
                    <p class="price-value">1.500 &euro;</p>
                    <p class="price-unit">par arcade</p>
                </div>
                <div class="treatment-card-features">
                    <ul>
                        <li><i class="fas fa-check"></i> 4 implants dentaires</li>
                        <li><i class="fas fa-check"></i> Extraction (si n√©cessaire)</li>
                        <li><i class="fas fa-check"></i> Proth√®se temporaire</li>
                        <li><i class="fas fa-check"></i> Intervention chirurgicale</li>
                        <li><i class="fas fa-check"></i> S√©dation</li>
                    </ul>
                </div>
                <div class="treatment-card-cta">
                    <button class="btn open-popup-btn">Demander un Devis</button>
                </div>
            </div>

            <div class="treatment-connector">o</div>

            <!-- Seconda Seduta - Protesia -->
            <div class="treatment-card featured">
                <div class="treatment-card-header light">
                    <p class="seduta-label">Deuxi√®me S√©ance:</p>
                    <h3>ALL ON 4 - Proth√®se</h3>
                </div>
                <div class="treatment-card-price">
                    <p class="price-description">Arcade en zircone</p>
                    <p class="price-value">2.220 &euro;</p>
                    <p class="price-unit">par arcade</p>
                </div>
                <div class="treatment-card-features">
                    <ul>
                        <li><i class="fas fa-check"></i> Long√©vit√© : 10-15 ans</li>
                        <li><i class="fas fa-check"></i> R√©sistance aux taches : √âlev√©e</li>
                        <li><i class="fas fa-check"></i> Esth√©tique : Tr√®s √©lev√©e</li>
                        <li><i class="fas fa-check"></i> Biocompatibilit√© : √âlev√©e</li>
                        <li><i class="fas fa-check"></i> Translucidit√© : √âlev√©e</li>
                    </ul>
                </div>
                <div class="treatment-card-cta">
                    <button class="btn open-popup-btn">Demander un Devis</button>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Reviews section moved to bottom -->

<!-- How It Works Detailed Section -->
<section class="come-funziona-section" id="come-funziona">
    <!-- 4-Step Quick Overview -->
    <div class="cf-overview">
        <div class="cf-overview-container">
            <h2 class="cf-overview-title">Votre Parcours en <span>4 √âtapes Simples</span></h2>
            <p class="cf-overview-subtitle">Du premier contact √† votre nouveau sourire, nous vous guidons √† chaque √©tape</p>
            <div class="cf-overview-steps">
                <div class="cf-overview-step cf-overview-step-clickable cf-overview-step-highlight" onclick="openQuoteSimulator()">
                    <div class="cf-overview-icon cf-overview-icon-large">
                        <img src="../images/landing.images.smarco/dentista-paziente.jpg" alt="Calcola Quote">
                    </div>
                    <div class="cf-overview-number">01</div>
                    <h3>Calculez Votre Devis</h3>
                    <p>D√©couvrez combien vous pouvez √©conomiser ! Calculez les co√ªts en temps r√©el</p>
                    <button class="cf-overview-btn" onclick="event.stopPropagation(); openQuoteSimulator()">
                        <i class="fas fa-calculator"></i> Calculer Maintenant
                    </button>
                </div>
                <div class="cf-overview-step cf-overview-step-clickable cf-overview-step-flight" onclick="openFlightSearch()">
                    <div class="cf-overview-icon cf-overview-icon-large">
                        <img src="../images/tour/Tirana_28.jpg" alt="Voli per Tirana">
                    </div>
                    <div class="cf-overview-number">02</div>
                    <h3>Rechercher des Vols vers Tirana</h3>
                    <p>Trouvez les meilleurs vols depuis l'Europe ! Prix en temps r√©el</p>
                    <button class="cf-overview-btn cf-overview-btn-flight" onclick="event.stopPropagation(); openFlightSearch()">
                        <i class="fas fa-plane"></i> Rechercher des Vols
                    </button>
                </div>
                <div class="cf-overview-step cf-overview-step-clickable cf-overview-step-booking" onclick="openBookingModal()">
                    <div class="cf-step-badge cf-badge-booking">
                        <i class="fas fa-credit-card"></i> R√âSERVER
                    </div>
                    <div class="cf-overview-icon cf-overview-icon-large">
                        <img src="../images/landing.images.smarco/dental-clinic.jpg" alt="R√©servez Votre Traitement">
                    </div>
                    <div class="cf-overview-number">03</div>
                    <h3>R√©servez Votre Traitement</h3>
                    <p>Confirmez avec le service de coordination et r√©servez votre date</p>
                    <button class="cf-overview-btn cf-overview-btn-booking" onclick="event.stopPropagation(); openBookingModal()">
                        <i class="fas fa-calendar-check"></i> R√©server Maintenant
                    </button>
                </div>
                <div class="cf-overview-step cf-overview-step-clickable cf-overview-step-tirana" onclick="openTiranaModal()">
                    <div class="cf-step-badge cf-badge-tirana">
                        <i class="fas fa-star"></i> D√âCOUVRIR TIRANA
                    </div>
                    <div class="cf-overview-icon cf-overview-icon-large">
                        <img src="../images/tour/piramide-tirana.jpg" alt="Tirana Experience - Piramide di Tirana">
                    </div>
                    <div class="cf-overview-number">04</div>
                    <h3>Votre Exp√©rience</h3>
                    <p>Support 24h/24, lieux √† visiter et assistance personnalis√©e</p>
                    <button class="cf-overview-btn cf-overview-btn-tirana" onclick="event.stopPropagation(); openTiranaModal()">
                        <i class="fas fa-calculator"></i> Planifiez Votre Voyage
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hero with Video - Two Column Layout -->
    <div class="cf-hero">
        <div class="cf-hero-container">
            <div class="cf-hero-content">
                <div class="cf-hero-badge">
                    <i class="fas fa-plane"></i>
                    Tourisme Dentaire en Albanie
                </div>
                <h1>Comment Fonctionne le <span>Tourisme Dentaire</span> en Albanie ?</h1>
                <p class="cf-hero-subtitle">D√©couvrez comment des milliers de patients ont transform√© leur sourire en √©conomisant jusqu'√† 75%. Un processus simple, s√ªr et enti√®rement accompagn√©.</p>
            </div>

            <div class="cf-video-card">
                <div class="cf-video-container">
                    <video id="cfHeroVideo" poster="images/sanmarco9.PNG" preload="metadata" data-start-time="11">
                        <source src="../images/instagram.videos/eng_video_1.mp4#t=11" type="video/mp4">
                    </video>
                    <div class="cf-video-play-btn" onclick="toggleVideoPlay('cfHeroVideo', this)">
                        <i class="fas fa-play"></i>
                    </div>
                    <div class="video-controls" id="controls-cfHeroVideo">
                        <button class="video-control-btn play-pause-btn" onclick="toggleVideoPlay('cfHeroVideo')">
                            <i class="fas fa-pause"></i>
                        </button>
                        <button class="video-control-btn mute-btn" onclick="toggleVideoMute('cfHeroVideo')">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Step 01 -->
    <div class="cf-step">
        <div class="cf-step-container">
            <div class="cf-step-content">
                <div class="cf-step-image">
                    <img src="../images/instagram.images/ig_image_6_1_20251125.jpg" alt="Request free quote" loading="lazy">
                </div>
                <div class="cf-step-text">
                    <div class="cf-step-number"><span>01</span> Premi√®re √âtape</div>
                    <h2>Demandez Votre <span>Devis Gratuit</span> depuis l'Europe</h2>
                    <p class="cf-step-description">Tout commence par une simple demande. Envoyez-nous votre radiographie dentaire et nous vous fournirons un devis d√©taill√© sous 24 heures, sans engagement.</p>
                    <ul class="cf-step-features">
                        <li><i class="fas fa-check"></i> Consultation gratuite via WhatsApp ou t√©l√©phone</li>
                        <li><i class="fas fa-check"></i> Devis d√©taill√© sous 24 heures</li>
                        <li><i class="fas fa-check"></i> Plan de traitement personnalis√©</li>
                        <li><i class="fas fa-check"></i> Sans engagement ni frais cach√©s</li>
                    </ul>
                    <button class="cf-step-cta" onclick="openQuoteSimulator()">
                        <i class="fas fa-calculator"></i>
                        Calculez Votre Devis
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Step 02 -->
    <div class="cf-step">
        <div class="cf-step-container">
            <div class="cf-step-content">
                <div class="cf-step-image">
                    <img src="../images/landing.images.smarco/carousel-sanmarco-3.jpg" alt="Organizzazione viaggio" loading="lazy">
                </div>
                <div class="cf-step-text">
                    <div class="cf-step-number"><span>02</span> Deuxi√®me √âtape</div>
                    <h2>Pr√™t √† Voyager ? <span>Nous Nous Occupons</span> de Tout</h2>
                    <p class="cf-step-description">Une fois le devis confirm√©, notre √©quipe s'occupe d'organiser chaque d√©tail de votre voyage. Vous n'avez qu'√† r√©server le vol !</p>
                    <ul class="cf-step-features">
                        <li><i class="fas fa-check"></i> Assistance √† la r√©servation de vol</li>
                        <li><i class="fas fa-check"></i> Conseils sur les dates et la dur√©e du s√©jour</li>
                        <li><i class="fas fa-check"></i> Support en fran√ßais 24h/24</li>
                        <li><i class="fas fa-check"></i> Coordination compl√®te du voyage</li>
                    </ul>
                    <button class="cf-overview-btn cf-overview-btn-flight" onclick="openFlightSearch()" style="margin-top: 20px;">
                        <i class="fas fa-plane"></i> Rechercher des Vols
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Step 03 -->
    <div class="cf-step">
        <div class="cf-step-container">
            <div class="cf-step-content">
                <div class="cf-step-image">
                    <img src="../images/tour/Tirana_28.jpg" alt="Transfer aeroporto Tirana" loading="lazy">
                </div>
                <div class="cf-step-text">
                    <div class="cf-step-number"><span>03</span> Troisi√®me √âtape</div>
                    <h2>De l'A√©roport √† la Clinique : <span>Transfert Gratuit</span></h2>
                    <p class="cf-step-description">√Ä votre arriv√©e √† l'a√©roport de Tirana, notre chauffeur vous attendra pour vous emmener confortablement √† la clinique ou √† votre h√©bergement. Service enti√®rement gratuit.</p>
                    <ul class="cf-step-features">
                        <li><i class="fas fa-check"></i> Chauffeur d√©di√© √† l'a√©roport de Tirana</li>
                        <li><i class="fas fa-check"></i> Transfert aller-retour gratuit</li>
                        <li><i class="fas fa-check"></i> V√©hicules confortables climatis√©s</li>
                        <li><i class="fas fa-check"></i> Transferts inclus pendant votre s√©jour</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Step 04 -->
    <div class="cf-step">
        <div class="cf-step-container">
            <div class="cf-step-content">
                <div class="cf-step-image">
                    <img src="../images/tour/la-splendida-cupola-ingresso.jpg" alt="Alloggio confortevole Tirana" loading="lazy">
                </div>
                <div class="cf-step-text">
                    <div class="cf-step-number"><span>04</span> Quatri√®me √âtape</div>
                    <h2>S√©jour <span>Confortable</span> √† Tirana</h2>
                    <p class="cf-step-description">Nous vous aidons √† trouver l'h√©bergement parfait pr√®s de la clinique. H√¥tels 4 √©toiles, appartements modernes ou B&B accueillants : choisissez la solution id√©ale pour vous.</p>
                    <ul class="cf-step-features">
                        <li><i class="fas fa-check"></i> H√¥tels partenaires √† tarifs sp√©ciaux</li>
                        <li><i class="fas fa-check"></i> √âtablissements pr√®s de la clinique</li>
                        <li><i class="fas fa-check"></i> Assistance √† la r√©servation</li>
                        <li><i class="fas fa-check"></i> Tirana : ville s√ªre et accueillante</li>
                    </ul>
                    <button class="cf-overview-btn cf-overview-btn-tirana" onclick="openTiranaModal()" style="margin-top: 20px;">
                        <i class="fas fa-calculator"></i> Planifiez Votre Itin√©raire
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Step 05 -->
    <div class="cf-step">
        <div class="cf-step-container">
            <div class="cf-step-content">
                <div class="cf-step-image">
                    <img src="../images/landing.images.smarco/dentista-paziente.jpg" alt="Trattamenti dentali indolori" loading="lazy">
                </div>
                <div class="cf-step-text">
                    <div class="cf-step-number"><span>05</span> Cinqui√®me √âtape</div>
                    <h2>Traitements <span>Sans Douleur</span> avec Technologie Avanc√©e</h2>
                    <p class="cf-step-description">Nos cliniques utilisent les technologies les plus modernes et des protocoles avanc√©s pour garantir des traitements indolores et d'excellents r√©sultats.</p>
                    <ul class="cf-step-features">
                        <li><i class="fas fa-check"></i> S√©dation consciente disponible</li>
                        <li><i class="fas fa-check"></i> Technologies num√©riques derni√®re g√©n√©ration</li>
                        <li><i class="fas fa-check"></i> Protocoles mini-invasifs</li>
                        <li><i class="fas fa-check"></i> Dentistes sp√©cialis√©s avec exp√©rience internationale</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Step 06 -->
    <div class="cf-step">
        <div class="cf-step-container">
            <div class="cf-step-content">
                <div class="cf-step-image">
                    <img src="../images/landing.images.smarco/carousel-sanmarco-6.jpg" alt="Esperti dental implants" loading="lazy">
                </div>
                <div class="cf-step-text">
                    <div class="cf-step-number"><span>06</span> Sixi√®me √âtape</div>
                    <h2>Experts en <span>Implantologie</span> et Proth√®ses Dentaires</h2>
                    <p class="cf-step-description">Nos sp√©cialistes ont pos√© des milliers d'implants avec des taux de r√©ussite sup√©rieurs √† 98%. Nous utilisons uniquement des mat√©riaux certifi√©s avec garantie √† vie.</p>
                    <ul class="cf-step-features">
                        <li><i class="fas fa-check"></i> Implants premium : Nobel, Straumann, Alpha Bio</li>
                        <li><i class="fas fa-check"></i> Garantie √† vie sur les implants</li>
                        <li><i class="fas fa-check"></i> Plus de 10 000 implants pos√©s</li>
                        <li><i class="fas fa-check"></i> Taux de r√©ussite &gt;98%</li>
                    </ul>
                    <button class="cf-overview-btn cf-overview-btn-booking" onclick="openBookingModal()" style="margin-top: 20px;">
                        <i class="fas fa-calendar-check"></i> R√©server Maintenant
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Treatment Phases with Videos -->
    <div class="cf-phases">
        <div class="cf-phases-header">
            <h2>Phases du <span>Traitement</span></h2>
            <p>D√©couvrez notre fa√ßon de travailler : qualit√©, pr√©cision et soins aux patients</p>
        </div>

        <div class="cf-phases-grid">
            <!-- Phase 1 -->
            <div class="cf-phase-card">
                <div class="cf-phase-video">
                    <video id="phaseVideo1" poster="../images/instagram.videos/eng_video_2.jpg" preload="auto" playsinline webkit-playsinline>
                        <source src="../images/instagram.videos/eng_video_2.mp4" type="video/mp4">
                    </video>
                    <div class="cf-phase-video-play" onclick="toggleVideoPlay('phaseVideo1', this)">
                        <i class="fas fa-play"></i>
                    </div>
                    <div class="video-controls" id="controls-phaseVideo1">
                        <button class="video-control-btn play-pause-btn" onclick="toggleVideoPlay('phaseVideo1')">
                            <i class="fas fa-pause"></i>
                        </button>
                        <button class="video-control-btn mute-btn" onclick="toggleVideoMute('phaseVideo1')">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
                <div class="cf-phase-content">
                    <div class="cf-phase-number">1</div>
                    <h3>Diagnostic et Planification</h3>
                    <p>Scanner 3D, num√©risation digitale et planification informatique pour un r√©sultat pr√©cis et pr√©visible.</p>
                </div>
            </div>

            <!-- Phase 2 -->
            <div class="cf-phase-card">
                <div class="cf-phase-video">
                    <video id="phaseVideo2" poster="../images/instagram.videos/eng_video_3.jpg" preload="auto" playsinline webkit-playsinline>
                        <source src="../images/instagram.videos/eng_video_3.mp4" type="video/mp4">
                    </video>
                    <div class="cf-phase-video-play" onclick="toggleVideoPlay('phaseVideo2', this)">
                        <i class="fas fa-play"></i>
                    </div>
                    <div class="video-controls" id="controls-phaseVideo2">
                        <button class="video-control-btn play-pause-btn" onclick="toggleVideoPlay('phaseVideo2')">
                            <i class="fas fa-pause"></i>
                        </button>
                        <button class="video-control-btn mute-btn" onclick="toggleVideoMute('phaseVideo2')">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
                <div class="cf-phase-content">
                    <div class="cf-phase-number">2</div>
                    <h3>Proc√©dure Chirurgicale</h3>
                    <p>Pose d'implants avec techniques mini-invasives et s√©dation pour un confort maximal.</p>
                </div>
            </div>

            <!-- Phase 3 -->
            <div class="cf-phase-card">
                <div class="cf-phase-video">
                    <video id="phaseVideo3" poster="../images/instagram.videos/eng_video_1.jpg" preload="auto" playsinline webkit-playsinline>
                        <source src="../images/instagram.videos/eng_video_1.mp4" type="video/mp4">
                    </video>
                    <div class="cf-phase-video-play" onclick="toggleVideoPlay('phaseVideo3', this)">
                        <i class="fas fa-play"></i>
                    </div>
                    <div class="video-controls" id="controls-phaseVideo3">
                        <button class="video-control-btn play-pause-btn" onclick="toggleVideoPlay('phaseVideo3')">
                            <i class="fas fa-pause"></i>
                        </button>
                        <button class="video-control-btn mute-btn" onclick="toggleVideoMute('phaseVideo3')">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
                <div class="cf-phase-content">
                    <div class="cf-phase-number">3</div>
                    <h3>Proth√®se Finale</h3>
                    <p>Couronnes et proth√®ses en zircone sur mesure pour un sourire naturel et durable.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Final CTA -->
    <div class="cf-final-cta">
        <h2>Commencez Votre Voyage Aujourd'hui</h2>
        <p>Rejoignez des milliers de patients qui ont d√©j√† choisi nos cliniques pour leur nouveau sourire</p>
        <div class="cf-cta-buttons">
            <button class="cf-cta-btn cf-cta-btn-primary open-popup-btn">
                <i class="fas fa-calendar-check"></i>
                Demander un Devis Gratuit
            </button>
            <a href="tel:+37254450188" class="cf-cta-btn cf-cta-btn-secondary" onclick="trackPhoneClick();">
                <i class="fas fa-phone"></i>
                Appelez-Nous
            </a>
        </div>
    </div>
</section>


<!-- Enhanced Google Reviews Section - Elfsight Style -->
<section class="reviews-section-enhanced" id="reviews">
    <div class="container">
        <!-- Header with Google Branding -->
        <div class="reviews-header">
            <div class="reviews-brand">
                <a href="https://www.youtube.com/@clinicadentalealbania" target="_blank" class="reviews-clinic-logo-link">
                    <div class="reviews-clinic-logo youtube-logo">
                        <i class="fab fa-youtube"></i>
                    </div>
                </a>
                <div class="reviews-clinic-info">
                    <h3>Albanian Dental Clinic</h3>
                    <div class="reviews-rating-summary">
                        <span class="reviews-score">5.0</span>
                        <div class="reviews-stars">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <span class="reviews-count">168 avis</span>
                    </div>
                </div>
            </div>
            <a href="https://search.google.com/local/writereview?placeid=ChIJk4tO7oQxUBMRsN1HHu8PW1s" target="_blank" class="reviews-write-btn">
                <svg class="google-g-icon" viewBox="0 0 24 24" width="18" height="18">
                    <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                    <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                    <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                    <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                </svg>
                √âcrire un avis
            </a>
        </div>

        <!-- Reviews Carousel -->
        <div class="reviews-carousel-container">
            <button class="reviews-nav-btn reviews-prev" onclick="slideReviews(-1)">
                <i class="fas fa-chevron-left"></i>
            </button>

            <div class="reviews-carousel" id="reviewsCarousel">
                <!-- Review 1 - Marlind Parllaku -->
                <div class="review-card-enhanced">
                    <div class="review-card-header">
                        <div class="review-avatar-img" style="background: #1a73e8;">M</div>
                        <div class="review-info">
                            <h4>Marlind Parllaku</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">2 weeks ago</span>
                        </div>
                        <svg class="google-review-icon" viewBox="0 0 24 24" width="24" height="24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                    </div>
                    <p class="review-text-enhanced">Excellente exp√©rience ! Personnel professionnel et tr√®s accueillant. La clinique est moderne et impeccablement propre. J'ai fait poser des implants dentaires et le r√©sultat est parfait. Hautement recommand√© √† tous !</p>
                </div>

                <!-- Review 2 - Ledio Fejzaj -->
                <div class="review-card-enhanced">
                    <div class="review-card-header">
                        <div class="review-avatar-img" style="background: #e53935;">L</div>
                        <div class="review-info">
                            <h4>Ledio Fejzaj</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">1 month ago</span>
                        </div>
                        <svg class="google-review-icon" viewBox="0 0 24 24" width="24" height="24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                    </div>
                    <p class="review-text-enhanced">I came from Europe for a complex procedure. The team followed me at every stage, from the airport to the end of treatment. Honest prices and superior quality. We will definitely be back!</p>
                </div>

                <!-- Review 3 - Rovena Dyrmishi -->
                <div class="review-card-enhanced">
                    <div class="review-card-header">
                        <div class="review-avatar-img" style="background: #43a047;">R</div>
                        <div class="review-info">
                            <h4>Rovena Dyrmishi</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">3 weeks ago</span>
                        </div>
                        <svg class="google-review-icon" viewBox="0 0 24 24" width="24" height="24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                    </div>
                    <p class="review-text-enhanced">Finally found a clinic I can trust! The dentists are very skilled and patient. They explained everything in detail. Modern and super hygienic environment. Well-deserved 5 stars!</p>
                </div>

                <!-- Review 4 - Eda Jasini -->
                <div class="review-card-enhanced">
                    <div class="review-card-header">
                        <div class="review-avatar-img" style="background: #8e24aa;">E</div>
                        <div class="review-info">
                            <h4>Eda Jasini</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">1 month ago</span>
                        </div>
                        <svg class="google-review-icon" viewBox="0 0 24 24" width="24" height="24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                    </div>
                    <p class="review-text-enhanced">I was afraid of the dentist for years, but here I immediately felt at ease. Very kind team and incredible results. My new smile is beautiful! Thank you!</p>
                </div>

                <!-- Review 5 - Besmir Kthupi -->
                <div class="review-card-enhanced">
                    <div class="review-card-header">
                        <div class="review-avatar-img" style="background: #fb8c00;">B</div>
                        <div class="review-info">
                            <h4>Besmir Kthupi</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">2 months ago</span>
                        </div>
                        <svg class="google-review-icon" viewBox="0 0 24 24" width="24" height="24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                    </div>
                    <p class="review-text-enhanced">European quality at affordable prices. I saved more than 60% compared to prices at home for the same work. The doctor and his team are true professionals. Super recommended!</p>
                </div>

                <!-- Review 6 - Emiliano Sultafa -->
                <div class="review-card-enhanced">
                    <div class="review-card-header">
                        <div class="review-avatar-img" style="background: #00897b;">E</div>
                        <div class="review-info">
                            <h4>Emiliano Sultafa</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">3 months ago</span>
                        </div>
                        <svg class="google-review-icon" viewBox="0 0 24 24" width="24" height="24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                    </div>
                    <p class="review-text-enhanced">From the first call to the final result, everything was perfect! Impeccable organization, transfer included, partner hotel. I felt taken care of and pampered. Exceptional result!</p>
                </div>

                <!-- Review 7 - Marco Bianchi -->
                <div class="review-card-enhanced">
                    <div class="review-card-header">
                        <div class="review-avatar-img" style="background: #5c6bc0;">M</div>
                        <div class="review-info">
                            <h4>Marco Bianchi</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">Local Guide - 4 months ago</span>
                        </div>
                        <svg class="google-review-icon" viewBox="0 0 24 24" width="24" height="24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                    </div>
                    <p class="review-text-enhanced">Fantastic experience! The staff proved professional and courteous from the first contact. The environment is welcoming and cutting-edge. Great results at a contained cost. Highly recommended!</p>
                </div>

                <!-- Review 8 - Altin Janku -->
                <div class="review-card-enhanced">
                    <div class="review-card-header">
                        <div class="review-avatar-img" style="background: #e53e3e;">A</div>
                        <div class="review-info">
                            <h4>Altin Janku</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">5 months ago</span>
                        </div>
                        <svg class="google-review-icon" viewBox="0 0 24 24" width="24" height="24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                    </div>
                    <p class="review-text-enhanced">To find your smile, comfort and the pleasure of eating without discomfort, just take the first step: book a visit. You won't be disappointed, that's for sure!</p>
                </div>
            </div>

            <button class="reviews-nav-btn reviews-next" onclick="slideReviews(1)">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>

        <!-- Carousel Dots -->
        <div class="reviews-dots" id="reviewsDots"></div>

        <!-- View All Reviews Link -->
        <a href="https://search.google.com/local/reviews?placeid=ChIJk4tO7oQxUBMRsN1HHu8PW1s" target="_blank" class="reviews-view-all">
            <svg class="google-g-icon" viewBox="0 0 24 24" width="20" height="20">
                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
            </svg>
            View all 168 reviews on Google
        </a>
    </div>
</section>

<!-- Footer -->
<footer class="footer-new">
    <div class="footer-container">
        <!-- Logo & Social -->
        <div class="footer-column footer-brand">
            <div class="footer-logo-box">
                <span class="footer-logo-cda"><span>A</span><span>D</span><span class="letter-a">C</span></span>
                <span class="footer-logo-sub">ALBANIAN DENTAL CLINIC</span>
            </div>
            <p class="footer-tagline">R√©seau de Cliniques Certifi√©es</p>
            <div class="footer-follow">
                <span>Suivez-Nous</span>
                <div class="footer-social-icons">
                    <a href="https://www.instagram.com/dental.clinic.albania/" target="_blank" rel="noopener"><i class="fab fa-instagram"></i></a>
                    <a href="https://www.facebook.com/profile.php?id=61582986368461" target="_blank" rel="noopener"><i class="fab fa-facebook-f"></i></a>
                    <a href="https://www.youtube.com/channel/UCVJIQrLD9U0TVT_HLnVUMwg" target="_blank" rel="noopener"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
        </div>

        <!-- Trattamenti -->
        <div class="footer-column">
            <h4 class="footer-title">Traitements</h4>
            <ul class="footer-menu">
                <li><a href="#" onclick="openProductModal('impianti'); return false;">Dents Fixes sur Implants</a></li>
                <li><a href="#" onclick="openProductModal('corone'); return false;">Couronnes et Facettes Dentaires</a></li>
                <li><a href="#" onclick="openProductModal('arcata'); return false;">Solution All-on-4/6</a></li>
                <li><a href="#" onclick="openProductModal('impianti'); return false;">Solutions Perte Osseuse</a></li>
                <li><a href="#" onclick="openProductModal('impianti'); return false;">Implants avec Parodontite</a></li>
                <li><a href="#" onclick="openProductModal('arcata'); return false;">Adieu Proth√®ses Amovibles</a></li>
                <li><a href="#">Tourisme Dentaire en Albanie</a></li>
                <li><a href="#">Dentiste en Albanie</a></li>
                <li><a href="#">Soins Dentaires Albanie</a></li>
            </ul>
        </div>

        <!-- Informazioni -->
        <div class="footer-column">
            <h4 class="footer-title">Informations</h4>
            <ul class="footer-menu">
                <li><a href="#">Accueil</a></li>
                <li><a href="#come-funziona">Comment √áa Marche</a></li>
                <li><a href="#" onclick="openProductModal('impianti'); return false;">Tarifs</a></li>
                <li><a href="#" onclick="openProductModal('impianti'); return false;">Implants Dentaires</a></li>
                <li><a href="#">√Ä Propos</a></li>
            </ul>
        </div>

        <!-- Contatti -->
        <div class="footer-column">
            <h4 class="footer-title">Contactez-Nous</h4>
            <ul class="footer-contact">
                <li>
                    <i class="fas fa-phone"></i>
                    <a href="tel:+37254450188" onclick="trackPhoneClick();">+372 5445 0188</a>
                </li>
                <li>
                    <i class="fas fa-envelope"></i>
                    <a href="mailto:info@albaniandentalclinic.com">info@albaniandentalclinic.com</a>
                </li>
                <li>
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Tirana, Albania</span>
                </li>
            </ul>
        </div>
    </div>

    <!-- Copyright -->
    <div class="footer-bottom">
        <p>&copy; 2025 Albanian Dental Clinic. Tous droits r√©serv√©s.</p>
        <div class="footer-legal-links">
            <a href="privacy-policy.html">Politique de Confidentialit√©</a>
            <span>|</span>
            <a href="terms-conditions.html">Conditions G√©n√©rales</a>
        </div>
    </div>
</footer>

<!-- Floating CTA Bar (Mobile) -->
<div class="floating-cta-bar">
    <button class="btn btn-primary open-popup-btn">
        <i class="fas fa-calendar-check"></i>
        Devis Gratuit
    </button>
</div>

<!-- Live Chat Widget -->
<div class="live-chat-widget" id="liveChatWidget">
    <!-- Chat Toggle Button -->
    <div class="chat-toggle-btn" onclick="toggleChatWindow()">
        <span class="chat-label">Besoin d'Aide ?</span>
        <div class="chat-icon">
            <i class="fas fa-comments"></i>
            <span class="notification-dot"></span>
        </div>
    </div>

    <!-- Chat Window -->
    <div class="chat-window" id="chatWindow">
        <div class="chat-header">
            <div class="chat-header-avatar">
                <i class="fas fa-tooth"></i>
            </div>
            <div class="chat-header-info">
                <h4>Albanian Dental Clinic</h4>
                <p><span class="online-dot"></span> En ligne - Nous r√©pondons imm√©diatement</p>
            </div>
            <button class="chat-close" onclick="toggleChatWindow()">&times;</button>
        </div>

        <div class="chat-messages" id="chatMessages">
            <div class="chat-message bot">
                <div class="message-avatar"><i class="fas fa-tooth"></i></div>
                <div class="message-bubble">
                    Bonjour ! üëã Bienvenue √† la Clinique Dentaire Albanaise. Comment puis-je vous aider aujourd'hui ?
                </div>
            </div>
            <div class="chat-message bot">
                <div class="message-avatar"><i class="fas fa-tooth"></i></div>
                <div class="message-bubble">
                    √âcrivez votre question et nous r√©pondrons imm√©diatement !
                </div>
            </div>
        </div>

        <div class="chat-input-area">
            <input type="text" class="chat-input" id="chatInput" placeholder="Tapez un message..." onkeypress="handleChatKeyPress(event)">
            <button class="chat-send-btn" onclick="sendChatMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>
</div>

<!-- Form Popup -->
<div class="popup-overlay" id="popup-overlay">
    <div class="popup-container">
        <div class="popup-header">
            <button class="popup-close" onclick="closePopup()">&times;</button>
            <h3>Demander un Devis Gratuit</h3>
            <p>Remplissez le formulaire et nous vous contacterons sous 24h</p>
        </div>
        <form class="popup-form" id="lead-form" autocomplete="off">
            <!-- Hidden UTM Tracking Fields -->
            <input type="hidden" id="utm_source" name="utm_source" value="">
            <input type="hidden" id="utm_medium" name="utm_medium" value="">
            <input type="hidden" id="utm_campaign" name="utm_campaign" value="">
            <input type="hidden" id="utm_term" name="utm_term" value="">
            <input type="hidden" id="utm_content" name="utm_content" value="">
            <input type="hidden" id="gclid" name="gclid" value="">
            <input type="hidden" id="fbclid" name="fbclid" value="">
            <input type="hidden" id="source" name="source" value="landing-page-mobile">
            <input type="hidden" id="paese_provenienza" name="paese_provenienza" value="IT">

            <div class="form-group">
                <label for="first_name">Pr√©nom *</label>
                <input type="text" id="first_name" name="fname_new" class="form-control" value="" placeholder="" required autocomplete="new-password">
            </div>
            <div class="form-group">
                <label for="last_name">Nom *</label>
                <input type="text" id="last_name" name="lname_new" class="form-control" value="" placeholder="" required autocomplete="new-password">
            </div>
            <div class="form-group">
                <label for="city">Ville *</label>
                <input type="text" id="city" name="city_new" class="form-control" value="" placeholder="" required autocomplete="new-password">
            </div>
            <div class="form-group">
                <label for="phone">T√©l√©phone *</label>
                <input type="tel" id="phone" name="phone_new" class="form-control" value="" placeholder="" required autocomplete="new-password">
            </div>

            <!-- Privacy Consent - REQUIRED -->
            <div class="form-group privacy-consent">
                <div style="display: flex; align-items: flex-start;">
                    <input type="checkbox" id="privacy_consent" name="privacy_consent" required
                           style="margin-right: 12px; margin-top: 4px; width: 20px; height: 20px; min-width: 20px;">
                    <label for="privacy_consent" style="font-size: 0.85rem; color: #666; cursor: pointer;">
                        I consent to the processing of personal data in accordance with GDPR *
                    </label>
                </div>
            </div>

            <button type="submit" class="form-submit">
                <i class="fas fa-paper-plane"></i>
                Request Free Quote
            </button>

            <!-- Expandable Extra Fields -->
            <div style="margin-top: 16px;">
                <button type="button" id="toggleExtra" style="background: none; border: none; color: var(--primary-color); cursor: pointer; font-size: 0.9rem; display: flex; align-items: center; gap: 8px;">
                    <span>Tell us more (optional)</span>
                    <i class="fas fa-chevron-down" id="chevronIcon"></i>
                </button>

                <div id="extraFields" style="display: none; margin-top: 16px;">
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" class="form-control" value="" placeholder="Your email" autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="treatment">Treatment of Interest</label>
                        <select id="treatment" name="treatment" class="form-control">
                            <option value="">Select...</option>
                            <option value="Single implants">Single implants</option>
                            <option value="Fixed prosthesis All-on-4">Fixed prosthesis (All-on-4)</option>
                            <option value="Fixed prosthesis All-on-6">Fixed prosthesis (All-on-6)</option>
                            <option value="Dental crowns">Dental crowns</option>
                            <option value="Dental veneers">Dental veneers</option>
                            <option value="Zygomatic implants">Zygomatic implants</option>
                            <option value="Dental bridge">Dental bridge</option>
                            <option value="Teeth whitening">Teeth whitening</option>
                            <option value="General consultation">General consultation</option>
                            <option value="Other">Other treatment</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="message">Additional Notes</label>
                        <textarea id="message" name="message" class="form-control" rows="3" placeholder="Briefly describe your situation..."></textarea>
                    </div>
                </div>
            </div>

            <p class="form-note">
                <i class="fas fa-lock"></i> Your data is safe. We do not share with third parties.
            </p>
        </form>
    </div>
</div>

<!-- Success Modal -->
<div class="success-modal-overlay" id="success-modal">
    <div class="success-modal">
        <div class="success-icon">
            <i class="fas fa-check-circle"></i>
        </div>
        <h3>Merci !</h3>
        <p>Votre demande a √©t√© envoy√©e avec succ√®s.</p>
        <p class="success-subtitle">Nous vous contacterons dans les 5 minutes.</p>
        <button class="success-btn" onclick="closeSuccessModal()">
            <i class="fas fa-thumbs-up"></i>
            Parfait !
        </button>
    </div>
</div>

<!-- Product Modal -->
<div class="product-modal-overlay" id="product-modal-overlay">
    <div class="product-modal">
        <div class="product-modal-header">
            <h3 id="product-modal-title">
                <i class="fas fa-tooth"></i>
                <span>Implants Dentaires</span>
            </h3>
            <button class="product-modal-close" onclick="closeProductModal()">&times;</button>
        </div>
        <div class="product-carousel-container">
            <div class="product-carousel" id="product-carousel">
                <!-- Products will be injected via JavaScript -->
            </div>
        </div>
        <div class="carousel-nav">
            <button class="carousel-arrow" id="carousel-prev" onclick="carouselPrev()">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div class="carousel-dots" id="carousel-dots">
                <!-- Dots will be injected via JavaScript -->
            </div>
            <button class="carousel-arrow" id="carousel-next" onclick="carouselNext()">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
        <div class="product-modal-cta">
            <button class="btn btn-primary open-popup-btn" onclick="closeProductModal();">
                <i class="fas fa-file-alt"></i>
                Demander un Devis Gratuit
            </button>
        </div>
    </div>
</div>

<!-- Clinic Gallery Modal -->
<div class="product-modal-overlay" id="clinic-modal-overlay">
    <div class="product-modal">
        <div class="product-modal-header" style="background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);">
            <h3 id="clinic-modal-title">
                <i class="fas fa-hospital"></i>
                <span>San Marco Dental Clinic</span>
            </h3>
            <button class="product-modal-close" onclick="closeClinicModal()">&times;</button>
        </div>
        <div class="product-carousel-container">
            <div class="product-carousel" id="clinic-carousel">
                <!-- Clinic images will be injected via JavaScript -->
            </div>
        </div>
        <div class="carousel-nav">
            <button class="carousel-arrow" onclick="clinicCarouselPrev()">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div class="carousel-dots" id="clinic-carousel-dots">
                <!-- Dots will be injected via JavaScript -->
            </div>
            <button class="carousel-arrow" onclick="clinicCarouselNext()">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
        <div class="product-modal-cta">
            <button class="btn btn-primary open-popup-btn" onclick="closeClinicModal();">
                <i class="fas fa-calendar-check"></i>
                R√©server une Visite Gratuite
            </button>
        </div>
    </div>
</div>

<script>
// ========================================
// HERO CAROUSEL AUTO-SCROLL
// ========================================
let heroCarouselIndex = 0;
const heroCarouselSlides = 12;
let heroCarouselInterval;

function initHeroCarousel() {
    const track = document.getElementById('heroCarouselTrack');
    const dots = document.querySelectorAll('.hero-carousel-dot');

    if (!track || !dots.length) return;

    // Start auto-scroll
    heroCarouselInterval = setInterval(() => {
        heroCarouselIndex = (heroCarouselIndex + 1) % heroCarouselSlides;
        updateHeroCarousel();
    }, 4000);

    // Dot click handlers
    dots.forEach((dot, index) => {
        dot.addEventListener('click', (e) => {
            e.stopPropagation(); // Prevent opening modal when clicking dots
            heroCarouselIndex = index;
            updateHeroCarousel();
            // Reset interval
            clearInterval(heroCarouselInterval);
            heroCarouselInterval = setInterval(() => {
                heroCarouselIndex = (heroCarouselIndex + 1) % heroCarouselSlides;
                updateHeroCarousel();
            }, 4000);
        });
    });
}

function updateHeroCarousel() {
    const track = document.getElementById('heroCarouselTrack');
    const dots = document.querySelectorAll('.hero-carousel-dot');

    if (track) {
        track.style.transform = `translateX(-${heroCarouselIndex * 100}%)`;
    }

    dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === heroCarouselIndex);
    });
}

// Initialize on DOM ready
document.addEventListener('DOMContentLoaded', initHeroCarousel);

// ========================================
// COME FUNZIONA VIDEO PLAYER WITH CONTROLS
// ========================================
function toggleVideoPlay(videoId, initialPlayBtn) {
    const video = document.getElementById(videoId);
    const controls = document.getElementById('controls-' + videoId);
    const playBtn = initialPlayBtn || video.parentElement.querySelector('.cf-video-play-btn, .cf-phase-video-play');

    if (!video) return;

    if (video.paused) {
        // Pause all other videos first
        document.querySelectorAll('.cf-video-container video, .cf-phase-video video').forEach(v => {
            if (v.id !== videoId) {
                v.pause();
                const otherPlayBtn = v.parentElement.querySelector('.cf-video-play-btn, .cf-phase-video-play');
                const otherControls = document.getElementById('controls-' + v.id);
                if (otherPlayBtn) otherPlayBtn.classList.remove('hidden');
                if (otherControls) otherControls.classList.remove('visible');
                updatePlayPauseIcon(v.id, false);
            }
        });

        // Check for start time and set if video is at beginning
        const startTime = parseFloat(video.dataset.startTime) || 0;
        if (video.currentTime < startTime) {
            video.currentTime = startTime;
        }

        video.play();
        if (playBtn) playBtn.classList.add('hidden');
        if (controls) controls.classList.add('visible');
        updatePlayPauseIcon(videoId, true);
    } else {
        video.pause();
        if (playBtn) playBtn.classList.remove('hidden');
        if (controls) controls.classList.remove('visible');
        updatePlayPauseIcon(videoId, false);
    }

    // Add event listener for when video ends
    video.onended = function() {
        // Reset to start time when video ends
        const startTime = parseFloat(video.dataset.startTime) || 0;
        video.currentTime = startTime;
        if (playBtn) playBtn.classList.remove('hidden');
        if (controls) controls.classList.remove('visible');
        updatePlayPauseIcon(videoId, false);
    };
}

function toggleVideoMute(videoId) {
    const video = document.getElementById(videoId);
    if (!video) return;

    video.muted = !video.muted;
    updateMuteIcon(videoId, video.muted);
}

function updatePlayPauseIcon(videoId, isPlaying) {
    const controls = document.getElementById('controls-' + videoId);
    if (!controls) return;

    const playPauseBtn = controls.querySelector('.play-pause-btn i');
    if (playPauseBtn) {
        playPauseBtn.className = isPlaying ? 'fas fa-pause' : 'fas fa-play';
    }
}

function updateMuteIcon(videoId, isMuted) {
    const controls = document.getElementById('controls-' + videoId);
    if (!controls) return;

    const muteBtn = controls.querySelector('.mute-btn i');
    if (muteBtn) {
        muteBtn.className = isMuted ? 'fas fa-volume-mute' : 'fas fa-volume-up';
    }
}

// Keep old function name for compatibility
function playCFVideo(videoId, playBtn) {
    toggleVideoPlay(videoId, playBtn);
}

// Format seconds to mm:ss
function formatVideoTime(seconds) {
    if (isNaN(seconds) || !isFinite(seconds)) return '0:00';
    const mins = Math.floor(seconds / 60);
    const secs = Math.floor(seconds % 60);
    return mins + ':' + (secs < 10 ? '0' : '') + secs;
}

// Update video progress and time display
function updateVideoProgress(videoId) {
    const video = document.getElementById(videoId);
    const progressFill = document.getElementById('progress-' + videoId);
    const timeDisplay = document.getElementById('time-' + videoId);

    if (!video) return;

    const percent = (video.currentTime / video.duration) * 100;
    if (progressFill) {
        progressFill.style.width = percent + '%';
    }
    if (timeDisplay) {
        timeDisplay.textContent = formatVideoTime(video.currentTime) + ' / ' + formatVideoTime(video.duration);
    }
}

// Seek video when clicking progress bar
function seekVideo(event, videoId) {
    const video = document.getElementById(videoId);
    const progressBar = event.currentTarget;

    if (!video || !progressBar) return;

    const rect = progressBar.getBoundingClientRect();
    const clickX = event.clientX - rect.left;
    const percent = clickX / rect.width;

    video.currentTime = percent * video.duration;
    updateVideoProgress(videoId);
}

// Initialize video time tracking
function initVideoTimeTracking(videoId) {
    const video = document.getElementById(videoId);
    if (!video) return;

    video.addEventListener('timeupdate', () => updateVideoProgress(videoId));
    video.addEventListener('loadedmetadata', () => updateVideoProgress(videoId));
}

// Initialize all video time tracking on page load
document.addEventListener('DOMContentLoaded', function() {
    initVideoTimeTracking('cfHeroVideo');
    initVideoTimeTracking('phaseVideo1');
    initVideoTimeTracking('phaseVideo2');
    initVideoTimeTracking('phaseVideo3');
});

// ========================================
// REVIEWS CAROUSEL - ELFSIGHT STYLE
// ========================================
let reviewsCurrentIndex = 0;
let reviewsItemsPerView = 1;
let reviewsScrollHandler = null;
let reviewsScrollTimeout = null;
let reviewsResizeTimeout = null;

function initReviewsCarousel() {
    const carousel = document.getElementById('reviewsCarousel');
    const dotsContainer = document.getElementById('reviewsDots');

    if (!carousel || !dotsContainer) return;

    const cards = carousel.querySelectorAll('.review-card-enhanced');
    const totalCards = cards.length;

    // Calculate items per view based on screen width
    function updateItemsPerView() {
        if (window.innerWidth >= 992) {
            reviewsItemsPerView = 3;
        } else if (window.innerWidth >= 768) {
            reviewsItemsPerView = 2;
        } else {
            reviewsItemsPerView = 1;
        }
    }

    function rebuildDots() {
        updateItemsPerView();
        const totalPages = Math.ceil(totalCards / reviewsItemsPerView);

        dotsContainer.innerHTML = '';
        for (let i = 0; i < totalPages; i++) {
            const dot = document.createElement('div');
            dot.className = 'reviews-dot' + (i === 0 ? ' active' : '');
            dot.onclick = () => goToReviewsPage(i);
            dotsContainer.appendChild(dot);
        }
    }

    rebuildDots();

    // Remove old scroll listener if exists
    if (reviewsScrollHandler) {
        carousel.removeEventListener('scroll', reviewsScrollHandler);
    }

    // Update dots on scroll with debounce
    reviewsScrollHandler = function() {
        clearTimeout(reviewsScrollTimeout);
        reviewsScrollTimeout = setTimeout(() => {
            const scrollLeft = carousel.scrollLeft;
            const cardWidth = cards[0].offsetWidth + 16;
            const currentPage = Math.round(scrollLeft / (cardWidth * reviewsItemsPerView));

            document.querySelectorAll('.reviews-dot').forEach((dot, index) => {
                dot.classList.toggle('active', index === currentPage);
            });
        }, 100);
    };
    carousel.addEventListener('scroll', reviewsScrollHandler);

    // Reinitialize on resize with debounce
    window.addEventListener('resize', function() {
        clearTimeout(reviewsResizeTimeout);
        reviewsResizeTimeout = setTimeout(rebuildDots, 250);
    });
}

function slideReviews(direction) {
    const carousel = document.getElementById('reviewsCarousel');
    if (!carousel) return;

    const cards = carousel.querySelectorAll('.review-card-enhanced');
    const cardWidth = cards[0].offsetWidth + 16; // width + gap
    const scrollAmount = cardWidth * reviewsItemsPerView;

    carousel.scrollBy({
        left: direction * scrollAmount,
        behavior: 'smooth'
    });
}

function goToReviewsPage(pageIndex) {
    const carousel = document.getElementById('reviewsCarousel');
    if (!carousel) return;

    const cards = carousel.querySelectorAll('.review-card-enhanced');
    const cardWidth = cards[0].offsetWidth + 16;
    const scrollPosition = pageIndex * cardWidth * reviewsItemsPerView;

    carousel.scrollTo({
        left: scrollPosition,
        behavior: 'smooth'
    });
}

// Initialize reviews carousel on load
document.addEventListener('DOMContentLoaded', function() {
    initReviewsCarousel();
});

// ========================================
// CLINIC GALLERY DATA - San Marco Professional Images (30 slides)
// ========================================
const clinicGalleryData = [
    // === CLINICA SAN MARCO - Struttura ===
    {
        title: 'San Marco Main Hall',
        description: 'Luxury reception with contemporary design. Our ISO 9001 certified clinic guarantees European standards of dental excellence.',
        image: '../images/sanmarco9.PNG'
    },
    {
        title: 'Clinical Corridors',
        description: 'Sterile environment with optimal 5500K LED lighting for diagnosis. Antibacterial flooring and HEPA air filtration system.',
        image: '../images/sanamrco10.PNG'
    },
    {
        title: 'Reception & Check-in',
        description: 'Multilingual staff (English, German, French) for complete assistance. Digital clinical record management system.',
        image: '../images/sanamrco8..PNG'
    },
    {
        title: 'Implant Consultation',
        description: 'Free first visit with implant specialist. 3D CT scan analysis and personalized treatment plan included.',
        image: '../images/sanmarco12.PNG'
    },
    {
        title: 'Welcome Area',
        description: 'Air-conditioned waiting room with free WiFi. Coffee and water service for all patients.',
        image: '../images/sanmarco3.PNG'
    },
    {
        title: 'Dental Unit',
        description: 'Latest generation KaVo chair with integrated suction system. Adjustable intensity LED operating light.',
        image: '../images/sanamrco.5.PNG'
    },
    {
        title: 'Design Staircase Atrium',
        description: 'Modern 3-floor architecture with 12 operating rooms. Elevator for patients with reduced mobility.',
        image: '../images/sanmarcodental2..PNG'
    },
    {
        title: 'Digital Diagnostics',
        description: 'Digital radiographic system with 90% radiation reduction. 3D implant planning software.',
        image: '../images/sanmarco6.PNG'
    },
    {
        title: 'Dental Laboratory',
        description: 'On-site CAD/CAM for zirconia and lithium disilicate prosthetics. 50% reduced delivery times.',
        image: '../images/sanamarco7.PNG'
    },
    {
        title: 'Endodontic Microsurgery',
        description: 'Zeiss operating microscope with 25x magnification. Precision root canal treatments with 98% success rate.',
        image: '../images/sanmarcodental.1.PNG'
    },
    {
        title: 'Sterile Operating Room',
        description: 'Operating room with ISO Class 5 laminar flow. Certified Class B autoclave sterilization.',
        image: '../images/sanmarco5.PNG'
    },
    // === SOLUZIONI IMPLANTARI ===
    {
        title: 'Full-Arch Rehabilitation',
        description: 'Total prosthesis on 4-6 implants par arcade. Definitive solution for complete edentulism with immediate loading in 24-48 hours.',
        image: '../images/arcatacompleta.PNG'
    },
    {
        title: 'All-on-4 Upper Arch',
        description: 'Nobel Biocare All-on-4 technique for uppar arcade. 30-45 degree tilted implants for maximum stability without bone grafts.',
        image: '../images/arcata completa 2.PNG'
    },
    {
        title: 'All-on-6 Lower Arch',
        description: 'Mandibular rehabilitation with 6 implants. Optimal chewing load distribution for monolithic zirconia prosthesis.',
        image: '../images/arcata completa3.PNG'
    },
    {
        title: 'Complete Dental Arch',
        description: 'Toronto Bridge on osseointegrated implants. Permanent fixed teeth with natural aesthetics and 100% chewing function.',
        image: '../images/arcata.PNG'
    },
    {
        title: 'Single Implant with Crown',
        description: 'Single tooth replacement. Layered zirconia crown on implant with anti-rotational conical connection.',
        image: '../images/implant121.PNG'
    },
    // === PROTESI E CORONE ===
    {
        title: 'Zirconia Crown',
        description: 'Aesthetic restoration in zirconium oxide. 1200 MPa flexural strength, natural translucency, total biocompatibility.',
        image: '../images/corona.PNG'
    },
    {
        title: 'Metal-Free Crown',
        description: 'Full ceramic prosthesis. Zero metal allergies, superior aesthetics in anterior areas.',
        image: '../images/corona1.PNG'
    },
    {
        title: 'Monolithic Zirconia',
        description: 'Latest generation full-contour crowns. CAD/CAM milling with 20 micron precision, customized VITA color.',
        image: '../images/zircon.PNG'
    },
    // === SISTEMI IMPLANTARI ===
    {
        title: 'Grade 4 Titanium Implants',
        description: 'Pure medical titanium for optimal osseointegration. Plasma-treated SLA surface for accelerated healing in 6-8 weeks.',
        image: '../images/titanio.PNG'
    },
    {
        title: 'Megagen AnyRidge System',
        description: 'Progressive ridge design for maximum primary stability. Ideal for compromised bone and immediate post-extraction loading.',
        image: '../images/megagen.PNG'
    },
    {
        title: 'JD Evolution Implants',
        description: '11-degree conical connection with switching platform. Preservation of crestal bone and peri-implant soft tissues.',
        image: '../images/jdevolution.PNG'
    },
    {
        title: 'Osstem-Toplan System',
        description: 'Korean implants with 30 years of clinical research. 98.5% success rate documented in longitudinal studies.',
        image: '../images/toplan.PNG'
    },
    {
        title: 'Tecom Premium',
        description: 'Nanostructured surface for rapid osseointegration. 4-week loading protocol for selected cases.',
        image: '../images/teecom.PNG'
    },
    // === TECNICHE AVANZATE ===
    {
        title: 'Zygomatic Implants',
        description: 'Solution for severe maxillary atrophy without bone grafts. Anchoring in the zygomatic bone for immediate rehabilitation.',
        image: '../images/zigomatic.PNG'
    },
    {
        title: 'Pterygoid Implants',
        description: 'Advanced technique for posterior maxillary atrophy. Anchoring in tuberosity and pterygoid process for fixed prosthetics.',
        image: '../images/pterigoideo.PNG'
    },
    // === CAROUSEL SAN MARCO ===
    {
        title: 'Surgical Team',
        description: 'Implantology team with over 15,000 implants placed. Continuous training at European universities.',
        image: '../images/landing.images.smarco/carousel-sanmarco-1.jpg'
    },
    {
        title: 'Guided Surgery',
        description: 'Digital planning with 3D printed surgical guides. Submillimetric precision for optimal implant placement.',
        image: '../images/landing.images.smarco/carousel-sanmarco-2.jpg'
    },
    {
        title: 'Conscious S√©dation',
        description: 'Assisted anesthesia for anxious patients. Continuous monitoring of vital parameters during the procedure.',
        image: '../images/landing.images.smarco/carousel-sanmarco-4.jpg'
    },
    {
        title: 'Before and After',
        description: 'Real results from our patients. Smile transformations with lifetime warranty on implants.',
        image: '../images/prima-dopo.jpg'
    }
];

// ========================================
// PRODUCT DATA FROM CRM
// ========================================
const productData = {
    impianti: {
        title: 'Dental Implants',
        icon: 'fas fa-tooth',
        products: [
            {
                brand: 'Premium Titanium',
                description: 'High quality titanium implant. 100% biocompatible, ideal for most cases.',
                price: 300,
                image: '../images/titanio.PNG'
            },
            {
                brand: 'Osstem-Toplan',
                description: 'World-renowned Korean implant system. Excellent osseointegration.',
                price: 350,
                image: '../images/toplan.PNG'
            },
            {
                brand: 'JD Evolution',
                description: 'Advanced technology for predictable results. Innovative design.',
                price: 350,
                image: '../images/jdevolution.PNG'
            },
            {
                brand: 'Tecom',
                description: 'Premium implant with treated surface. High primary stability.',
                price: 400,
                image: '../images/teecom.PNG'
            },
            {
                brand: 'Megagen',
                description: 'World leader in implants. AnyRidge technology for compromised bone.',
                price: 500,
                image: '../images/megagen.PNG'
            },
            {
                brand: 'Straumann',
                description: 'Premium Swiss implant. World leader with over 60 years of research. Lifetime warranty.',
                price: 350,
                image: '../images/strauman.JPG'
            },
            {
                brand: 'Straumann Variations',
                description: 'Complete range of Straumann implants. Various sizes and surfaces for every clinical need.',
                price: 350,
                priceMax: 500,
                image: '../images/strauman,variations.JPG'
            },
            {
                brand: 'Pterygoid',
                origin: 'Advanced Technique for Posterior Atrophy',
                description: 'Implant anchored in tuberosity and pterygoid process. Ideal for patients with little bone in the posterior maxillary area. Avoids complex bone grafts.',
                price: 350,
                priceMax: 600,
                image: '../images/impiant zigomatico.PNG'
            },
            {
                brand: 'Zygomatic',
                origin: 'Solution for Severe Maxillary Atrophy',
                description: 'Long implants (30-50mm) anchored in the zygomatic bone. Immediate rehabilitation without bone grafts for patients with severe maxillary bone loss.',
                price: 600,
                image: '../images/pterigoido.PNG'
            }
        ]
    },
    corone: {
        title: 'Dental Crowns',
        icon: 'fas fa-crown',
        products: [
            {
                brand: 'Composite Crown',
                origin: 'CE Certified Composite Resin',
                description: 'Reinforced composite resin crown. Economical solution ideal for long-term temporary crowns. Natural aesthetics with possibility of direct repair. Average duration 3-5 years.',
                price: 100,
                image: '../images/corona zircon.PNG'
            },
            {
                brand: 'Ceramic Crown',
                origin: 'Metal-Ceramic - Chrome-Cobalt Alloy',
                description: 'Crown with internal chrome-cobalt metal alloy structure covered with layered ceramic. Excellent value with high mechanical resistance. Ideal for posterior teeth. Duration 10-15 years.',
                price: 130,
                image: '../images/corona ceramic.PNG'
            },
            {
                brand: 'Zirconia Crown',
                origin: 'Layered Zirconia-Ceramic',
                description: 'Crown with high resistance (900-1200 MPa) zirconium oxide (ZrO2) core covered with aesthetic ceramic. 100% biocompatible, metal-free. Natural translucency for superior aesthetics. Duration 15-20 years.',
                price: 180,
                image: '../images/corona zircon.PNG'
            },
            {
                brand: 'Full Zirconia Multilayer Crown',
                origin: 'Multilayer Monolithic Zirconia',
                description: 'Fully zirconia crown with integrated multilayer color gradient. Maximum fracture resistance without ceramic chipping risk. Precision CAD/CAM technology. Perfect for bruxism patients. Duration over 20 years.',
                price: 200,
                image: '../images/corona1.PNG'
            },
            {
                brand: 'E-Max Crown',
                origin: 'IPS e.max - Ivoclar Vivadent (Liechtenstein)',
                description: 'Pressed or milled lithium disilicate (Li2Si2O5) crown. The gold standard for dental aesthetics with 400 MPa resistance. Identical translucency to natural teeth. Ideal for veneers and anterior crowns.',
                price: 300,
                image: '../images/corona.PNG'
            }
        ]
    },
    arcata: {
        title: 'Full Arch',
        icon: 'fas fa-teeth',
        products: [
            {
                brand: 'All-on-4 Grade 4 EV Titanium',
                origin: 'European CE Production - ISO 13485',
                description: 'All-on-4 protocol with 4 commercially pure Grade 4 EV titanium implants of European production. SLA surface (Sand-blasted Large-grit Acid-etched) for optimal osseointegration in 8-12 weeks. Includes 12 layered zirconia-ceramic crowns with high resistance core. Immediate loading in 24-48h with provisional prosthesis. 10-year warranty on implant body.',
                price: 2400,
                formula: '4x Titanium EV Implant (‚Ç¨300) + 12x Zirconia-Ceramic Crown (‚Ç¨100)',
                image: '../images/arcatacomplettt.PNG'
            },
            {
                brand: 'All-on-4 Megagen AnyRidge',
                origin: 'Megagen - Daegu, South Korea (since 2002)',
                description: 'Premium Megagen AnyRidge implant system with exclusive Knife-Thread design for maximum primary stability even in D3-D4 bone. Xpeed surface with incorporated calcium nanotubes for 50% accelerated osseointegration. 11.5¬∞ conometric anti-rotation connection. Includes 12 E-Max IPS lithium disilicate crowns (400 MPa). FDA, CE, KFDA certification. Megagen lifetime warranty.',
                price: 3800,
                formula: '4x Megagen AnyRidge (‚Ç¨500) + 12x E-Max IPS Crown (‚Ç¨150)',
                image: '../images/arcatacompleta.PNG'
            },
            {
                brand: 'All-on-5 Grade 4 EV Titanium',
                origin: 'European CE Production - ISO 13485',
                description: 'All-on-5 protocol with 5 Grade 4 EV titanium implants for optimal balance between stability and invasiveness. The fifth central implant reduces biomechanical stress by 25% compared to All-on-4. Ideal for arches with moderate resorption in the anterior area. Includes 12 multilayer zirconia-ceramic crowns. Immediate loading protocol available.',
                price: 2700,
                formula: '5x Titanium EV Implant (‚Ç¨300) + 12x Zirconia-Ceramic Crown (‚Ç¨100)',
                image: '../images/arcata completa 2.PNG'
            },
            {
                brand: 'All-on-5 Megagen AnyOne',
                origin: 'Megagen - Daegu, South Korea (since 2002)',
                description: 'Hybrid configuration with 5 Megagen AnyOne implants with internal conometric connection. Third generation S.L.A. design (Sandblasted with Large grit and Acid etched). The AnyOne system offers integrated switching platform for crestal bone preservation. Includes 12 full-contour monolithic zirconia crowns for posteriors and E-Max for anteriors. Zero bacterial microleakage guaranteed.',
                price: 4300,
                formula: '5x Megagen AnyOne (‚Ç¨500) + 12x Zirconia/E-Max Crown (‚Ç¨160)',
                image: '../images/arcata completa3.PNG'
            },
            {
                brand: 'All-on-6 Grade 4 EV Titanium',
                origin: 'European CE Production - ISO 13485',
                description: 'All-on-6 protocol with 6 Grade 4 EV titanium implants for uniform distribution of chewing load up to 150 kg. Indicated for patients with compromised bone density (D3-D4) or severe alveolar resorption. Configuration with 2 posterior implants angled 30-45¬∞ for bicortical anchorage. Includes 12 high translucency zirconia-ceramic crowns. Maximum prosthetic longevity.',
                price: 3000,
                formula: '6x Titanium EV Implant (‚Ç¨300) + 12x Zirconia-Ceramic Crown (‚Ç¨100)',
                image: '../images/arcatacompleta100.PNG'
            },
            {
                brand: 'All-on-6 Megagen AnyRidge Premium',
                origin: 'Megagen - Daegu, South Korea (since 2002)',
                description: 'Ultimate premium solution with 6 Megagen AnyRidge implants with progressive variable threading. Latest generation Xpeed surface with calcium ions for accelerated bone mineralization. Insertion torque up to 70 Ncm for immediate stability. Includes 12 E-Max Press monolithic lithium disilicate crowns (500 MPa) with individual characterization. FDA, CE, KFDA, TGA certification. The choice of implant surgeons.',
                price: 4800,
                formula: '6x Megagen AnyRidge (‚Ç¨500) + 12x E-Max Press Crown (‚Ç¨150)',
                image: '../images/arcatacompleta100.PNG'
            }
        ]
    }
};

// ========================================
// PRODUCT MODAL FUNCTIONALITY
// ========================================
const productModalOverlay = document.getElementById('product-modal-overlay');
const productCarousel = document.getElementById('product-carousel');
const carouselDots = document.getElementById('carousel-dots');
const productModalTitle = document.getElementById('product-modal-title');

function openProductModal(category) {
    const data = productData[category];
    if (!data) return;

    // Update modal title
    productModalTitle.innerHTML = `<i class="${data.icon}"></i><span>${data.title}</span>`;

    // Generate product cards
    let cardsHTML = '';
    data.products.forEach((product, index) => {
        const priceDisplay = product.priceMax
            ? `&euro;${product.price} - &euro;${product.priceMax}`
            : `&euro;${product.price.toLocaleString('it-IT')}`;

        const formulaHTML = product.formula
            ? `<div style="font-size: 0.7rem; color: var(--gray-500); margin-top: 4px;">${product.formula}</div>`
            : '';

        const originHTML = product.origin
            ? `<div class="product-card-origin"><i class="fas fa-globe-europe"></i> ${product.origin}</div>`
            : '';

        cardsHTML += `
            <div class="product-card" data-index="${index}">
                <img src="${product.image}" alt="${product.brand}" class="product-card-image" onerror="this.src='../images/instagram.images/ig_image_1_20251130.jpg'">
                <div class="product-card-content">
                    <div class="product-card-brand">${product.brand}</div>
                    ${originHTML}
                    <div class="product-card-desc">${product.description}</div>
                    <div class="product-card-price">${priceDisplay}${formulaHTML}</div>
                </div>
            </div>
        `;
    });
    productCarousel.innerHTML = cardsHTML;

    // Generate dots
    let dotsHTML = '';
    data.products.forEach((_, index) => {
        dotsHTML += `<div class="carousel-dot ${index === 0 ? 'active' : ''}" data-index="${index}"></div>`;
    });
    carouselDots.innerHTML = dotsHTML;

    // Show modal
    productModalOverlay.classList.add('active');
    document.body.style.overflow = 'hidden';

    // Track modal open
    if (typeof gtag === 'function') {
        gtag('event', 'product_modal_open', {
            'category': category,
            'title': data.title,
            'products_count': data.products.length
        });
    }
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        event: 'product_modal_open',
        category: category,
        title: data.title
    });
    console.log('‚úÖ Product modal tracked:', category, data.title);

    // Reset scroll position
    productCarousel.scrollLeft = 0;

    // Setup scroll observer for dots
    setupCarouselObserver();
}

function closeProductModal() {
    productModalOverlay.classList.remove('active');
    document.body.style.overflow = '';
    stopCarouselAutoScroll();
}

productModalOverlay.addEventListener('click', (e) => {
    if (e.target === productModalOverlay) {
        closeProductModal();
    }
});

let carouselAutoScrollInterval = null;
let currentCarouselIndex = 0;
let totalCarouselItems = 0;
let productScrollHandler = null;

function setupCarouselObserver() {
    const cards = productCarousel.querySelectorAll('.product-card');
    totalCarouselItems = cards.length;
    currentCarouselIndex = 0;

    // Remove old scroll listener if exists
    if (productScrollHandler) {
        productCarousel.removeEventListener('scroll', productScrollHandler);
    }

    // Scroll event - detect current position and update dots
    let scrollTimeout;
    productScrollHandler = () => {
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(() => {
            const scrollLeft = productCarousel.scrollLeft;
            const cardWidth = getProductCardWidth();
            const activeIndex = Math.round(scrollLeft / cardWidth);
            if (activeIndex !== currentCarouselIndex && activeIndex >= 0 && activeIndex < totalCarouselItems) {
                currentCarouselIndex = activeIndex;
                updateCarouselDots(activeIndex);
            }
        }, 100);
    };
    productCarousel.addEventListener('scroll', productScrollHandler);

    // Click on dots
    const dots = carouselDots.querySelectorAll('.carousel-dot');
    dots.forEach((dot, index) => {
        dot.onclick = () => {
            scrollToCarouselIndex(index);
            resetCarouselTimer();
        };
    });

    // Touch events for mobile
    productCarousel.ontouchstart = () => stopCarouselAutoScroll();
    productCarousel.ontouchend = () => resetCarouselTimer();

    // Start auto-scroll
    resetCarouselTimer();
}

function getProductCardWidth() {
    const card = productCarousel.querySelector('.product-card');
    if (card) {
        const style = window.getComputedStyle(productCarousel);
        const gap = parseInt(style.gap) || 12;
        return card.offsetWidth + gap;
    }
    return 300;
}

function stopCarouselAutoScroll() {
    if (carouselAutoScrollInterval) {
        clearInterval(carouselAutoScrollInterval);
        carouselAutoScrollInterval = null;
    }
}

function carouselPrev() {
    if (currentCarouselIndex > 0) {
        scrollToCarouselIndex(currentCarouselIndex - 1);
    } else {
        scrollToCarouselIndex(totalCarouselItems - 1);
    }
    resetCarouselTimer();
}

function carouselNext() {
    if (currentCarouselIndex < totalCarouselItems - 1) {
        scrollToCarouselIndex(currentCarouselIndex + 1);
    } else {
        scrollToCarouselIndex(0);
    }
    resetCarouselTimer();
}

function scrollToCarouselIndex(index) {
    const cardWidth = getProductCardWidth();
    productCarousel.scrollTo({
        left: index * cardWidth,
        behavior: 'smooth'
    });
    currentCarouselIndex = index;
    updateCarouselDots(index);
}

function updateCarouselDots(activeIndex) {
    const dots = carouselDots.querySelectorAll('.carousel-dot');
    dots.forEach((dot, i) => {
        dot.classList.toggle('active', i === activeIndex);
    });
}

function resetCarouselTimer() {
    stopCarouselAutoScroll();
    carouselAutoScrollInterval = setInterval(() => {
        carouselNext();
    }, 10000);
}

// ========================================
// CLINIC GALLERY MODAL
// ========================================
const clinicModalOverlay = document.getElementById('clinic-modal-overlay');
const clinicCarousel = document.getElementById('clinic-carousel');
const clinicCarouselDots = document.getElementById('clinic-carousel-dots');
let clinicAutoScrollInterval = null;
let currentClinicIndex = 0;
let clinicScrollHandler = null;
let clinicScrollTimeout = null;

function openClinicModal() {
    // Generate clinic gallery cards with bigger images
    let cardsHTML = '';
    clinicGalleryData.forEach((item, index) => {
        cardsHTML += `
            <div class="product-card clinic-gallery-card" data-index="${index}">
                <img src="${item.image}" alt="${item.title}" class="product-card-image clinic-gallery-image">
                <div class="product-card-content">
                    <div class="product-card-brand">${item.title}</div>
                    <div class="product-card-desc">${item.description}</div>
                </div>
            </div>
        `;
    });
    clinicCarousel.innerHTML = cardsHTML;

    // Generate dots
    let dotsHTML = '';
    clinicGalleryData.forEach((_, index) => {
        dotsHTML += `<div class="carousel-dot ${index === 0 ? 'active' : ''}" data-index="${index}"></div>`;
    });
    clinicCarouselDots.innerHTML = dotsHTML;

    // Setup dot click handlers
    const dots = clinicCarouselDots.querySelectorAll('.carousel-dot');
    dots.forEach((dot, index) => {
        dot.onclick = () => goToClinicSlide(index);
    });

    // Show modal
    clinicModalOverlay.classList.add('active');
    document.body.style.overflow = 'hidden';
    clinicCarousel.scrollLeft = 0;
    currentClinicIndex = 0;

    // Remove old scroll listener if exists
    if (clinicScrollHandler) {
        clinicCarousel.removeEventListener('scroll', clinicScrollHandler);
    }

    // Setup scroll observer with debounce
    clinicScrollHandler = () => {
        clearTimeout(clinicScrollTimeout);
        clinicScrollTimeout = setTimeout(() => {
            const scrollLeft = clinicCarousel.scrollLeft;
            const cardWidth = getClinicCardWidth();
            const activeIndex = Math.round(scrollLeft / cardWidth);
            if (activeIndex !== currentClinicIndex && activeIndex >= 0 && activeIndex < clinicGalleryData.length) {
                currentClinicIndex = activeIndex;
                updateClinicDotsActive(activeIndex);
            }
        }, 100);
    };
    clinicCarousel.addEventListener('scroll', clinicScrollHandler);

    // Touch events
    clinicCarousel.ontouchstart = () => stopClinicAutoScroll();
    clinicCarousel.ontouchend = () => resetClinicAutoScroll();

    // Start auto-scroll
    startClinicAutoScroll();
}

function closeClinicModal() {
    clinicModalOverlay.classList.remove('active');
    document.body.style.overflow = '';
    stopClinicAutoScroll();
}

clinicModalOverlay.addEventListener('click', (e) => {
    if (e.target === clinicModalOverlay) {
        closeClinicModal();
    }
});

function getClinicCardWidth() {
    const card = clinicCarousel.querySelector('.product-card');
    return card ? card.offsetWidth + 12 : 300;
}

function goToClinicSlide(index) {
    const cardWidth = getClinicCardWidth();
    clinicCarousel.scrollTo({
        left: index * cardWidth,
        behavior: 'smooth'
    });
    currentClinicIndex = index;
    updateClinicDotsActive(index);
    resetClinicAutoScroll();
}

function clinicCarouselPrev() {
    if (currentClinicIndex > 0) {
        goToClinicSlide(currentClinicIndex - 1);
    } else {
        goToClinicSlide(clinicGalleryData.length - 1);
    }
}

function clinicCarouselNext() {
    if (currentClinicIndex < clinicGalleryData.length - 1) {
        goToClinicSlide(currentClinicIndex + 1);
    } else {
        goToClinicSlide(0);
    }
}

function updateClinicDotsActive(activeIndex) {
    const dots = clinicCarouselDots.querySelectorAll('.carousel-dot');
    dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === activeIndex);
    });
}

function startClinicAutoScroll() {
    stopClinicAutoScroll();
    clinicAutoScrollInterval = setInterval(() => {
        clinicCarouselNext();
    }, 10000);
}

function stopClinicAutoScroll() {
    if (clinicAutoScrollInterval) {
        clearInterval(clinicAutoScrollInterval);
        clinicAutoScrollInterval = null;
    }
}

function resetClinicAutoScroll() {
    startClinicAutoScroll();
}

// ========================================
// FORM POPUP FUNCTIONALITY
// ========================================
const popupOverlay = document.getElementById('popup-overlay');
const openButtons = document.querySelectorAll('.open-popup-btn');

openButtons.forEach(btn => {
    btn.addEventListener('click', () => {
        popupOverlay.classList.add('active');
        document.body.style.overflow = 'hidden';
        // Track popup open
        trackPopupOpen();
    });
});

function closePopup() {
    popupOverlay.classList.remove('active');
    document.body.style.overflow = '';
    // Track popup close
    if (typeof gtag === 'function') {
        gtag('event', 'popup_close', { popup_name: 'preventivo_form' });
        console.log('üìä Popup close tracked');
    }
}

function openPopup() {
    popupOverlay.classList.add('active');
    document.body.style.overflow = 'hidden';
    // Track popup open
    trackPopupOpen();
}

function trackPopupOpen() {
    // GA4 Event
    if (typeof gtag === 'function') {
        gtag('event', 'popup_open', {
            popup_name: 'preventivo_form',
            page_location: window.location.href
        });
        console.log('‚úÖ GA4 popup_open event fired');
    }

    // Meta Pixel ViewContent
    if (typeof fbq === 'function') {
        fbq('track', 'ViewContent', {
            content_name: 'Quote Form',
            content_category: 'Form Popup'
        });
        console.log('‚úÖ Meta ViewContent event fired');
    }

    // DataLayer push
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        event: 'popup_open',
        popup_name: 'preventivo_form'
    });
    console.log('üìä Popup open tracked');
}

popupOverlay.addEventListener('click', (e) => {
    if (e.target === popupOverlay) {
        closePopup();
    }
});

// Toggle extra fields functionality
document.getElementById('toggleExtra')?.addEventListener('click', function() {
    const extraFields = document.getElementById('extraFields');
    const chevronIcon = document.getElementById('chevronIcon');
    if (extraFields.style.display === 'none') {
        extraFields.style.display = 'block';
        chevronIcon.classList.remove('fa-chevron-down');
        chevronIcon.classList.add('fa-chevron-up');
    } else {
        extraFields.style.display = 'none';
        chevronIcon.classList.remove('fa-chevron-up');
        chevronIcon.classList.add('fa-chevron-down');
    }
});

// Form submission with Tracking
document.getElementById('lead-form').addEventListener('submit', async function(e) {
    e.preventDefault();

    const form = this;
    const submitBtn = form.querySelector('button[type="submit"]');

    // Disable button during submission
    if (submitBtn) {
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Invio in corso...';
    }

    // Get form data - using first_name, last_name, city fields
    const formData = {
        first_name: document.getElementById('first_name').value,
        last_name: document.getElementById('last_name').value,
        city: document.getElementById('city').value,
        phone: document.getElementById('phone').value,
        email: document.getElementById('email')?.value || '',
        treatment: document.getElementById('treatment')?.value || '',
        message: document.getElementById('message')?.value || '',
        source: document.getElementById('source')?.value || 'landing-page-mobile',
        utm_source: document.getElementById('utm_source')?.value || '',
        utm_medium: document.getElementById('utm_medium')?.value || '',
        utm_campaign: document.getElementById('utm_campaign')?.value || '',
        gclid: document.getElementById('gclid')?.value || '',
        timestamp: new Date().toISOString()
    };

    // 1. Fire Google Ads Conversion with Enhanced Conversions
    if (typeof gtag === 'function') {
        // Set Enhanced Conversion user data (hashed)
        const enhancedConversionData = {
            'email': formData.email ? formData.email.toLowerCase().trim() : '',
            'phone_number': formData.phone ? formData.phone.replace(/[^0-9+]/g, '') : '',
            'address': {
                'first_name': formData.first_name ? formData.first_name.toLowerCase().trim() : '',
                'last_name': formData.last_name ? formData.last_name.toLowerCase().trim() : '',
                'city': formData.city ? formData.city.toLowerCase().trim() : '',
                'country': 'IT'
            }
        };

        // Set user_data for enhanced conversions (Google handles hashing)
        gtag('set', 'user_data', enhancedConversionData);
        console.log('‚úÖ Enhanced conversion user_data set:', enhancedConversionData);

        // Enhanced conversion user_data is set - Google Ads will receive via GA4 import
        console.log('‚úÖ Enhanced conversion user_data set for GA4 -> Google Ads');
    }

    // 2. Fire GA4 generate_lead Event (Google's standard lead funnel event)
    // This event will be imported into Google Ads as a conversion
    if (typeof gtag === 'function') {
        // Get tracking params for attribution
        const trackingParams = JSON.parse(sessionStorage.getItem('trackingParams') || '{}');

        // Determine traffic source
        let trafficSource = 'direct';
        let trafficMedium = 'none';
        let trafficCampaign = '(not set)';

        if (trackingParams.gclid || formData.gclid) {
            trafficSource = 'google';
            trafficMedium = 'cpc';
            trafficCampaign = trackingParams.utm_campaign || 'google_ads';
        } else if (trackingParams.fbclid || formData.fbclid) {
            trafficSource = 'facebook';
            trafficMedium = 'paid';
            trafficCampaign = trackingParams.utm_campaign || 'meta_ads';
        } else if (trackingParams.utm_source) {
            trafficSource = trackingParams.utm_source;
            trafficMedium = trackingParams.utm_medium || 'referral';
            trafficCampaign = trackingParams.utm_campaign || '(not set)';
        }

        gtag('event', 'generate_lead', {
            'form_name': 'preventivo_form',
            'form_source': 'landing_page',
            'treatment_type': formData.treatment,
            // ATTRIBUTION DATA
            'traffic_source': trafficSource,
            'traffic_medium': trafficMedium,
            'traffic_campaign': trafficCampaign,
            'utm_source': trackingParams.utm_source || '',
            'utm_medium': trackingParams.utm_medium || '',
            'utm_campaign': trackingParams.utm_campaign || '',
            'gclid': trackingParams.gclid || '',
            'fbclid': trackingParams.fbclid || '',
            'value': 1,
            'currency': 'EUR'
        });
        console.log('‚úÖ GA4 generate_lead fired with attribution:', trafficSource, trafficMedium, trafficCampaign);
    }

    // 3. Fire Meta Pixel Event (when configured)
    if (typeof fbq === 'function') {
        fbq('track', 'Lead', {
            content_name: 'Quote Dentale',
            content_category: 'Dental Tourism'
        });
        console.log('‚úÖ Meta Lead event fired');
    }

    // 4. Push to dataLayer
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        event: 'generate_lead',
        formData: formData
    });

    // 5. Get tracking params for CRM
    const trackingParams = JSON.parse(sessionStorage.getItem('trackingParams') || '{}');

    // 6. Build platform string for attribution
    let platform = 'albaniandentalclinic.com';
    if (formData.source && formData.source !== 'landing-page-mobile') {
        platform = `albaniandentalclinic.com/${formData.source}`;
    } else if (trackingParams.utm_source) {
        platform = `albaniandentalclinic.com/${trackingParams.utm_source}`;
    }

    // 7. Use first_name and last_name directly (no parsing needed)
    const firstName = formData.first_name;
    const lastName = formData.last_name;

    // 8. Send to KoLor CRM
    const leadData = {
        api_key: '6fcfcf06-ba40-4d00-857e-2e684ebc09fc',
        campaign_type: 'fissa',
        platform: platform,
        leads: [{
            nome: firstName,
            cognome: lastName,
            city: formData.city,
            phone: formData.phone,
            email: formData.email || ''
        }]
    };

    try {
        const response = await fetch('https://crm.clinicadentalealbania.it/api/v1/leads/import', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-API-Key': '6fcfcf06-ba40-4d00-857e-2e684ebc09fc'
            },
            body: JSON.stringify(leadData)
        });

        const result = await response.json();

        if (response.ok && result.success) {
            console.log('‚úÖ Lead sent to CRM:', result);
            closePopup();
            form.reset();
            showSuccessModal();
        } else {
            throw new Error(result.message || 'CRM error');
        }
    } catch (error) {
        console.error('‚ùå Error sending to CRM:', error);
        // Still show success to user (tracking already fired)
        closePopup();
        form.reset();
        showSuccessModal();
    } finally {
        // Re-enable button
        if (submitBtn) {
            submitBtn.disabled = false;
            submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Request Free Quote';
        }
    }
});

// ========================================
// SUCCESS MODAL FUNCTIONS
// ========================================
function showSuccessModal() {
    const successModal = document.getElementById('success-modal');
    if (successModal) {
        successModal.classList.add('active');
        document.body.style.overflow = 'hidden';
        console.log('üéâ Success modal shown');
    }
}

function closeSuccessModal() {
    const successModal = document.getElementById('success-modal');
    if (successModal) {
        successModal.classList.remove('active');
        document.body.style.overflow = '';
    }
}

// Close success modal on overlay click
document.getElementById('success-modal')?.addEventListener('click', function(e) {
    if (e.target === this) {
        closeSuccessModal();
    }
});

// ========================================
// MOBILE MENU FUNCTIONALITY
// ========================================
const mobileMenu = document.querySelector('.mobile-menu');
const mobileMenuOverlay = document.querySelector('.mobile-menu-overlay');
const navbarToggle = document.querySelector('.navbar-toggle');

function toggleMobileMenu() {
    mobileMenu.classList.toggle('active');
    mobileMenuOverlay.classList.toggle('active');
    navbarToggle.classList.toggle('active');
    document.body.style.overflow = mobileMenu.classList.contains('active') ? 'hidden' : '';
}

function closeMobileMenu() {
    mobileMenu.classList.remove('active');
    mobileMenuOverlay.classList.remove('active');
    navbarToggle.classList.remove('active');
    document.body.style.overflow = '';
}

// Close mobile menu on window resize (if going to desktop)
window.addEventListener('resize', () => {
    if (window.innerWidth >= 992) {
        closeMobileMenu();
    }
});

// ========================================
// DESKTOP DROPDOWN (Click-only)
// ========================================
document.querySelectorAll('.navbar-dropdown > a').forEach(function(dropdownToggle) {
    dropdownToggle.addEventListener('click', function(e) {
        e.preventDefault();
        const parent = this.parentElement;

        // Close other open dropdowns
        document.querySelectorAll('.navbar-dropdown.open').forEach(function(openDropdown) {
            if (openDropdown !== parent) {
                openDropdown.classList.remove('open');
            }
        });

        // Toggle current dropdown
        parent.classList.toggle('open');
    });
});

// Close dropdown when clicking outside
document.addEventListener('click', function(e) {
    if (!e.target.closest('.navbar-dropdown')) {
        document.querySelectorAll('.navbar-dropdown.open').forEach(function(dropdown) {
            dropdown.classList.remove('open');
        });
    }
});

// Close dropdown when clicking a menu item
document.querySelectorAll('.dropdown-menu a').forEach(function(item) {
    item.addEventListener('click', function() {
        document.querySelectorAll('.navbar-dropdown.open').forEach(function(dropdown) {
            dropdown.classList.remove('open');
        });
    });
});

// ========================================
// ANALYTICS
// ========================================
let maxScroll = 0;
window.addEventListener('scroll', () => {
    const scrollPercent = Math.round((window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100);
    if (scrollPercent > maxScroll) {
        maxScroll = scrollPercent;
    }
});
</script>

<!-- UTM & GCLID Capture Script - Enhanced for Attribution -->
<script>
(function() {
    const params = new URLSearchParams(window.location.search);
    const trackingData = {
        utm_source: params.get('utm_source'),
        utm_medium: params.get('utm_medium'),
        utm_campaign: params.get('utm_campaign'),
        utm_term: params.get('utm_term'),
        utm_content: params.get('utm_content'),
        gclid: params.get('gclid'),
        fbclid: params.get('fbclid'),
        source: params.get('source'),
        landing_page: window.location.pathname,
        landing_time: new Date().toISOString()
    };

    // Check if we have new tracking params from URL
    const hasNewParams = trackingData.utm_source || trackingData.gclid || trackingData.fbclid;

    if (hasNewParams) {
        // New params from URL - save them
        sessionStorage.setItem('trackingParams', JSON.stringify(trackingData));
        console.log('‚úÖ NEW UTM params captured:', trackingData);
    } else {
        // No new params - check if we have existing ones to preserve
        const existing = sessionStorage.getItem('trackingParams');
        if (!existing) {
            // No existing params either - mark as direct traffic
            trackingData.utm_source = 'direct';
            trackingData.utm_medium = 'none';
            sessionStorage.setItem('trackingParams', JSON.stringify(trackingData));
            console.log('‚ÑπÔ∏è Direct traffic - no UTM params');
        } else {
            console.log('‚úÖ Preserved existing UTM params:', JSON.parse(existing));
        }
    }

    // Set hidden form fields after short delay (DOM ready)
    setTimeout(() => {
        const stored = JSON.parse(sessionStorage.getItem('trackingParams') || '{}');
        ['utm_source', 'utm_medium', 'utm_campaign', 'utm_term', 'utm_content', 'gclid', 'fbclid'].forEach(key => {
            const field = document.getElementById(key);
            if (field && stored[key]) field.value = stored[key];
        });
    }, 100);

    // ========================================
    // AUTO-OPEN MODALS FROM GOOGLE ADS URLS
    // ========================================
    // Usage: ?open=preventivo, ?open=booking, ?open=contact, ?open=flight
    const openParam = params.get('open');
    if (openParam) {
        setTimeout(() => {
            switch(openParam) {
                case 'preventivo':
                    // Auto-open Quote Simulator
                    if (typeof openQuoteSimulator === 'function') {
                        openQuoteSimulator();
                        console.log('üéØ Auto-opened Quote Simulator from Google Ads');
                    }
                    break;
                case 'booking':
                    // Auto-open Booking Modal
                    if (typeof openBookingModal === 'function') {
                        openBookingModal();
                        console.log('üéØ Auto-opened Booking Modal from Google Ads');
                    }
                    break;
                case 'contact':
                    // Auto-open Contact/Lead Form
                    if (typeof openPopup === 'function') {
                        openPopup();
                        console.log('üéØ Auto-opened Contact Form from Google Ads');
                    }
                    break;
                case 'flight':
                    // Auto-open Flight Search
                    if (typeof openFlightSearch === 'function') {
                        openFlightSearch();
                        console.log('üéØ Auto-opened Flight Search from Google Ads');
                    }
                    break;
                case 'tirana':
                    // Auto-open Tirana Experience
                    if (typeof openTiranaModal === 'function') {
                        openTiranaModal();
                        console.log('üéØ Auto-opened Tirana Experience from Google Ads');
                    }
                    break;
            }
        }, 800); // Delay to ensure page fully loaded
    }
})();

// Phone Click Tracking - GA4 event only (import to Google Ads from GA4)
function trackPhoneClick() {
    if (typeof gtag === 'function') {
        gtag('event', 'click_phone', {
            'event_category': 'Contact',
            'event_label': 'Phone Click',
            'phone_number': '+37254450188',
            'value': 0.5,
            'currency': 'EUR'
        });
        console.log('‚úÖ GA4 click_phone tracked');
    }
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({ event: 'click_phone' });
}

// WhatsApp Click Tracking - GA4 event only (import to Google Ads from GA4)
function trackWhatsAppClick() {
    if (typeof gtag === 'function') {
        gtag('event', 'click_whatsapp', {
            'event_category': 'Contact',
            'event_label': 'WhatsApp Click',
            'phone_number': '+37254450188',
            'value': 0.5,
            'currency': 'EUR'
        });
        console.log('‚úÖ GA4 click_whatsapp tracked');
    }
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({ event: 'click_whatsapp' });
}

// ============================================
// LIVE CHAT WIDGET FUNCTIONS
// ============================================

function toggleChatWindow() {
    const chatWindow = document.getElementById('chatWindow');
    const notificationDot = document.querySelector('.notification-dot');

    if (chatWindow) {
        chatWindow.classList.toggle('active');

        // Hide notification dot when chat is opened
        if (chatWindow.classList.contains('active') && notificationDot) {
            notificationDot.style.display = 'none';
        }

        // Track chat open event
        if (chatWindow.classList.contains('active')) {
            if (typeof gtag === 'function') {
                gtag('event', 'chat_open', {
                    'chat_type': 'live_chat'
                });
            }
            console.log('‚úÖ Chat window opened');
        }
    }
}

function handleChatKeyPress(event) {
    if (event.key === 'Enter') {
        sendChatMessage();
    }
}

function sendChatMessage() {
    const chatInput = document.getElementById('chatInput');
    const chatMessages = document.getElementById('chatMessages');
    const message = chatInput.value.trim();

    if (!message) return;

    // Add user message to chat
    const userMessageHTML = `
        <div class="chat-message user">
            <div class="message-bubble">${escapeHtml(message)}</div>
        </div>
    `;
    chatMessages.innerHTML += userMessageHTML;

    // Clear input
    chatInput.value = '';

    // Scroll to bottom
    chatMessages.scrollTop = chatMessages.scrollHeight;

    // Track chat message sent
    trackWhatsAppClick();

    // Show sending indicator
    const sendingHTML = `
        <div class="chat-message bot" id="sendingIndicator">
            <div class="message-avatar"><i class="fas fa-tooth"></i></div>
            <div class="message-bubble">
                <i class="fas fa-spinner fa-spin"></i> Invio messaggio...
            </div>
        </div>
    `;
    chatMessages.innerHTML += sendingHTML;
    chatMessages.scrollTop = chatMessages.scrollHeight;

    // After a short delay, show confirmation and open WhatsApp
    setTimeout(() => {
        // Remove sending indicator
        const indicator = document.getElementById('sendingIndicator');
        if (indicator) indicator.remove();

        // Add confirmation message
        const confirmHTML = `
            <div class="chat-message bot">
                <div class="message-avatar"><i class="fas fa-tooth"></i></div>
                <div class="message-bubble">
                    Merci pour votre message ! Redirection vers WhatsApp pour une r√©ponse imm√©diate. üì±
                </div>
            </div>
        `;
        chatMessages.innerHTML += confirmHTML;
        chatMessages.scrollTop = chatMessages.scrollHeight;

        // Open WhatsApp with the message
        const whatsappMessage = encodeURIComponent(message);
        const whatsappURL = 'https://wa.me/37254450188?text=' + whatsappMessage;

        setTimeout(() => {
            window.open(whatsappURL, '_blank');
        }, 800);

    }, 1000);
}

function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// ============================================
// COMPREHENSIVE UX & NAVIGATION TRACKING
// ============================================

// Track Navigation Clicks
function trackNavClick(menuItem, menuType) {
    if (typeof gtag === 'function') {
        gtag('event', 'nav_click', {
            'menu_item': menuItem,
            'menu_type': menuType, // 'desktop', 'mobile', 'trust_bar'
            'page_location': window.location.href
        });
    }
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        event: 'nav_click',
        menu_item: menuItem,
        menu_type: menuType
    });
    console.log('‚úÖ Nav click tracked:', menuItem, '(' + menuType + ')');
}

// Track CTA Button Clicks
function trackCTAClick(ctaName, ctaLocation) {
    if (typeof gtag === 'function') {
        gtag('event', 'cta_click', {
            'cta_name': ctaName,
            'cta_location': ctaLocation
        });
    }
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        event: 'cta_click',
        cta_name: ctaName,
        cta_location: ctaLocation
    });
    console.log('‚úÖ CTA click tracked:', ctaName, '(' + ctaLocation + ')');
}

// Track Scroll Depth
(function() {
    let scrollMarks = [25, 50, 75, 90, 100];
    let scrollTracked = {};

    window.addEventListener('scroll', function() {
        let scrollPercent = Math.round((window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100);

        scrollMarks.forEach(function(mark) {
            if (scrollPercent >= mark && !scrollTracked[mark]) {
                scrollTracked[mark] = true;
                if (typeof gtag === 'function') {
                    gtag('event', 'scroll_depth', {
                        'percent_scrolled': mark
                    });
                }
                window.dataLayer = window.dataLayer || [];
                window.dataLayer.push({
                    event: 'scroll_depth',
                    percent_scrolled: mark
                });
                console.log('‚úÖ Scroll depth tracked:', mark + '%');
            }
        });
    });
})();

// Track Section Views (when user sees a section)
(function() {
    const sections = [
        { id: 'pricing', name: 'Prezzi' },
        { id: 'come-funziona', name: 'How It Works' },
        { id: 'reviews', name: 'Testimonials' },
        { id: 'faq', name: 'FAQ' },
        { id: 'contact', name: 'Contatti' }
    ];

    const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.3 // 30% visible
    };

    const sectionObserver = new IntersectionObserver(function(entries) {
        entries.forEach(function(entry) {
            if (entry.isIntersecting) {
                const sectionId = entry.target.id;
                const sectionName = sections.find(s => s.id === sectionId)?.name || sectionId;

                if (typeof gtag === 'function') {
                    gtag('event', 'section_view', {
                        'section_id': sectionId,
                        'section_name': sectionName
                    });
                }
                window.dataLayer = window.dataLayer || [];
                window.dataLayer.push({
                    event: 'section_view',
                    section_id: sectionId,
                    section_name: sectionName
                });
                console.log('‚úÖ Section view tracked:', sectionName);

                // Unobserve after first view
                sectionObserver.unobserve(entry.target);
            }
        });
    }, observerOptions);

    // Observe sections when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
        sections.forEach(function(section) {
            const el = document.getElementById(section.id);
            if (el) sectionObserver.observe(el);
        });
    });
})();

// Track Time on Page
(function() {
    let startTime = Date.now();
    let timeMarks = [30, 60, 120, 180, 300]; // seconds
    let timeTracked = {};

    setInterval(function() {
        let timeOnPage = Math.floor((Date.now() - startTime) / 1000);

        timeMarks.forEach(function(mark) {
            if (timeOnPage >= mark && !timeTracked[mark]) {
                timeTracked[mark] = true;
                if (typeof gtag === 'function') {
                    gtag('event', 'time_on_page', {
                        'seconds': mark
                    });
                }
                console.log('‚úÖ Time on page tracked:', mark + 's');
            }
        });
    }, 5000); // Check every 5 seconds
})();

// Track Device & Browser Info
(function() {
    const deviceInfo = {
        // Screen
        screen_width: window.screen.width,
        screen_height: window.screen.height,
        viewport_width: window.innerWidth,
        viewport_height: window.innerHeight,
        pixel_ratio: window.devicePixelRatio,

        // Device Type
        device_type: /Mobile|Android|iPhone|iPad/.test(navigator.userAgent) ? 'mobile' : 'desktop',
        is_touch: 'ontouchstart' in window,

        // Browser
        browser: (function() {
            const ua = navigator.userAgent;
            if (ua.includes('Chrome') && !ua.includes('Edg')) return 'Chrome';
            if (ua.includes('Safari') && !ua.includes('Chrome')) return 'Safari';
            if (ua.includes('Firefox')) return 'Firefox';
            if (ua.includes('Edg')) return 'Edge';
            if (ua.includes('Opera') || ua.includes('OPR')) return 'Opera';
            return 'Other';
        })(),

        // OS
        os: (function() {
            const ua = navigator.userAgent;
            if (ua.includes('Windows')) return 'Windows';
            if (ua.includes('Mac')) return 'MacOS';
            if (ua.includes('Linux')) return 'Linux';
            if (ua.includes('Android')) return 'Android';
            if (ua.includes('iOS') || ua.includes('iPhone') || ua.includes('iPad')) return 'iOS';
            return 'Other';
        })(),

        // Language
        language: navigator.language,

        // Connection
        connection_type: navigator.connection ? navigator.connection.effectiveType : 'unknown',

        // Referrer
        referrer: document.referrer || 'direct',

        // Time
        local_time: new Date().toLocaleTimeString(),
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
        day_of_week: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'][new Date().getDay()]
    };

    // Send to GA4
    if (typeof gtag === 'function') {
        gtag('event', 'user_info', deviceInfo);
    }

    // Push to dataLayer
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        event: 'user_info',
        ...deviceInfo
    });

    console.log('‚úÖ Device info tracked:', deviceInfo);

    // Store for later use
    sessionStorage.setItem('deviceInfo', JSON.stringify(deviceInfo));
})();

// Track Engagement (clicks, hovers, focus)
(function() {
    let totalClicks = 0;
    let totalScrolls = 0;
    let engagementScore = 0;

    // Track all clicks
    document.addEventListener('click', function(e) {
        totalClicks++;
        engagementScore += 1;

        const target = e.target;
        const clickData = {
            element_tag: target.tagName,
            element_class: target.className.split(' ')[0] || 'none',
            element_id: target.id || 'none',
            element_text: target.textContent?.substring(0, 50) || 'none',
            click_x: e.clientX,
            click_y: e.clientY,
            total_clicks: totalClicks
        };

        if (typeof gtag === 'function') {
            gtag('event', 'element_click', clickData);
        }
    });

    // Track scroll behavior
    let lastScrollTop = 0;
    let scrollDirection = 'none';

    window.addEventListener('scroll', function() {
        totalScrolls++;
        const st = window.scrollY;
        scrollDirection = st > lastScrollTop ? 'down' : 'up';
        lastScrollTop = st;
    });

    // Send engagement summary on page leave
    window.addEventListener('beforeunload', function() {
        const engagementData = {
            total_clicks: totalClicks,
            total_scrolls: totalScrolls,
            engagement_score: engagementScore,
            time_on_page: Math.floor((Date.now() - performance.timing.navigationStart) / 1000)
        };

        // Use sendBeacon for reliability
        if (navigator.sendBeacon && typeof gtag === 'function') {
            gtag('event', 'engagement_summary', engagementData);
        }
    });
})();

// Track Visibility (tab switches)
(function() {
    let hiddenTime = 0;
    let lastHiddenAt = null;

    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            lastHiddenAt = Date.now();
            if (typeof gtag === 'function') {
                gtag('event', 'tab_hidden');
            }
        } else {
            if (lastHiddenAt) {
                hiddenTime += Date.now() - lastHiddenAt;
            }
            if (typeof gtag === 'function') {
                gtag('event', 'tab_visible', {
                    hidden_duration: lastHiddenAt ? Math.floor((Date.now() - lastHiddenAt) / 1000) : 0
                });
            }
        }
    });
})();

// Auto-attach tracking to navigation links
document.addEventListener('DOMContentLoaded', function() {
    // Desktop menu links
    document.querySelectorAll('.navbar-menu a').forEach(function(link) {
        link.addEventListener('click', function() {
            trackNavClick(this.textContent.trim(), 'desktop');
        });
    });

    // Mobile menu links
    document.querySelectorAll('.mobile-menu-nav a').forEach(function(link) {
        link.addEventListener('click', function() {
            trackNavClick(this.textContent.trim(), 'mobile');
        });
    });

    // Trust bar links
    document.querySelectorAll('.trust-bar-item').forEach(function(link) {
        link.addEventListener('click', function() {
            trackNavClick(this.textContent.trim(), 'trust_bar');
        });
    });

    // CTA buttons
    document.querySelectorAll('.navbar-cta, .open-popup-btn, .cf-cta-btn').forEach(function(btn) {
        btn.addEventListener('click', function() {
            trackCTAClick(this.textContent.trim(), this.closest('section')?.id || 'header');
        });
    });

    // Social media links
    document.querySelectorAll('.footer-social-icons a, .footer-social a, a[href*="instagram"], a[href*="facebook"], a[href*="youtube"]').forEach(function(link) {
        link.addEventListener('click', function() {
            let platform = 'unknown';
            const href = this.href || '';
            if (href.includes('instagram')) platform = 'instagram';
            else if (href.includes('facebook')) platform = 'facebook';
            else if (href.includes('youtube')) platform = 'youtube';
            else if (href.includes('tiktok')) platform = 'tiktok';
            else if (href.includes('linkedin')) platform = 'linkedin';

            if (typeof gtag === 'function') {
                gtag('event', 'social_click', {
                    'platform': platform,
                    'link_url': href
                });
            }
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
                event: 'social_click',
                platform: platform,
                link_url: href
            });
            console.log('‚úÖ Social click tracked:', platform);
        });
    });

    // External links
    document.querySelectorAll('a[target="_blank"]').forEach(function(link) {
        link.addEventListener('click', function() {
            if (typeof gtag === 'function') {
                gtag('event', 'outbound_click', {
                    'link_url': this.href,
                    'link_text': this.textContent.trim().substring(0, 50)
                });
            }
            console.log('‚úÖ Outbound click tracked:', this.href);
        });
    });

    // Footer links (treatments, info)
    document.querySelectorAll('footer a, .footer a, .footer-links a').forEach(function(link) {
        link.addEventListener('click', function(e) {
            const linkText = this.textContent.trim();
            const linkHref = this.getAttribute('href') || '';

            if (typeof gtag === 'function') {
                gtag('event', 'footer_click', {
                    'link_text': linkText,
                    'link_href': linkHref,
                    'link_type': linkHref.startsWith('#') ? 'internal' : 'external'
                });
            }
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
                event: 'footer_click',
                link_text: linkText,
                link_href: linkHref
            });
            console.log('‚úÖ Footer click tracked:', linkText);
        });
    });

    // Treatment/service links in footer
    document.querySelectorAll('[onclick*="openProductModal"]').forEach(function(link) {
        // Already tracked via openProductModal function
    });

    // Google Reviews link
    document.querySelectorAll('a[href*="google"], a[href*="maps"]').forEach(function(link) {
        link.addEventListener('click', function() {
            if (typeof gtag === 'function') {
                gtag('event', 'google_reviews_click', {
                    'link_url': this.href
                });
            }
            console.log('‚úÖ Google Reviews click tracked');
        });
    });

    // Video plays
    document.querySelectorAll('video').forEach(function(video) {
        video.addEventListener('play', function() {
            if (typeof gtag === 'function') {
                gtag('event', 'video_play', {
                    'video_src': this.currentSrc,
                    'video_duration': this.duration
                });
            }
            console.log('‚úÖ Video play tracked');
        });
        video.addEventListener('ended', function() {
            if (typeof gtag === 'function') {
                gtag('event', 'video_complete', {
                    'video_src': this.currentSrc
                });
            }
            console.log('‚úÖ Video complete tracked');
        });
    });

    console.log('‚úÖ UX tracking initialized');
});
</script>

<!-- ========================================
     PREVENTIVO SIMULATOR MODAL
======================================== -->
<div id="preventivo-simulator-overlay" class="preventivo-simulator-overlay">
    <div class="preventivo-simulator-modal">
        <button class="simulator-close-btn" onclick="closeQuoteSimulator()">
            <i class="fas fa-times"></i>
        </button>

        <div class="simulator-header">
            <div class="simulator-logo" style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                <span style="font-size: 1.8rem; font-weight: 800; letter-spacing: 2px;">
                    <span style="color: #1a365d;">A</span><span style="color: #8b0000;">D</span><span style="color: #d69e2e;">C</span>
                </span>
            </div>
            <h2><i class="fas fa-calculator"></i> Cost Calculator</h2>
            <p class="simulator-subtitle">Calculate an estimate of costs for your dental treatment</p>
        </div>

        <!-- Clinic Display -->
        <div class="simulator-clinic-display">
            <div class="clinic-badge">
                <i class="fas fa-hospital"></i>
                <span>Albanian Dental Clinic</span>
                <i class="fas fa-check-circle" style="color: #22c55e; margin-left: 8px;"></i>
            </div>
        </div>

        <!-- Sessions Container -->
        <div class="simulator-sessions">
            <!-- First Session -->
            <div class="simulator-session" id="prima-seduta">
                <div class="session-header">
                    <h3><i class="fas fa-calendar-day"></i> First Session</h3>
                    <span class="session-total" id="prima-seduta-total">‚Ç¨0.00</span>
                </div>

                <!-- Product Search -->
                <div class="product-search-container">
                    <div class="search-input-wrapper">
                        <i class="fas fa-search"></i>
                        <input type="text"
                               id="search-prima"
                               class="product-search-input"
                               placeholder="Search service (e.g., implant, crown, cleaning...)"
                               oninput="handleSearch('prima', this.value)"
                               onfocus="showDropdown('prima')"
                               autocomplete="off">
                        <button class="search-clear" onclick="clearSearch('prima')" style="display:none">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="search-dropdown" id="dropdown-prima"></div>
                </div>

                <!-- Line Items -->
                <div class="session-items" id="items-prima"></div>
            </div>

            <!-- Second Session -->
            <div class="simulator-session" id="seconda-seduta">
                <div class="session-header">
                    <h3><i class="fas fa-calendar-check"></i> Second Session</h3>
                    <span class="session-total" id="seconda-seduta-total">‚Ç¨0.00</span>
                </div>

                <!-- Product Search -->
                <div class="product-search-container">
                    <div class="search-input-wrapper">
                        <i class="fas fa-search"></i>
                        <input type="text"
                               id="search-seconda"
                               class="product-search-input"
                               placeholder="Search service (e.g., implant, crown, cleaning...)"
                               oninput="handleSearch('seconda', this.value)"
                               onfocus="showDropdown('seconda')"
                               autocomplete="off">
                        <button class="search-clear" onclick="clearSearch('seconda')" style="display:none">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="search-dropdown" id="dropdown-seconda"></div>
                </div>

                <!-- Line Items -->
                <div class="session-items" id="items-seconda"></div>
            </div>
        </div>

        <!-- Grand Total -->
        <div class="simulator-grand-total">
            <div class="grand-total-row">
                <span class="grand-total-label">Estimated Total:</span>
                <span class="grand-total-value" id="grand-total">‚Ç¨0.00</span>
            </div>
        </div>

        <!-- Actions -->
        <div class="simulator-actions">
            <button class="simulator-btn-secondary" onclick="resetSimulator()">
                <i class="fas fa-redo"></i> Reset
            </button>
            <button class="simulator-btn-primary" onclick="generatePDF()">
                <i class="fas fa-file-pdf"></i> Generate PDF
            </button>
        </div>

        <!-- Disclaimer -->
        <div class="simulator-disclaimer">
            <i class="fas fa-info-circle"></i>
            <p>
                <strong>Important Note:</strong> This is an indicative calculator based on list prices.
                It does not constitute an official quote. Actual prices may vary based on the actual diagnosis.
                <strong>For an official and personalized quote, contact Albanian Dental Clinic.</strong>
            </p>
        </div>

        <!-- Contact CTA -->
        <div class="simulator-contact-cta">
            <button class="contact-cta-btn open-popup-btn" onclick="openPopup(); event.stopPropagation();">
                <i class="fas fa-paper-plane"></i> Request Official Quote
            </button>
            <a href="https://wa.me/37254450188" target="_blank" class="contact-cta-whatsapp" onclick="trackWhatsAppClick();">
                <i class="fab fa-whatsapp"></i> Contactez-Nous sur WhatsApp
            </a>
        </div>
    </div>
</div>

<!-- Quote Simulator Styles -->
<style>
.preventivo-simulator-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    z-index: 10000;
    overflow-y: auto;
    padding: 20px;
    box-sizing: border-box;
    backdrop-filter: blur(5px);
}

.preventivo-simulator-overlay.active {
    display: flex;
    justify-content: center;
    align-items: flex-start;
}

.preventivo-simulator-modal {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    border-radius: 20px;
    width: 100%;
    max-width: 900px;
    margin: 20px auto;
    padding: 30px;
    position: relative;
    box-shadow: 0 25px 80px rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.simulator-close-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: #fff;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 18px;
    transition: all 0.3s;
    z-index: 10;
}

.simulator-close-btn:hover {
    background: rgba(255, 77, 77, 0.3);
    transform: rotate(90deg);
}

.simulator-header {
    text-align: center;
    margin-bottom: 25px;
}

.simulator-logo img {
    max-height: 50px;
    margin-bottom: 15px;
}

.simulator-header h2 {
    color: #fff;
    font-size: 1.8rem;
    margin: 0 0 8px;
}

.simulator-header h2 i {
    color: #3498db;
    margin-right: 10px;
}

.simulator-subtitle {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.95rem;
    margin: 0;
}

/* Clinic Display Badge */
.simulator-clinic-display {
    margin-bottom: 25px;
    text-align: center;
}

.clinic-badge {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 12px 25px;
    background: linear-gradient(135deg, rgba(52, 152, 219, 0.3) 0%, rgba(41, 128, 185, 0.3) 100%);
    border: 2px solid #3498db;
    border-radius: 30px;
    color: #fff;
    font-size: 1rem;
    font-weight: 600;
}

.clinic-badge i:first-child {
    font-size: 1.2rem;
    color: #3498db;
}

/* Sessions */
.simulator-sessions {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-bottom: 25px;
}

.simulator-session {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 15px;
    padding: 20px;
}

.session-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 12px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.session-header h3 {
    color: #fff;
    margin: 0;
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    gap: 10px;
}

.session-header h3 i {
    color: #3498db;
}

.session-total {
    background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
    color: #fff;
    padding: 6px 15px;
    border-radius: 20px;
    font-weight: 600;
    font-size: 0.95rem;
}

/* Product Search */
.product-search-container {
    position: relative;
    margin-bottom: 15px;
}

.search-input-wrapper {
    position: relative;
    display: flex;
    align-items: center;
}

.search-input-wrapper i.fa-search {
    position: absolute;
    left: 15px;
    color: rgba(255, 255, 255, 0.4);
}

.product-search-input {
    width: 100%;
    padding: 12px 45px 12px 45px;
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 10px;
    color: #fff;
    font-size: 0.95rem;
    transition: all 0.3s;
}

.product-search-input::placeholder {
    color: rgba(255, 255, 255, 0.4);
}

.product-search-input:focus {
    outline: none;
    border-color: #3498db;
    background: rgba(255, 255, 255, 0.12);
}

.search-clear {
    position: absolute;
    right: 10px;
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.4);
    cursor: pointer;
    padding: 5px;
}

.search-clear:hover {
    color: #fff;
}

/* Search Dropdown */
.search-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: #1a1a2e;
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 10px;
    margin-top: 5px;
    max-height: 300px;
    overflow-y: auto;
    z-index: 100;
    display: none;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
}

.search-dropdown.active {
    display: block;
}

.dropdown-item {
    padding: 12px 15px;
    cursor: pointer;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    transition: background 0.2s;
}

.dropdown-item:last-child {
    border-bottom: none;
}

.dropdown-item:hover {
    background: rgba(52, 152, 219, 0.2);
}

.dropdown-item-name {
    color: #fff;
    font-weight: 500;
    margin-bottom: 3px;
}

.dropdown-item-meta {
    display: flex;
    justify-content: space-between;
    font-size: 0.85rem;
}

.dropdown-item-category {
    color: rgba(255, 255, 255, 0.5);
}

.dropdown-item-price {
    color: #3498db;
    font-weight: 600;
}

.dropdown-no-results {
    padding: 20px;
    text-align: center;
    color: rgba(255, 255, 255, 0.5);
}

/* Session Items */
.session-items {
    display: flex;
    flex-direction: column;
    gap: 10px;
    min-height: 50px;
}

.session-item {
    display: flex;
    align-items: center;
    gap: 15px;
    background: rgba(255, 255, 255, 0.05);
    padding: 12px 15px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.item-info {
    flex: 1;
}

.item-name {
    color: #fff;
    font-weight: 500;
    font-size: 0.95rem;
}

.item-category {
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.8rem;
}

.item-quantity {
    display: flex;
    align-items: center;
    gap: 8px;
}

.qty-btn {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    border: 1px solid rgba(255, 255, 255, 0.2);
    background: rgba(255, 255, 255, 0.05);
    color: #fff;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
}

.qty-btn:hover {
    background: rgba(52, 152, 219, 0.3);
    border-color: #3498db;
}

.qty-value {
    color: #fff;
    min-width: 30px;
    text-align: center;
    font-weight: 600;
}

.item-price {
    color: #3498db;
    font-weight: 600;
    min-width: 80px;
    text-align: right;
}

.item-remove {
    background: none;
    border: none;
    color: rgba(255, 77, 77, 0.7);
    cursor: pointer;
    padding: 5px;
    transition: color 0.2s;
}

.item-remove:hover {
    color: #ff4d4d;
}

.session-empty {
    text-align: center;
    padding: 20px;
    color: rgba(255, 255, 255, 0.4);
    font-size: 0.9rem;
}

/* Grand Total */
.simulator-grand-total {
    background: linear-gradient(135deg, rgba(52, 152, 219, 0.2) 0%, rgba(41, 128, 185, 0.1) 100%);
    border: 1px solid rgba(52, 152, 219, 0.3);
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 20px;
}

.grand-total-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.grand-total-label {
    color: rgba(255, 255, 255, 0.9);
    font-size: 1.2rem;
    font-weight: 500;
}

.grand-total-value {
    color: #fff;
    font-size: 2rem;
    font-weight: 700;
}

/* Actions */
.simulator-actions {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
}

.simulator-btn-secondary,
.simulator-btn-primary {
    flex: 1;
    padding: 14px 25px;
    border-radius: 10px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.simulator-btn-secondary {
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #fff;
}

.simulator-btn-secondary:hover {
    background: rgba(255, 255, 255, 0.15);
}

.simulator-btn-primary {
    background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
    border: none;
    color: #fff;
}

.simulator-btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 20px rgba(231, 76, 60, 0.4);
}

/* Disclaimer */
.simulator-disclaimer {
    background: rgba(241, 196, 15, 0.1);
    border: 1px solid rgba(241, 196, 15, 0.3);
    border-radius: 10px;
    padding: 15px;
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
}

.simulator-disclaimer i {
    color: #f1c40f;
    font-size: 1.2rem;
    flex-shrink: 0;
    margin-top: 2px;
}

.simulator-disclaimer p {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.85rem;
    line-height: 1.5;
    margin: 0;
}

.simulator-disclaimer strong {
    color: #f1c40f;
}

/* Contact CTA */
.simulator-contact-cta {
    display: flex;
    gap: 15px;
}

.contact-cta-btn,
.contact-cta-whatsapp {
    flex: 1;
    padding: 14px 20px;
    border-radius: 10px;
    text-decoration: none;
    font-weight: 600;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all 0.3s;
}

.contact-cta-btn {
    background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
    color: #fff;
}

.contact-cta-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 20px rgba(52, 152, 219, 0.4);
}

.contact-cta-whatsapp {
    background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
    color: #fff;
}

.contact-cta-whatsapp:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 20px rgba(37, 211, 102, 0.4);
}

/* Responsive */
@media (max-width: 768px) {
    .preventivo-simulator-modal {
        padding: 20px;
        margin: 10px;
    }

    .simulator-actions,
    .simulator-contact-cta {
        flex-direction: column;
    }

    .session-item {
        flex-wrap: wrap;
    }

    .item-info {
        width: 100%;
        margin-bottom: 10px;
    }

    .grand-total-value {
        font-size: 1.5rem;
    }
}

/* Scrollbar for dropdown */
.search-dropdown::-webkit-scrollbar {
    width: 6px;
}

.search-dropdown::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
}

.search-dropdown::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 3px;
}
</style>

<!-- jsPDF Library for PDF Generation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- Quote Simulator JavaScript -->
<script>
// ========================================
// CLINIC PRODUCTS DATA
// ========================================
const clinicProductsData = {
    sanmarco: {
        name: 'Albanian Dental Clinic',
        products: [
            { name: 'Invisible Fixed Braces', code: 'ORT-003', category: 'Orthodontics', price: 1600 },
            { name: 'Metal Fixed Braces', code: 'ORT-002', category: 'Orthodontics', price: 1400 },
            { name: 'Titanium Bar', code: 'IMP-013', category: 'Implantology', price: 500 },
            { name: 'Bite Guard', code: 'ORT-005', category: 'Orthodontics', price: 50 },
            { name: 'Simple Cementation', code: 'ALT-001', category: 'Other Services', price: 10 },
            { name: 'Ceramic Crown', code: 'COR-001', category: 'Crowns', price: 130 },
            { name: 'Composite Crown', code: 'COR-007', category: 'Crowns', price: 100 },
            { name: 'Gold Crown', code: 'COR-005', category: 'Crowns', price: 500 },
            { name: 'Palladium Crown', code: 'COR-004', category: 'Crowns', price: 500 },
            { name: 'Zirconia Crown', code: 'COR-002', category: 'Crowns', price: 180 },
            { name: 'Full Multilayer Zirconia Crown', code: 'COR-003', category: 'Crowns', price: 200 },
            { name: 'Temporary Crown', code: 'COR-006', category: 'Crowns', price: 10 },
            { name: 'Root Canal Treatment', code: 'END-001', category: 'Endodontics', price: 30 },
            { name: 'Preliminary Diagnosis / Treatment Plan', code: 'DIA-002', category: 'Diagnostics', price: 60 },
            { name: 'Surgical Wisdom Tooth Extraction', code: 'EST-006', category: 'Extractions', price: 250 },
            { name: 'Surgical Molar Extraction', code: 'EST-005', category: 'Extractions', price: 250 },
            { name: 'Impacted Tooth Extraction', code: 'EST-007', category: 'Extractions', price: 200 },
            { name: 'Simple Tooth Extraction', code: 'EST-001', category: 'Extractions', price: 50 },
            { name: 'Simple Baby Tooth Extraction', code: 'EST-002', category: 'Extractions', price: 30 },
            { name: 'Simple Molar Extraction', code: 'EST-004', category: 'Extractions', price: 150 },
            { name: 'Simple Root Extraction', code: 'EST-003', category: 'Extractions', price: 50 },
            { name: 'Emax Veneers', code: 'EST-102', category: 'Dental Aesthetics', price: 300 },
            { name: 'Composite Veneers', code: 'EST-101', category: 'Dental Aesthetics', price: 100 },
            { name: 'Titanium Dental Implant', code: 'IMP-002', category: 'Implantology', price: 350 },
            { name: 'JD Evolution Dental Implant', code: 'IMP-006', category: 'Implantology', price: 350 },
            { name: 'Megagen Dental Implant', code: 'IMP-001', category: 'Implantology', price: 500 },
            { name: 'Osstem-Toplan Dental Implant', code: 'IMP-005', category: 'Implantology', price: 350 },
            { name: 'Pterygoid Dental Implant', code: 'IMP-003', category: 'Implantology', price: 600 },
            { name: 'Tecom Dental Implant', code: 'IMP-007', category: 'Implantology', price: 400 },
            { name: 'Zygomatic Dental Implant', code: 'IMP-004', category: 'Implantology', price: 600 },
            { name: 'Bone Graft', code: 'IMP-012', category: 'Implantology', price: 300 },
            { name: 'Temporary Tray', code: 'PRO-007', category: 'Prosthetics', price: 100 },
            { name: 'Invisible Aligners', code: 'ORT-001', category: 'Orthodontics', price: 2200 },
            { name: 'Mini Sinus Lift', code: 'IMP-011', category: 'Implantology', price: 300 },
            { name: 'Abutment', code: 'IMP-009', category: 'Implantology', price: 80 },
            { name: 'Universal Abutment', code: 'IMP-008', category: 'Implantology', price: 100 },
            { name: 'Panoramic X-Ray', code: 'DIA-001', category: 'Diagnostics', price: 25 },
            { name: 'Canal Filling', code: 'OTT-008', category: 'Fillings', price: 30 },
            { name: 'Filling Class I', code: 'OTT-001', category: 'Fillings', price: 30 },
            { name: 'Filling Class II', code: 'OTT-002', category: 'Fillings', price: 40 },
            { name: 'Deep Filling Class II', code: 'OTT-003', category: 'Fillings', price: 40 },
            { name: 'Filling Class III with Infection', code: 'OTT-006', category: 'Fillings', price: 100 },
            { name: 'Filling Class III Frontal', code: 'OTT-004', category: 'Fillings', price: 50 },
            { name: 'Filling Class III Posterior', code: 'OTT-005', category: 'Fillings', price: 50 },
            { name: 'Filling Class IV', code: 'OTT-007', category: 'Fillings', price: 100 },
            { name: 'Temporary Bridge', code: 'PRO-006', category: 'Prosthetics', price: 100 },
            { name: 'Full Removable Denture', code: 'PRO-001', category: 'Prosthetics', price: 800 },
            { name: 'Skeletal Partial Denture', code: 'PRO-004', category: 'Prosthetics', price: 300 },
            { name: 'Skeletal Partial Denture with Attachment', code: 'PRO-005', category: 'Prosthetics', price: 500 },
            { name: 'Simple Partial Denture', code: 'PRO-003', category: 'Prosthetics', price: 150 },
            { name: 'Fixed Temporary Prosthesis', code: 'PRO-002', category: 'Prosthetics', price: 150 },
            { name: 'Dental Cleaning', code: 'IG-001', category: 'Dental Hygiene', price: 30 },
            { name: 'Dental Cleaning with Bicarbonate', code: 'IG-002', category: 'Dental Hygiene', price: 50 },
            { name: 'Dental Cleaning for Children', code: 'IG-004', category: 'Dental Hygiene', price: 30 },
            { name: 'Deep Dental Cleaning', code: 'IG-003', category: 'Dental Hygiene', price: 50 },
            { name: 'Apicoectomy', code: 'EST-008', category: 'Extractions', price: 200 },
            { name: 'Sinus Lift', code: 'IMP-010', category: 'Implantology', price: 500 },
            { name: 'Reconstruction with Screw', code: 'RIC-003', category: 'Reconstructions', price: 50 },
            { name: 'Reconstruction with Screw + Filling Class III', code: 'RIC-002', category: 'Reconstructions', price: 70 },
            { name: 'Bridge Reconstruction', code: 'RIC-001', category: 'Reconstructions', price: 40 },
            { name: 'Cyst Removal', code: 'CHI-002', category: 'Surgery', price: 300 },
            { name: 'Canine Tooth Retraction', code: 'ORT-004', category: 'Orthodontics', price: 150 },
            { name: 'Root Canal Retreatment', code: 'END-002', category: 'Endodontics', price: 70 },
            { name: 'Teeth Whitening', code: 'IG-005', category: 'Dental Hygiene', price: 250 },
            { name: 'Sedation', code: 'CHI-001', category: 'Surgery', price: 250 },
            { name: 'Sealant', code: 'OTT-009', category: 'Fillings', price: 20 },
            { name: '3D CT Scan', code: 'DIA-003', category: 'Diagnostics', price: 100 },
            { name: 'Orthodontic Consultation for Invisible Aligners', code: 'DIA-004', category: 'Diagnostics', price: 200 }
        ]
    }
};

// ========================================
// SIMULATOR STATE
// ========================================
let simulatorState = {
    selectedClinic: 'sanmarco',
    prima: [],  // Array of {product, quantity}
    seconda: [] // Array of {product, quantity}
};

// ========================================
// FUZZY SEARCH (Same algorithm as CRM)
// ========================================
function fuzzySearch(query, products) {
    if (!query || query.length < 2) return products.slice(0, 10);

    const searchTerms = query.toLowerCase().split(/\s+/).filter(t => t.length > 0);

    const scored = products.map(product => {
        const nameL = product.name.toLowerCase();
        const categoryL = product.category.toLowerCase();
        const codeL = product.code.toLowerCase();
        let score = 0;

        searchTerms.forEach(term => {
            // Exact match in name
            if (nameL.includes(term)) {
                score += 100;
                if (nameL.startsWith(term)) score += 50;
            }
            // Match in category
            if (categoryL.includes(term)) {
                score += 30;
            }
            // Match in code
            if (codeL.includes(term)) {
                score += 20;
            }
            // Partial match (fuzzy)
            for (let i = 0; i < nameL.length - 1; i++) {
                if (nameL.substring(i).startsWith(term.substring(0, 2))) {
                    score += 10;
                    break;
                }
            }
        });

        return { product, score };
    });

    return scored
        .filter(item => item.score > 0)
        .sort((a, b) => b.score - a.score)
        .slice(0, 15)
        .map(item => item.product);
}

// ========================================
// MODAL FUNCTIONS
// ========================================
function openQuoteSimulator() {
    document.getElementById('preventivo-simulator-overlay').classList.add('active');
    document.body.style.overflow = 'hidden';

    // GA4 Tracking - popup_open event
    if (typeof gtag === 'function') {
        gtag('event', 'popup_open', {
            'event_category': 'Modal',
            'event_label': 'Quote Simulator',
            'modal_name': 'preventivo_simulator',
            'step': 1
        });
    }

    // Meta Pixel - ViewContent
    if (typeof fbq === 'function') {
        fbq('track', 'ViewContent', {
            content_name: 'Quote Simulator',
            content_category: 'Step 1 - Calculator'
        });
    }

    console.log('üìä Tracking: popup_open - Quote Simulator');
}

function closeQuoteSimulator() {
    document.getElementById('preventivo-simulator-overlay').classList.remove('active');
    document.body.style.overflow = '';
    hideAllDropdowns();

    // GA4 Tracking - popup_close event
    if (typeof gtag === 'function') {
        const grandTotal = simulatorState.prima.reduce((sum, item) => sum + (item.product.price * item.quantity), 0) +
                          simulatorState.seconda.reduce((sum, item) => sum + (item.product.price * item.quantity), 0);
        gtag('event', 'popup_close', {
            'event_category': 'Modal',
            'event_label': 'Quote Simulator',
            'modal_name': 'preventivo_simulator',
            'step': 1,
            'items_added': simulatorState.prima.length + simulatorState.seconda.length,
            'total_value': grandTotal
        });
    }

    console.log('üìä Tracking: popup_close - Quote Simulator');
}

// ========================================
// SEARCH FUNCTIONS
// ========================================
function handleSearch(session, query) {
    const dropdown = document.getElementById(`dropdown-${session}`);
    const clearBtn = document.querySelector(`#search-${session}`).parentElement.querySelector('.search-clear');

    clearBtn.style.display = query ? 'block' : 'none';

    const products = clinicProductsData[simulatorState.selectedClinic].products;
    const results = fuzzySearch(query, products);

    if (results.length === 0) {
        dropdown.innerHTML = '<div class="dropdown-no-results">No services found</div>';
    } else {
        dropdown.innerHTML = results.map(product => `
            <div class="dropdown-item" onclick="addProduct('${session}', '${product.code}')">
                <div class="dropdown-item-name">${highlightMatch(product.name, query)}</div>
                <div class="dropdown-item-meta">
                    <span class="dropdown-item-category">${product.category}</span>
                    <span class="dropdown-item-price">‚Ç¨${product.price.toFixed(2)}</span>
                </div>
            </div>
        `).join('');
    }

    dropdown.classList.add('active');
}

function highlightMatch(text, query) {
    if (!query) return text;
    const regex = new RegExp(`(${query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
    return text.replace(regex, '<strong style="color:#3498db">$1</strong>');
}

function showDropdown(session) {
    const input = document.getElementById(`search-${session}`);
    if (input.value.length >= 2) {
        handleSearch(session, input.value);
    }
}

function hideAllDropdowns() {
    document.querySelectorAll('.search-dropdown').forEach(d => d.classList.remove('active'));
}

function clearSearch(session) {
    const input = document.getElementById(`search-${session}`);
    input.value = '';
    input.parentElement.querySelector('.search-clear').style.display = 'none';
    hideAllDropdowns();
}

// ========================================
// PRODUCT MANAGEMENT
// ========================================
function addProduct(session, productCode) {
    const products = clinicProductsData[simulatorState.selectedClinic].products;
    const product = products.find(p => p.code === productCode);

    if (!product) return;

    // Check if already exists
    const existingIndex = simulatorState[session].findIndex(item => item.product.code === productCode);

    if (existingIndex >= 0) {
        // Increment quantity
        simulatorState[session][existingIndex].quantity++;
    } else {
        // Add new item
        simulatorState[session].push({ product, quantity: 1 });
    }

    // Clear search
    clearSearch(session);

    // Update UI
    renderSessionItems(session);
    updateTotals();

    // GA4 Tracking
    if (typeof gtag === 'function') {
        gtag('event', 'preventivo_add_item', {
            'event_category': 'Quote Simulator',
            'session': session,
            'product_name': product.name,
            'product_code': product.code,
            'product_category': product.category,
            'product_price': product.price
        });
    }

    // Meta Pixel - Add to cart style event
    if (typeof fbq === 'function') {
        fbq('track', 'AddToCart', {
            content_name: product.name,
            content_category: product.category,
            content_ids: [product.code],
            value: product.price,
            currency: 'EUR'
        });
    }

    console.log('üìä Tracking: preventivo_add_item -', product.name);
}

function updateQuantity(session, productCode, delta) {
    const itemIndex = simulatorState[session].findIndex(item => item.product.code === productCode);

    if (itemIndex >= 0) {
        const newQty = simulatorState[session][itemIndex].quantity + delta;

        if (newQty <= 0) {
            removeProduct(session, productCode);
        } else {
            simulatorState[session][itemIndex].quantity = newQty;
            renderSessionItems(session);
            updateTotals();
        }
    }
}

function removeProduct(session, productCode) {
    simulatorState[session] = simulatorState[session].filter(item => item.product.code !== productCode);
    renderSessionItems(session);
    updateTotals();
}

// ========================================
// RENDERING
// ========================================
function renderSessionItems(session) {
    const container = document.getElementById(`items-${session}`);
    const items = simulatorState[session];

    if (items.length === 0) {
        container.innerHTML = '<div class="session-empty"><i class="fas fa-search"></i> Search and add services</div>';
        return;
    }

    container.innerHTML = items.map(item => `
        <div class="session-item">
            <div class="item-info">
                <div class="item-name">${item.product.name}</div>
                <div class="item-category">${item.product.category}</div>
            </div>
            <div class="item-quantity">
                <button class="qty-btn" onclick="updateQuantity('${session}', '${item.product.code}', -1)">
                    <i class="fas fa-minus"></i>
                </button>
                <span class="qty-value">${item.quantity}</span>
                <button class="qty-btn" onclick="updateQuantity('${session}', '${item.product.code}', 1)">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
            <div class="item-price">‚Ç¨${(item.product.price * item.quantity).toFixed(2)}</div>
            <button class="item-remove" onclick="removeProduct('${session}', '${item.product.code}')">
                <i class="fas fa-trash"></i>
            </button>
        </div>
    `).join('');
}

function updateTotals() {
    const primaTotal = simulatorState.prima.reduce((sum, item) => sum + (item.product.price * item.quantity), 0);
    const secondaTotal = simulatorState.seconda.reduce((sum, item) => sum + (item.product.price * item.quantity), 0);
    const grandTotal = primaTotal + secondaTotal;

    document.getElementById('prima-seduta-total').textContent = `‚Ç¨${primaTotal.toFixed(2)}`;
    document.getElementById('seconda-seduta-total').textContent = `‚Ç¨${secondaTotal.toFixed(2)}`;
    document.getElementById('grand-total').textContent = `‚Ç¨${grandTotal.toFixed(2)}`;
}

// ========================================
// RESET
// ========================================
function resetSimulator() {
    simulatorState.prima = [];
    simulatorState.seconda = [];

    renderSessionItems('prima');
    renderSessionItems('seconda');
    updateTotals();

    clearSearch('prima');
    clearSearch('seconda');
}

// ========================================
// PDF GENERATION
// ========================================
function generatePDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    const clinicName = clinicProductsData[simulatorState.selectedClinic].name;
    const today = new Date().toLocaleDateString('fr-FR', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });

    // Colors
    const primaryBlue = [52, 152, 219];
    const darkText = [30, 30, 30];
    const grayText = [100, 100, 100];
    const lightBg = [248, 249, 250];

    let yPos = 20;

    // Header
    doc.setFillColor(26, 26, 46);
    doc.rect(0, 0, 210, 45, 'F');

    // Title
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(20);
    doc.setFont('helvetica', 'bold');
    doc.text('ALBANIAN DENTAL CLINIC', 105, 18, { align: 'center' });

    doc.setFontSize(14);
    doc.setFont('helvetica', 'normal');
    doc.text('Calculateur de Couts', 105, 28, { align: 'center' });

    doc.setFontSize(10);
    doc.setTextColor(180, 180, 180);
    doc.text(`Clinique: ${clinicName} | Date: ${today}`, 105, 38, { align: 'center' });

    yPos = 55;

    // Function to add session
    function addSession(sessionName, items, sessionLabel) {
        if (items.length === 0) return;

        // Session header
        doc.setFillColor(...primaryBlue);
        doc.rect(15, yPos - 5, 180, 10, 'F');
        doc.setTextColor(255, 255, 255);
        doc.setFontSize(12);
        doc.setFont('helvetica', 'bold');
        doc.text(sessionLabel, 20, yPos + 2);

        const sessionTotal = items.reduce((sum, item) => sum + (item.product.price * item.quantity), 0);
        doc.text(`‚Ç¨${sessionTotal.toFixed(2)}`, 190, yPos + 2, { align: 'right' });

        yPos += 15;

        // Table header
        doc.setFillColor(...lightBg);
        doc.rect(15, yPos - 4, 180, 8, 'F');
        doc.setTextColor(...grayText);
        doc.setFontSize(9);
        doc.setFont('helvetica', 'bold');
        doc.text('Service', 20, yPos);
        doc.text('Categorie', 100, yPos);
        doc.text('Qte', 140, yPos);
        doc.text('Prix', 160, yPos);
        doc.text('Total', 180, yPos);

        yPos += 8;

        // Items
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(...darkText);

        items.forEach(item => {
            if (yPos > 260) {
                doc.addPage();
                yPos = 20;
            }

            doc.setFontSize(9);
            doc.text(item.product.name.substring(0, 40), 20, yPos);
            doc.setTextColor(...grayText);
            doc.text(item.product.category.substring(0, 20), 100, yPos);
            doc.setTextColor(...darkText);
            doc.text(item.quantity.toString(), 145, yPos, { align: 'center' });
            doc.text(`‚Ç¨${item.product.price.toFixed(2)}`, 165, yPos, { align: 'right' });
            doc.text(`‚Ç¨${(item.product.price * item.quantity).toFixed(2)}`, 190, yPos, { align: 'right' });

            yPos += 7;
        });

        yPos += 10;
    }

    // Add sessions
    addSession('prima', simulatorState.prima, 'PREMIERE SEANCE');
    addSession('seconda', simulatorState.seconda, 'DEUXIEME SEANCE');

    // Grand Total
    const grandTotal = simulatorState.prima.reduce((sum, item) => sum + (item.product.price * item.quantity), 0) +
                       simulatorState.seconda.reduce((sum, item) => sum + (item.product.price * item.quantity), 0);

    yPos += 5;
    doc.setFillColor(26, 26, 46);
    doc.rect(15, yPos - 5, 180, 15, 'F');
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(14);
    doc.setFont('helvetica', 'bold');
    doc.text('TOTAL ESTIME:', 20, yPos + 4);
    doc.text(`‚Ç¨${grandTotal.toFixed(2)}`, 190, yPos + 4, { align: 'right' });

    yPos += 25;

    // Disclaimer box
    doc.setFillColor(255, 243, 205);
    doc.setDrawColor(255, 193, 7);
    doc.rect(15, yPos, 180, 35, 'FD');

    doc.setTextColor(133, 100, 4);
    doc.setFontSize(10);
    doc.setFont('helvetica', 'bold');
    doc.text('NOTE IMPORTANTE', 20, yPos + 8);

    doc.setFont('helvetica', 'normal');
    doc.setFontSize(8);
    const disclaimerText = 'Ce document est un CALCULATEUR INDICATIF base sur les prix catalogue. Il ne constitue PAS un devis officiel. Les prix reels peuvent varier selon le diagnostic et le plan de traitement personnalise.';
    const splitDisclaimer = doc.splitTextToSize(disclaimerText, 170);
    doc.text(splitDisclaimer, 20, yPos + 15);

    doc.setFont('helvetica', 'bold');
    doc.text('Pour un devis officiel, contactez Albanian Dental Clinic.', 20, yPos + 30);

    // Footer
    yPos = 280;
    doc.setDrawColor(200, 200, 200);
    doc.line(15, yPos - 5, 195, yPos - 5);

    doc.setTextColor(...grayText);
    doc.setFontSize(8);
    doc.setFont('helvetica', 'normal');
    doc.text('Albanian Dental Clinic | www.albaniandentalclinic.com | WhatsApp: +372 5445 0188', 105, yPos, { align: 'center' });
    doc.text(`Document genere le ${today} - A titre informatif uniquement`, 105, yPos + 5, { align: 'center' });

    // Save PDF
    const fileName = `ADC_Devis_${new Date().toISOString().split('T')[0]}.pdf`;
    doc.save(fileName);

    // GA4 Tracking - PDF Generated (conversion event)
    if (typeof gtag === 'function') {
        gtag('event', 'preventivo_pdf_generated', {
            'event_category': 'Quote Simulator',
            'event_label': 'PDF Downloaded',
            'clinic': simulatorState.selectedClinic,
            'total': grandTotal,
            'prima_items': simulatorState.prima.length,
            'seconda_items': simulatorState.seconda.length,
            'value': grandTotal,
            'currency': 'EUR'
        });

        // GA4 generate_lead - will be imported to Google Ads
        gtag('event', 'generate_lead', {
            'event_category': 'Quote Simulator',
            'event_label': 'PDF Downloaded',
            'value': grandTotal,
            'currency': 'EUR'
        });
    }

    // Meta Pixel - Lead event (PDF download is a lead indicator)
    if (typeof fbq === 'function') {
        fbq('track', 'Lead', {
            content_name: 'Quote PDF Generated',
            content_category: 'Step 1 - Calculator',
            value: grandTotal,
            currency: 'EUR'
        });
    }

    console.log('üìä Tracking: preventivo_pdf_generated - Total: ‚Ç¨' + grandTotal.toFixed(2));
}

// ========================================
// EVENT LISTENERS
// ========================================
document.addEventListener('click', function(e) {
    if (!e.target.closest('.product-search-container')) {
        hideAllDropdowns();
    }
});

// Close on Escape
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeQuoteSimulator();
    }
});

// Close on overlay click
document.getElementById('preventivo-simulator-overlay').addEventListener('click', function(e) {
    if (e.target === this) {
        closeQuoteSimulator();
    }
});

// Initialize
renderSessionItems('prima');
renderSessionItems('seconda');
updateTotals();

console.log('‚úÖ Quote Simulator initialized');
</script>

<!-- ========================================
     FLIGHT SEARCH MODAL
======================================== -->
<div id="flight-search-overlay" class="flight-search-overlay">
    <div class="flight-search-modal">
        <button class="flight-close-btn" onclick="closeFlightSearch()">
            <i class="fas fa-times"></i>
        </button>

        <div class="flight-header">
            <div class="flight-header-icon">
                <i class="fas fa-plane"></i>
            </div>
            <h2>Find Flights to Tirana</h2>
            <p class="flight-subtitle">Search for the best flights from Europe to Albania</p>
        </div>

        <!-- Destination Info -->
        <div class="flight-destination-info">
            <div class="destination-card">
                <div class="destination-icon">
                    <i class="fas fa-map-marker-alt"></i>
                </div>
                <div class="destination-details">
                    <span class="destination-label">Destination</span>
                    <span class="destination-name">Tirana (TIA)</span>
                    <span class="destination-airport">Aeroporto Internazionale N√´n√´ Tereza</span>
                </div>
            </div>
        </div>

        <!-- S√©lection de la Ville de D√©part - A√©roports Fran√ßais -->
        <div class="flight-departure-section">
            <label><i class="fas fa-plane-departure"></i> S√©lectionnez votre ville de d√©part:</label>
            <div class="departure-cities-grid">
                <button class="departure-city active" data-city="ORY" data-name="Paris Orly" onclick="selectDepartureCity(this)">
                    <span class="city-name">Paris Orly</span>
                    <span class="city-code">ORY</span>
                </button>
                <button class="departure-city" data-city="BVA" data-name="Paris Beauvais" onclick="selectDepartureCity(this)">
                    <span class="city-name">Paris Beauvais</span>
                    <span class="city-code">BVA</span>
                </button>
                <button class="departure-city" data-city="CDG" data-name="Paris CDG" onclick="selectDepartureCity(this)">
                    <span class="city-name">Paris CDG</span>
                    <span class="city-code">CDG</span>
                </button>
            </div>
        </div>

        <!-- Date Selection - Elegant Mobile-Friendly -->
        <div class="flight-date-section">
            <div class="date-input-group">
                <label><i class="fas fa-plane-departure"></i> Departure Date</label>
                <div class="date-picker-wrapper" onclick="document.getElementById('flight-departure-date').showPicker()">
                    <input type="date" id="flight-departure-date" class="flight-date-input" onchange="onDepartureDateChange(this)">
                    <div class="date-display" id="departure-display">
                        <span class="date-day">--</span>
                        <span class="date-info">
                            <span class="date-weekday">Select</span>
                            <span class="date-month">date</span>
                        </span>
                    </div>
                </div>
            </div>
            <div class="date-arrow">
                <i class="fas fa-arrow-right"></i>
            </div>
            <div class="date-input-group">
                <label><i class="fas fa-plane-arrival"></i> Return Date</label>
                <div class="date-picker-wrapper" onclick="document.getElementById('flight-return-date').showPicker()">
                    <input type="date" id="flight-return-date" class="flight-date-input" onchange="onReturnDateChange(this)">
                    <div class="date-display" id="return-display">
                        <span class="date-day">--</span>
                        <span class="date-info">
                            <span class="date-weekday">Select</span>
                            <span class="date-month">date</span>
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Trip Duration Info -->
        <div class="trip-duration" id="trip-duration" style="display: none;">
            <i class="fas fa-clock"></i>
            <span id="trip-duration-text">Duration: 2 nights</span>
        </div>

        <!-- Main Search Button -->
        <div class="flight-main-search">
            <a href="#" id="google-search-link" class="flight-google-search-btn" target="_blank" onclick="openGoogleFlights(event)">
                <div class="google-btn-icon">
                    <i class="fas fa-plane"></i>
                </div>
                <div class="google-btn-text">
                    <span>Search on Skyscanner</span>
                    <small>Compare prices from all airlines</small>
                </div>
                <div class="google-btn-arrow">
                    <i class="fas fa-arrow-right"></i>
                </div>
                <div class="google-btn-shine"></div>
            </a>
        </div>

        <!-- Tips Section -->
        <div class="flight-tips">
            <h4><i class="fas fa-lightbulb"></i> Tips to Save Money</h4>
            <ul>
                <li><i class="fas fa-check"></i> Book 2-3 weeks in advance for the best prices</li>
                <li><i class="fas fa-check"></i> Tuesday and Wednesday flights are often cheaper</li>
                <li><i class="fas fa-check"></i> Wizz Air and Ryanair offer direct low-cost flights</li>
                <li><i class="fas fa-check"></i> Airport transfer to the clinic is FREE!</li>
            </ul>
        </div>

        <!-- Contact CTA -->
        <div class="flight-contact-cta">
            <p><i class="fas fa-headset"></i> Need help organizing your trip?</p>
            <a href="https://wa.me/37254450188?text=Hello!%20I%20need%20help%20organizing%20my%20trip%20to%20Tirana%20for%20dental%20treatment." target="_blank" class="flight-whatsapp-btn" onclick="trackWhatsAppClick();">
                <i class="fab fa-whatsapp"></i> Contactez-Nous sur WhatsApp
            </a>
        </div>
    </div>
</div>

<!-- Flight Search Modal Styles -->
<style>
.flight-search-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    z-index: 10000;
    overflow-y: auto;
    padding: 20px;
    box-sizing: border-box;
    backdrop-filter: blur(5px);
}

.flight-search-overlay.active {
    display: flex;
    justify-content: center;
    align-items: flex-start;
}

.flight-search-modal {
    background: linear-gradient(135deg, #1e3a5f 0%, #0f2744 100%);
    border-radius: 20px;
    width: 100%;
    max-width: 800px;
    margin: 20px auto;
    padding: 30px;
    position: relative;
    box-shadow: 0 25px 80px rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.flight-close-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: #fff;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 18px;
    transition: all 0.3s;
    z-index: 10;
}

.flight-close-btn:hover {
    background: rgba(255, 77, 77, 0.3);
    transform: rotate(90deg);
}

.flight-header {
    text-align: center;
    margin-bottom: 25px;
}

.flight-header-icon {
    width: 70px;
    height: 70px;
    background: linear-gradient(135deg, #ea580c 0%, #c2410c 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 15px;
    font-size: 28px;
    color: white;
    box-shadow: 0 4px 20px rgba(234, 88, 12, 0.4);
}

.flight-header h2 {
    color: #fff;
    font-size: 1.8rem;
    margin: 0 0 8px;
}

.flight-subtitle {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.95rem;
    margin: 0;
}

/* Destination Info */
.flight-destination-info {
    margin-bottom: 25px;
}

.destination-card {
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 15px 20px;
    display: flex;
    align-items: center;
    gap: 15px;
}

.destination-icon {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    color: white;
}

.destination-details {
    display: flex;
    flex-direction: column;
}

.destination-label {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.5);
    text-transform: uppercase;
    letter-spacing: 1px;
}

.destination-name {
    font-size: 1.2rem;
    color: #fff;
    font-weight: 600;
}

.destination-airport {
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.6);
}

/* Departure Cities */
.flight-departure-section {
    margin-bottom: 25px;
}

.flight-departure-section label {
    display: block;
    color: rgba(255, 255, 255, 0.9);
    margin-bottom: 12px;
    font-size: 0.95rem;
    font-weight: 500;
}

.flight-departure-section label i {
    margin-right: 8px;
    color: #ea580c;
}

.departure-cities-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
}

.departure-city {
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    padding: 12px 8px;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
}

.departure-city:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(234, 88, 12, 0.5);
}

.departure-city.active {
    background: linear-gradient(135deg, rgba(234, 88, 12, 0.3) 0%, rgba(194, 65, 12, 0.3) 100%);
    border-color: #ea580c;
}

.departure-city .city-name {
    color: #fff;
    font-weight: 600;
    font-size: 0.9rem;
}

.departure-city .city-code {
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.75rem;
}

.departure-city.active .city-code {
    color: #ea580c;
}

/* Date Selection - Elegant Mobile-Friendly */
.flight-date-section {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
}

.flight-date-section .date-input-group {
    flex: 1;
}

.date-input-group label {
    display: block;
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 8px;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.date-input-group label i {
    margin-right: 6px;
    color: #ea580c;
}

.date-picker-wrapper {
    position: relative;
    cursor: pointer;
    background: rgba(255, 255, 255, 0.08);
    border: 2px solid rgba(255, 255, 255, 0.15);
    border-radius: 12px;
    padding: 12px 15px;
    transition: all 0.3s ease;
}

.date-picker-wrapper:hover {
    border-color: rgba(234, 88, 12, 0.5);
    background: rgba(255, 255, 255, 0.12);
}

.date-picker-wrapper:has(.flight-date-input:focus) {
    border-color: #ea580c;
    box-shadow: 0 0 15px rgba(234, 88, 12, 0.3);
}

.flight-date-input {
    position: absolute;
    opacity: 0;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    cursor: pointer;
    z-index: 2;
}

.date-display {
    display: flex;
    align-items: center;
    gap: 12px;
}

.date-display .date-day {
    font-size: 1.8rem;
    font-weight: 700;
    color: #ea580c;
    min-width: 45px;
    text-align: center;
}

.date-display .date-info {
    display: flex;
    flex-direction: column;
}

.date-display .date-weekday {
    font-size: 0.9rem;
    font-weight: 600;
    color: #fff;
    text-transform: capitalize;
}

.date-display .date-month {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.6);
    text-transform: capitalize;
}

.date-arrow {
    display: flex;
    align-items: center;
    justify-content: center;
    padding-top: 25px;
}

.date-arrow i {
    color: #ea580c;
    font-size: 1.2rem;
    animation: pulseArrow 1.5s ease-in-out infinite;
}

@keyframes pulseArrow {
    0%, 100% { transform: translateX(0); opacity: 0.7; }
    50% { transform: translateX(3px); opacity: 1; }
}

/* Trip Duration Info */
.trip-duration {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 10px;
    background: rgba(34, 197, 94, 0.15);
    border: 1px solid rgba(34, 197, 94, 0.3);
    border-radius: 10px;
    color: #22c55e;
    font-size: 0.85rem;
    margin-bottom: 20px;
}

.trip-duration i {
    font-size: 1rem;
}

/* Mobile styles for dates */
@media (max-width: 480px) {
    .flight-date-section {
        flex-direction: column;
        gap: 15px;
    }

    .date-arrow {
        padding: 0;
        transform: rotate(90deg);
    }

    .date-display .date-day {
        font-size: 1.5rem;
    }
}

/* Main Google Search Button */
.flight-main-search {
    margin-bottom: 25px;
}

.flight-google-search-btn {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 18px 25px;
    background: linear-gradient(135deg, #4285f4 0%, #1a73e8 100%);
    border-radius: 15px;
    text-decoration: none;
    color: #fff;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 4px 20px rgba(66, 133, 244, 0.4);
    position: relative;
    overflow: hidden;
}

.google-btn-icon {
    width: 50px;
    height: 50px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    flex-shrink: 0;
}

.google-btn-text {
    flex: 1;
}

.google-btn-text span {
    display: block;
    font-size: 1.2rem;
    font-weight: 700;
}

.google-btn-text small {
    display: block;
    font-size: 0.8rem;
    opacity: 0.85;
    margin-top: 3px;
}

.google-btn-arrow {
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.15);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
}

.google-btn-arrow i {
    transition: transform 0.3s;
}

.google-btn-shine {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    transition: left 0.5s;
}

.flight-google-search-btn:hover {
    transform: translateY(-4px) scale(1.02);
    box-shadow: 0 12px 40px rgba(66, 133, 244, 0.6);
}

.flight-google-search-btn:hover .google-btn-arrow {
    background: rgba(255, 255, 255, 0.3);
}

.flight-google-search-btn:hover .google-btn-arrow i {
    transform: translateX(5px);
}

.flight-google-search-btn:hover .google-btn-shine {
    left: 100%;
}

/* Preview Sites */
.google-search-preview {
    margin-top: 12px;
    text-align: center;
}

.google-search-preview > span {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.5);
    display: block;
    margin-bottom: 8px;
}

.preview-sites {
    display: flex;
    justify-content: center;
    gap: 8px;
    flex-wrap: wrap;
}

.preview-site {
    background: rgba(255, 255, 255, 0.08);
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* Tips Section */
.flight-tips {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
}

.flight-tips h4 {
    color: #fff;
    margin: 0 0 15px;
    font-size: 1rem;
    display: flex;
    align-items: center;
    gap: 8px;
}

.flight-tips h4 i {
    color: #fbbf24;
}

.flight-tips ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.flight-tips li {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.9rem;
    padding: 8px 0;
    display: flex;
    align-items: flex-start;
    gap: 10px;
}

.flight-tips li i {
    color: #10b981;
    margin-top: 3px;
}

/* Contact CTA */
.flight-contact-cta {
    text-align: center;
    padding-top: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.flight-contact-cta p {
    color: rgba(255, 255, 255, 0.7);
    margin: 0 0 15px;
    font-size: 0.9rem;
}

.flight-contact-cta p i {
    margin-right: 8px;
    color: #ea580c;
}

.flight-whatsapp-btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 14px 30px;
    background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
    color: #fff;
    text-decoration: none;
    border-radius: 10px;
    font-weight: 600;
    transition: all 0.3s;
}

.flight-whatsapp-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4);
}

/* Responsive */
@media (max-width: 768px) {
    .flight-search-modal {
        padding: 20px;
        margin: 10px;
    }

    .departure-cities-grid {
        grid-template-columns: repeat(3, 1fr);
    }

    .flight-date-section {
        grid-template-columns: 1fr;
    }

    .flight-google-search-btn span {
        font-size: 1rem;
    }
}

@media (max-width: 480px) {
    .departure-cities-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}
</style>

<!-- Flight Search JavaScript -->
<script>
// ========================================
// FLIGHT SEARCH STATE
// ========================================
let flightSearchState = {
    departureCity: 'ORY',
    departureName: 'Paris Orly',
    departureDate: '',
    returnDate: ''
};

// ========================================
// DATE DISPLAY HELPERS
// ========================================
const englishWeekdays = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
const englishMonths = ['January', 'February', 'March', 'April', 'May', 'June',
                       'July', 'August', 'September', 'October', 'November', 'December'];

function updateDateDisplay(inputId, displayId) {
    const input = document.getElementById(inputId);
    const display = document.getElementById(displayId);

    if (!input.value) return;

    const date = new Date(input.value + 'T00:00:00');
    const day = date.getDate();
    const weekday = englishWeekdays[date.getDay()];
    const month = englishMonths[date.getMonth()];
    const year = date.getFullYear();

    display.querySelector('.date-day').textContent = day;
    display.querySelector('.date-weekday').textContent = weekday;
    display.querySelector('.date-month').textContent = `${month} ${year}`;
}

function onDepartureDateChange(input) {
    // Update display
    updateDateDisplay('flight-departure-date', 'departure-display');

    // Auto-set return date to departure + 2 days
    const depDate = new Date(input.value + 'T00:00:00');
    const retDate = new Date(depDate.getTime() + 2 * 24 * 60 * 60 * 1000);

    const returnInput = document.getElementById('flight-return-date');
    returnInput.value = formatDate(retDate);
    updateDateDisplay('flight-return-date', 'return-display');

    // Update state
    flightSearchState.departureDate = input.value;
    flightSearchState.returnDate = returnInput.value;

    // Show trip duration
    updateTripDuration();
    updateFlightLinks();
}

function onReturnDateChange(input) {
    const depDate = new Date(document.getElementById('flight-departure-date').value + 'T00:00:00');
    const retDate = new Date(input.value + 'T00:00:00');

    // Validate: return must be after departure
    if (retDate <= depDate) {
        // Set return to departure + 1 day
        const newRetDate = new Date(depDate.getTime() + 24 * 60 * 60 * 1000);
        input.value = formatDate(newRetDate);
    }

    // Update display
    updateDateDisplay('flight-return-date', 'return-display');

    // Update state
    flightSearchState.returnDate = input.value;

    // Show trip duration
    updateTripDuration();
    updateFlightLinks();
}

function updateTripDuration() {
    const depDate = new Date(document.getElementById('flight-departure-date').value + 'T00:00:00');
    const retDate = new Date(document.getElementById('flight-return-date').value + 'T00:00:00');

    const diffTime = retDate.getTime() - depDate.getTime();
    const nights = Math.round(diffTime / (24 * 60 * 60 * 1000));

    const durationEl = document.getElementById('trip-duration');
    const textEl = document.getElementById('trip-duration-text');

    if (nights > 0) {
        durationEl.style.display = 'flex';
        textEl.textContent = nights === 1 ? 'Duration: 1 night' : `Duration: ${nights} nights`;
    } else {
        durationEl.style.display = 'none';
    }
}

// ========================================
// MODAL FUNCTIONS
// ========================================
function openFlightSearch() {
    document.getElementById('flight-search-overlay').classList.add('active');
    document.body.style.overflow = 'hidden';

    // Set default dates (next week for departure, +2 days for return)
    const today = new Date();
    const nextWeek = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000);
    const returnDate = new Date(nextWeek.getTime() + 2 * 24 * 60 * 60 * 1000); // Changed to +2 days

    document.getElementById('flight-departure-date').value = formatDate(nextWeek);
    document.getElementById('flight-return-date').value = formatDate(returnDate);

    // Update visual displays
    updateDateDisplay('flight-departure-date', 'departure-display');
    updateDateDisplay('flight-return-date', 'return-display');
    updateTripDuration();

    flightSearchState.departureDate = formatDate(nextWeek);
    flightSearchState.returnDate = formatDate(returnDate);

    updateFlightLinks();

    // GA4 Tracking - popup_open event
    if (typeof gtag === 'function') {
        gtag('event', 'popup_open', {
            'event_category': 'Modal',
            'event_label': 'Flight Search',
            'modal_name': 'flight_search',
            'step': 2,
            'departure_city': flightSearchState.departureCity
        });
    }

    // Meta Pixel - ViewContent
    if (typeof fbq === 'function') {
        fbq('track', 'ViewContent', {
            content_name: 'Flight Search',
            content_category: 'Step 2 - Travel Planning',
            departure_city: flightSearchState.departureCity
        });
    }

    console.log('üìä Tracking: popup_open - Flight Search');
}

function closeFlightSearch() {
    document.getElementById('flight-search-overlay').classList.remove('active');
    document.body.style.overflow = '';

    // GA4 Tracking - popup_close event
    if (typeof gtag === 'function') {
        gtag('event', 'popup_close', {
            'event_category': 'Modal',
            'event_label': 'Flight Search',
            'modal_name': 'flight_search',
            'step': 2,
            'departure_city': flightSearchState.departureCity,
            'departure_date': flightSearchState.departureDate,
            'return_date': flightSearchState.returnDate
        });
    }

    console.log('üìä Tracking: popup_close - Flight Search');
}

function formatDate(date) {
    return date.toISOString().split('T')[0];
}

// ========================================
// CITY SELECTION
// ========================================
function selectDepartureCity(btn) {
    // Update active state
    document.querySelectorAll('.departure-city').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    // Update state
    flightSearchState.departureCity = btn.dataset.city;
    flightSearchState.departureName = btn.dataset.name;

    // Update search links
    updateFlightLinks();

    // GA4 Tracking - City selection
    if (typeof gtag === 'function') {
        gtag('event', 'element_click', {
            'event_category': 'Flight Search',
            'event_label': 'City Selection',
            'city_code': btn.dataset.city,
            'city_name': btn.dataset.name
        });
    }

    console.log('üìä Tracking: city_select -', btn.dataset.name);
}

// ========================================
// OPEN SKYSCANNER (pre-filled search)
// ========================================
function openGoogleFlights(event) {
    event.preventDefault();

    // Get current values fresh from DOM
    const from = flightSearchState.departureCity.toLowerCase();
    const depDate = document.getElementById('flight-departure-date').value;
    const retDate = document.getElementById('flight-return-date').value;

    // Update state
    flightSearchState.departureDate = depDate;
    flightSearchState.returnDate = retDate;

    // Format dates for Skyscanner: YYMMDD
    const depParts = depDate.split('-'); // 2025-12-18 -> ['2025', '12', '18']
    const retParts = retDate.split('-');
    const depFormatted = depParts[0].slice(2) + depParts[1] + depParts[2]; // 251218
    const retFormatted = retParts[0].slice(2) + retParts[1] + retParts[2]; // 251225

    // Skyscanner URL format: /trasporti/voli/ORIGIN/DEST/YYMMDD/YYMMDD/
    const skyscannerUrl = `https://www.skyscanner.it/trasporti/voli/${from}/tia/${depFormatted}/${retFormatted}/`;

    console.log('üõ´ Opening Skyscanner:', {
        from: from,
        departure: depDate,
        return: retDate,
        url: skyscannerUrl
    });

    // Track the click
    trackFlightSearch('skyscanner');

    // Open in new tab
    window.open(skyscannerUrl, '_blank');
}

// ========================================
// UPDATE FLIGHT LINKS (kept for compatibility)
// ========================================
function updateFlightLinks() {
    const from = flightSearchState.departureCity;
    const depDate = document.getElementById('flight-departure-date').value;
    const retDate = document.getElementById('flight-return-date').value;

    flightSearchState.departureDate = depDate;
    flightSearchState.returnDate = retDate;
}

// ========================================
// TRACKING
// ========================================
function trackFlightSearch(platform) {
    // GA4 Tracking - Flight search outbound click
    if (typeof gtag === 'function') {
        gtag('event', 'outbound_click', {
            'event_category': 'Flight Search',
            'event_label': platform,
            'platform': platform,
            'departure_city': flightSearchState.departureCity,
            'departure_city_name': flightSearchState.departureName,
            'departure_date': flightSearchState.departureDate,
            'return_date': flightSearchState.returnDate,
            'destination': 'TIA'
        });
    }

    // Meta Pixel - Search event (user is actively searching for flights)
    if (typeof fbq === 'function') {
        fbq('track', 'Search', {
            content_category: 'Flights',
            search_string: flightSearchState.departureName + ' to Tirana',
            departure_city: flightSearchState.departureCity,
            departure_date: flightSearchState.departureDate,
            return_date: flightSearchState.returnDate
        });
    }

    console.log('üìä Tracking: flight_search_click -', platform, flightSearchState);
}

// ========================================
// EVENT LISTENERS
// ========================================
// Date change handlers are now inline (onDepartureDateChange, onReturnDateChange)

// Close on Escape
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeFlightSearch();
    }
});

// Close on overlay click
document.getElementById('flight-search-overlay').addEventListener('click', function(e) {
    if (e.target === this) {
        closeFlightSearch();
    }
});

console.log('‚úÖ Flight Search initialized');
</script>

<!-- ============================================== -->
<!-- STEP 3: BOOKING/PRENOTAZIONE MODAL -->
<!-- ============================================== -->
<div class="booking-overlay" id="booking-overlay">
    <div class="booking-modal">
        <button class="booking-close-btn" onclick="closeBookingModal()">
            <i class="fas fa-times"></i>
        </button>

        <!-- Header -->
        <div class="booking-header">
            <div class="booking-icon">
                <i class="fas fa-calendar-check"></i>
            </div>
            <h2>R√©servez Votre Traitement</h2>
            <p class="booking-subtitle">Confirm with the coordination service and you will be contacted by the clinic</p>
        </div>

        <!-- Clinic Info -->
        <div class="booking-clinic-info">
            <div class="clinic-recipient">
                <i class="fas fa-shield-alt"></i>
                <div>
                    <span class="clinic-label">Secure payment via:</span>
                    <span class="clinic-name-display">KLDA Technologies O√ú - San Marco Dental Partner</span>
                </div>
            </div>
        </div>

        <!-- Progress Steps -->
        <div class="booking-progress">
            <div class="progress-step active" data-step="1">
                <span class="step-num">1</span>
                <span class="step-label">Documents</span>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="2">
                <span class="step-num">2</span>
                <span class="step-label">Details</span>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="3">
                <span class="step-num">3</span>
                <span class="step-label">Payment</span>
            </div>
        </div>

        <!-- Step 1: Documents -->
        <div class="booking-step-content" id="booking-step-1">
            <!-- Quote Upload -->
            <div class="booking-section">
                <h3><i class="fas fa-file-medical"></i> Upload Your Quote <span style="font-size: 0.75rem; color: rgba(255,255,255,0.5); font-weight: normal;">(optional)</span></h3>
                <p class="section-hint">Upload the quote received from the clinic (PDF, JPG, PNG - max 10MB)</p>
                <div class="file-upload-zone" id="preventivo-upload-zone" onclick="document.getElementById('preventivo-file').click()">
                    <input type="file" id="preventivo-file" accept=".pdf,.jpg,.jpeg,.png" style="display:none" onchange="handleFileUpload('preventivo', this)">
                    <div class="upload-placeholder" id="preventivo-placeholder">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <span>Click or drag the file here</span>
                        <small>PDF, JPG, PNG - Max 10MB</small>
                    </div>
                    <div class="upload-preview" id="preventivo-preview" style="display:none">
                        <i class="fas fa-file-pdf"></i>
                        <span id="preventivo-filename"></span>
                        <button type="button" class="remove-file-btn" onclick="event.stopPropagation(); removeFile('preventivo')">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Date Selection -->
            <div class="booking-section">
                <h3><i class="fas fa-calendar-alt"></i> Treatment Dates</h3>
                <div class="date-option-selector">
                    <label class="date-option">
                        <input type="radio" name="date-option" value="known" onchange="toggleDateInputs(true)">
                        <span class="option-box">
                            <i class="fas fa-calendar-check"></i>
                            I already have dates
                        </span>
                    </label>
                    <label class="date-option">
                        <input type="radio" name="date-option" value="tbd" checked onchange="toggleDateInputs(false)">
                        <span class="option-box">
                            <i class="fas fa-calendar-plus"></i>
                            To be arranged
                        </span>
                    </label>
                </div>
                <div class="date-inputs" id="date-inputs" style="display:none">
                    <div class="date-input-group">
                        <label><i class="fas fa-plane-arrival"></i> First Session</label>
                        <input type="date" id="booking-date-prima" class="booking-input">
                    </div>
                    <div class="date-input-group">
                        <label><i class="fas fa-plane-departure"></i> Second Session (optional)</label>
                        <input type="date" id="booking-date-seconda" class="booking-input">
                    </div>
                </div>
            </div>

            <!-- Flight Ticket Upload (Optional) -->
            <div class="booking-section">
                <h3><i class="fas fa-plane"></i> Flight Ticket <span class="optional">(Optional)</span></h3>
                <p class="section-hint">If you have already booked the flight, upload the confirmation</p>
                <div class="file-upload-zone file-upload-optional" id="flight-upload-zone" onclick="document.getElementById('flight-file').click()">
                    <input type="file" id="flight-file" accept=".pdf,.jpg,.jpeg,.png" style="display:none" onchange="handleFileUpload('flight', this)">
                    <div class="upload-placeholder" id="flight-placeholder">
                        <i class="fas fa-ticket-alt"></i>
                        <span>Upload flight confirmation (optional)</span>
                    </div>
                    <div class="upload-preview" id="flight-preview" style="display:none">
                        <i class="fas fa-file-alt"></i>
                        <span id="flight-filename"></span>
                        <button type="button" class="remove-file-btn" onclick="event.stopPropagation(); removeFile('flight')">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            </div>

            <button class="booking-next-btn" onclick="goToBookingStep(2)">
                Continue <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Step 2: Personal Data -->
        <div class="booking-step-content" id="booking-step-2" style="display:none">
            <div class="booking-section">
                <h3><i class="fas fa-user"></i> Donn√©es Personnelles</h3>

                <div class="booking-form-group">
                    <label>Nom Complet <span class="required">*</span></label>
                    <input type="text" id="booking-name" class="booking-input" placeholder="Jean Dupont" required oninput="updateBankReference()">
                </div>

                <div class="booking-form-row">
                    <div class="booking-form-group">
                        <label>Email <span class="required">*</span></label>
                        <input type="email" id="booking-email" class="booking-input" placeholder="jean@email.com" required>
                    </div>
                    <div class="booking-form-group">
                        <label>T√©l√©phone <span class="required">*</span></label>
                        <input type="tel" id="booking-phone" class="booking-input" placeholder="+33 6 12 34 56 78" required>
                    </div>
                </div>

                <div class="booking-form-group">
                    <label>Notes Suppl√©mentaires <span class="optional">(Optionnel)</span></label>
                    <textarea id="booking-notes" class="booking-input booking-textarea" placeholder="Toute demande ou information utile pour la clinique..."></textarea>
                </div>
            </div>

            <div class="booking-nav-buttons">
                <button class="booking-back-btn" onclick="goToBookingStep(1)">
                    <i class="fas fa-arrow-left"></i> Retour
                </button>
                <button class="booking-next-btn" onclick="goToBookingStep(3)">
                    Continuer <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>

        <!-- Step 3: Payment -->
        <div class="booking-step-content" id="booking-step-3" style="display:none">
            <!-- Deposit Amount - Editable -->
            <div class="booking-section">
                <h3><i class="fas fa-euro-sign"></i> Service de Coordination</h3>
                <div class="deposit-info-box">
                    <div class="deposit-amount">
                        <span class="deposit-label">Acompte de Service :</span>
                        <div class="deposit-input-wrapper">
                            <span class="currency-symbol">‚Ç¨</span>
                            <input type="number"
                                   id="deposit-amount-input"
                                   class="deposit-input"
                                   value="0"
                                   min="0"
                                   step="1"
                                   placeholder="0"
                                   onchange="updateDepositAmount(this.value)"
                                   oninput="updateDepositAmount(this.value)">
                        </div>
                    </div>
                    <p class="deposit-note">
                        <i class="fas fa-info-circle"></i>
                        L'acompte sera <strong>d√©duit du co√ªt total</strong> du traitement.
                    </p>
                    <p class="deposit-refund-note">
                        <i class="fas fa-undo-alt"></i>
                        Remboursable √† tout moment en cas d'annulation.
                    </p>
                    <p class="deposit-warning-note" id="deposit-warning" style="display: none;">
                        <i class="fas fa-lightbulb"></i>
                        Pour proc√©der au paiement, entrez un montant sup√©rieur √† 0‚Ç¨
                    </p>
                </div>
            </div>

            <!-- Payment Method Selection -->
            <div class="booking-section">
                <h3><i class="fas fa-credit-card"></i> Mode de Paiement</h3>
                <div class="payment-methods">
                    <label class="payment-method" onclick="selectPaymentMethod('card')">
                        <input type="radio" name="payment-method" value="card" checked>
                        <div class="payment-method-box">
                            <div class="method-icon">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <div class="method-info">
                                <span class="method-name">Carte de Cr√©dit/D√©bit</span>
                                <span class="method-desc">Paiement en ligne s√©curis√© via Wise</span>
                            </div>
                            <i class="fas fa-check-circle method-check"></i>
                        </div>
                    </label>
                    <label class="payment-method" onclick="selectPaymentMethod('bank')">
                        <input type="radio" name="payment-method" value="bank">
                        <div class="payment-method-box">
                            <div class="method-icon">
                                <i class="fas fa-university"></i>
                            </div>
                            <div class="method-info">
                                <span class="method-name">Virement Bancaire</span>
                                <span class="method-desc">Transfert direct sur le compte</span>
                            </div>
                            <i class="fas fa-check-circle method-check"></i>
                        </div>
                    </label>
                </div>
            </div>

            <!-- Bank Transfer Details -->
            <div class="payment-details" id="bank-details" style="display:none">
                <div class="bank-info-box">
                    <div class="payment-info-notice" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(59, 130, 246, 0.1)); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 12px; padding: 16px; margin-bottom: 20px;">
                        <p style="margin: 0; font-size: 14px; color: rgba(255,255,255,0.9); line-height: 1.6;">
                            <i class="fas fa-shield-alt" style="color: #10b981; margin-right: 8px;"></i>
                            <strong>Paiement s√©curis√© via KLDA Technologies O√ú</strong> - Partenaire officiel et repr√©sentant autoris√© de la clinique.
                            L'acompte pour le service de coordination comprend l'organisation compl√®te du voyage et sera d√©duit du traitement final :
                            coordination des rendez-vous, assistance √† l'arriv√©e et support complet pour votre voyage √† Tirana.
                        </p>
                    </div>
                    <h4><i class="fas fa-landmark"></i> Coordonn√©es Bancaires</h4>
                    <div class="bank-details-grid">
                        <div class="bank-detail">
                            <span class="detail-label">Titulaire du Compte :</span>
                            <span class="detail-value" id="bank-holder">KLDA Technologies O√ú</span>
                            <button class="copy-btn" onclick="copyToClipboard('bank-holder')"><i class="fas fa-copy"></i></button>
                        </div>
                        <div class="bank-detail">
                            <span class="detail-label">IBAN :</span>
                            <span class="detail-value" id="bank-iban">BE41 9055 2686 5510</span>
                            <button class="copy-btn" onclick="copyToClipboard('bank-iban')"><i class="fas fa-copy"></i></button>
                        </div>
                        <div class="bank-detail">
                            <span class="detail-label">BIC/SWIFT :</span>
                            <span class="detail-value" id="bank-swift">TRWIBEB1XXX</span>
                            <button class="copy-btn" onclick="copyToClipboard('bank-swift')"><i class="fas fa-copy"></i></button>
                        </div>
                        <div class="bank-detail">
                            <span class="detail-label">Banque :</span>
                            <span class="detail-value">Wise (Bruxelles, Belgique)</span>
                        </div>
                        <div class="bank-detail">
                            <span class="detail-label">R√©f√©rence :</span>
                            <span class="detail-value highlight" id="bank-reference">R√©servation ADC - [VOTRE NOM]</span>
                        </div>
                    </div>

                    <div class="bank-receipt-upload">
                        <h5><i class="fas fa-receipt"></i> T√©l√©charger le Re√ßu de Virement</h5>
                        <p class="section-hint">Apr√®s avoir effectu√© le virement, t√©l√©chargez le re√ßu pour confirmer</p>
                        <div class="file-upload-zone" id="receipt-upload-zone" onclick="document.getElementById('receipt-file').click()">
                            <input type="file" id="receipt-file" accept=".pdf,.jpg,.jpeg,.png" style="display:none" onchange="handleFileUpload('receipt', this)">
                            <div class="upload-placeholder" id="receipt-placeholder">
                                <i class="fas fa-file-invoice"></i>
                                <span>T√©l√©charger le re√ßu de virement</span>
                            </div>
                            <div class="upload-preview" id="receipt-preview" style="display:none">
                                <i class="fas fa-file-check"></i>
                                <span id="receipt-filename"></span>
                                <button type="button" class="remove-file-btn" onclick="event.stopPropagation(); removeFile('receipt')">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card Payment (Wise) -->
            <div class="payment-details" id="card-details" style="display:block">
                <div class="card-payment-box">
                    <div class="card-icons">
                        <i class="fab fa-cc-visa"></i>
                        <i class="fab fa-cc-mastercard"></i>
                        <i class="fab fa-cc-amex"></i>
                        <i class="fab fa-apple-pay"></i>
                        <i class="fab fa-google-pay"></i>
                    </div>
                    <p class="card-info">
                        <i class="fas fa-lock"></i>
                        Paiement s√©curis√© via KLDA Technologies O√ú, partenaire autoris√© de la clinique.
                        Vos donn√©es sont prot√©g√©es par le cryptage Wise.
                    </p>
                    <button class="wise-pay-btn" id="wise-pay-btn" onclick="initiateWisePayment()">
                        <i class="fas fa-lock"></i> Payer <span id="wise-amount-display">‚Ç¨0</span> par Carte
                    </button>
                    <p class="wise-note">Vous serez redirig√© vers la page de paiement s√©curis√©e Wise</p>

                    <!-- Payment confirmation checkbox -->
                    <div class="payment-confirmation-box" id="card-payment-confirmation" style="display:none; margin-top: 20px; padding: 15px; background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 12px;">
                        <label class="payment-confirm-checkbox" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                            <input type="checkbox" id="card-payment-completed" onchange="checkPaymentConfirmation()">
                            <span style="color: #10b981; font-weight: 500;">
                                <i class="fas fa-check-circle"></i> J'ai effectu√© le paiement par carte
                            </span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Legal Checkboxes -->
            <div class="booking-section legal-section">
                <label class="legal-checkbox">
                    <input type="checkbox" id="accept-terms" required>
                    <span class="checkmark"></span>
                    <span class="legal-text">
                        J'accepte les <a href="#" onclick="openLegalModal('terms')">Conditions G√©n√©rales</a> du service de r√©servation
                    </span>
                </label>
                <label class="legal-checkbox">
                    <input type="checkbox" id="accept-privacy" required>
                    <span class="checkmark"></span>
                    <span class="legal-text">
                        J'accepte la <a href="#" onclick="openLegalModal('privacy')">Politique de Confidentialit√©</a> et le traitement des donn√©es personnelles (RGPD)
                    </span>
                </label>
                <label class="legal-checkbox">
                    <input type="checkbox" id="accept-deposit" required>
                    <span class="checkmark"></span>
                    <span class="legal-text">
                        Je comprends que l'acompte pour le service de coordination confirme la r√©servation et sera d√©duit du co√ªt final du traitement
                    </span>
                </label>
                <p class="legal-warning-note" id="legal-warning" style="display: none;">
                    <i class="fas fa-exclamation-circle"></i>
                    Pour continuer, veuillez accepter toutes les conditions g√©n√©rales
                </p>
            </div>

            <!-- Facilitator Disclaimer -->
            <div class="facilitator-disclaimer">
                <i class="fas fa-info-circle"></i>
                <div>
                    <strong>Avis Important :</strong>
                    Ce site fonctionne comme facilitateur de r√©servations. Le paiement est effectu√©
                    directement √† <strong>San Marco Dental - Albanian Dental Clinic</strong>.
                    Nous ne g√©rons ni ne recevons de paiements au nom de la clinique.
                </div>
            </div>

            <div class="booking-nav-buttons">
                <button class="booking-back-btn" onclick="goToBookingStep(2)">
                    <i class="fas fa-arrow-left"></i> Retour
                </button>
                <button class="booking-submit-btn confirm-booking-btn disabled" id="submit-booking-btn" onclick="submitBooking()" disabled>
                    <i class="fas fa-check-circle"></i> Confirmer la R√©servation
                </button>
            </div>
        </div>

        <!-- Success Message (shown after submission) -->
        <div class="booking-success" id="booking-success" style="display:none">
            <div class="success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h3>R√©servation Envoy√©e !</h3>
            <p>Votre demande de r√©servation a √©t√© envoy√©e avec succ√®s.</p>
            <div class="success-next-steps">
                <h4>Prochaines √âtapes :</h4>
                <ul>
                    <li><i class="fas fa-check"></i> Vous recevrez un email de confirmation</li>
                    <li><i class="fas fa-check"></i> La clinique v√©rifiera le paiement</li>
                    <li><i class="fas fa-check"></i> Vous serez contact√© sous 24-48 heures</li>
                </ul>
            </div>
            <button class="booking-close-success-btn" onclick="closeBookingModal()">
                <i class="fas fa-times"></i> Fermer
            </button>
        </div>

        <!-- WhatsApp Help -->
        <div class="booking-help">
            <p><i class="fas fa-question-circle"></i> Besoin d'assistance ?</p>
            <a href="https://wa.me/37254450188?text=Hello!%20I%20need%20help%20with%20treatment%20booking." target="_blank" class="booking-whatsapp-btn" onclick="trackWhatsAppClick();">
                <i class="fab fa-whatsapp"></i> Contactez-Nous sur WhatsApp
            </a>
        </div>
    </div>
</div>

<!-- Booking Modal Styles -->
<style>
/* ========================================
   STEP 3: BOOKING MODAL STYLES
   ======================================== */
.booking-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 10000;
    overflow-y: auto;
    padding: 20px;
    box-sizing: border-box;
    backdrop-filter: blur(5px);
}

.booking-overlay.active {
    display: flex;
    justify-content: center;
    align-items: flex-start;
}

.booking-modal {
    background: linear-gradient(135deg, #1a365d 0%, #0f2744 100%);
    border-radius: 20px;
    width: 100%;
    max-width: 700px;
    margin: 20px auto;
    padding: 30px;
    position: relative;
    box-shadow: 0 25px 80px rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.booking-close-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: #fff;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 18px;
    transition: all 0.3s;
    z-index: 10;
}

.booking-close-btn:hover {
    background: rgba(255, 77, 77, 0.3);
    transform: rotate(90deg);
}

/* Header */
.booking-header {
    text-align: center;
    margin-bottom: 25px;
}

.booking-icon {
    width: 70px;
    height: 70px;
    background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 15px;
    font-size: 30px;
    color: #fff;
    box-shadow: 0 10px 30px rgba(34, 197, 94, 0.3);
}

.booking-header h2 {
    color: #fff;
    font-size: 1.8rem;
    margin: 0 0 10px;
}

.booking-subtitle {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.95rem;
    margin: 0;
}

/* Clinic Info */
.booking-clinic-info {
    margin-bottom: 25px;
}

.clinic-recipient {
    display: flex;
    align-items: center;
    gap: 12px;
    background: rgba(34, 197, 94, 0.1);
    border: 1px solid rgba(34, 197, 94, 0.3);
    border-radius: 12px;
    padding: 15px;
}

.clinic-recipient > i {
    font-size: 24px;
    color: #22c55e;
}

.clinic-label {
    display: block;
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.6);
}

.clinic-name-display {
    display: block;
    font-weight: 600;
    color: #fff;
}

/* Progress Steps */
.booking-progress {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-bottom: 30px;
    padding: 20px;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
}

.progress-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
}

.step-num {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    color: rgba(255, 255, 255, 0.5);
    transition: all 0.3s;
}

.progress-step.active .step-num {
    background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
    border-color: #22c55e;
    color: #fff;
    box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
}

.progress-step.completed .step-num {
    background: #22c55e;
    border-color: #22c55e;
    color: #fff;
}

.step-label {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.5);
}

.progress-step.active .step-label,
.progress-step.completed .step-label {
    color: #22c55e;
}

.progress-line {
    width: 50px;
    height: 2px;
    background: rgba(255, 255, 255, 0.1);
}

/* Sections */
.booking-section {
    margin-bottom: 25px;
}

.booking-section h3 {
    color: #fff;
    font-size: 1.1rem;
    margin: 0 0 12px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.booking-section h3 i {
    color: #22c55e;
}

.required {
    color: #ef4444;
    font-size: 0.9rem;
}

.optional {
    color: rgba(255, 255, 255, 0.5);
    font-weight: 400;
    font-size: 0.85rem;
}

.section-hint {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.85rem;
    margin: 0 0 12px;
}

/* File Upload */
.file-upload-zone {
    border: 2px dashed rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    padding: 30px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
    background: rgba(255, 255, 255, 0.02);
}

.file-upload-zone:hover {
    border-color: #22c55e;
    background: rgba(34, 197, 94, 0.05);
}

.file-upload-zone.file-upload-optional {
    padding: 20px;
}

.file-upload-zone.has-file {
    border-color: #22c55e;
    background: rgba(34, 197, 94, 0.1);
}

.upload-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    color: rgba(255, 255, 255, 0.6);
}

.upload-placeholder i {
    font-size: 2.5rem;
    color: rgba(255, 255, 255, 0.3);
}

.upload-placeholder small {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.4);
}

.upload-preview {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    color: #22c55e;
}

.upload-preview i {
    font-size: 1.5rem;
}

.remove-file-btn {
    background: rgba(239, 68, 68, 0.2);
    border: none;
    color: #ef4444;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.3s;
}

.remove-file-btn:hover {
    background: rgba(239, 68, 68, 0.4);
}

/* Date Options */
.date-option-selector {
    display: flex;
    gap: 15px;
    margin-bottom: 15px;
}

.date-option {
    flex: 1;
    cursor: pointer;
}

.date-option input {
    display: none;
}

.option-box {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    padding: 15px;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    color: rgba(255, 255, 255, 0.7);
    transition: all 0.3s;
}

.date-option input:checked + .option-box {
    background: rgba(34, 197, 94, 0.1);
    border-color: #22c55e;
    color: #fff;
}

.date-inputs {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

.date-input-group label {
    display: block;
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.85rem;
    margin-bottom: 8px;
}

/* Form Inputs */
.booking-input {
    width: 100%;
    padding: 14px 16px;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    color: #fff;
    font-size: 1rem;
    transition: all 0.3s;
    box-sizing: border-box;
}

.booking-input:focus {
    outline: none;
    border-color: #22c55e;
    background: rgba(255, 255, 255, 0.08);
}

.booking-input::placeholder {
    color: rgba(255, 255, 255, 0.4);
}

.booking-textarea {
    min-height: 100px;
    resize: vertical;
}

.booking-form-group {
    margin-bottom: 15px;
}

.booking-form-group label {
    display: block;
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.9rem;
    margin-bottom: 8px;
}

.booking-form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

/* Deposit Box */
.deposit-info-box {
    background: linear-gradient(135deg, rgba(34, 197, 94, 0.15) 0%, rgba(22, 163, 74, 0.15) 100%);
    border: 2px solid rgba(34, 197, 94, 0.3);
    border-radius: 15px;
    padding: 20px;
}

.deposit-amount {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.deposit-label {
    color: rgba(255, 255, 255, 0.8);
    font-size: 1rem;
}

.deposit-value {
    font-size: 2rem;
    font-weight: 700;
    color: #22c55e;
}

.deposit-note {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.85rem;
    margin: 0;
    display: flex;
    gap: 10px;
}

.deposit-note i {
    color: #22c55e;
    margin-top: 3px;
}

/* Deposit Input Field */
.deposit-input-wrapper {
    display: flex;
    align-items: center;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(34, 197, 94, 0.4);
    border-radius: 8px;
    padding: 5px 12px;
    transition: all 0.3s ease;
}

.deposit-input-wrapper:focus-within {
    border-color: #22c55e;
    box-shadow: 0 0 10px rgba(34, 197, 94, 0.3);
}

.deposit-input-wrapper .currency-symbol {
    color: #22c55e;
    font-size: 1.5rem;
    font-weight: 700;
    margin-right: 5px;
}

.deposit-input {
    background: transparent;
    border: none;
    color: #22c55e;
    font-size: 1.5rem;
    font-weight: 700;
    width: 80px;
    text-align: left;
    outline: none;
}

.deposit-input::-webkit-outer-spin-button,
.deposit-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

.deposit-input[type=number] {
    -moz-appearance: textfield;
}

.deposit-refund-note {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.8rem;
    margin: 8px 0 0 0;
    display: flex;
    gap: 8px;
    font-style: italic;
}

.deposit-refund-note i {
    color: #60a5fa;
    margin-top: 2px;
}

.deposit-warning-note {
    color: #d97706;
    font-size: 0.85rem;
    margin: 12px 0 0 0;
    padding: 10px 14px;
    background: rgba(217, 119, 6, 0.1);
    border-left: 3px solid #d97706;
    border-radius: 0 8px 8px 0;
    display: flex;
    align-items: center;
    gap: 10px;
    animation: fadeInWarning 0.3s ease;
}

.deposit-warning-note i {
    color: #f59e0b;
    font-size: 1rem;
}

@keyframes fadeInWarning {
    from {
        opacity: 0;
        transform: translateY(-5px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.legal-warning-note {
    color: #d97706;
    font-size: 0.85rem;
    margin: 12px 0 0 0;
    padding: 10px 14px;
    background: rgba(217, 119, 6, 0.1);
    border-left: 3px solid #d97706;
    border-radius: 0 8px 8px 0;
    display: flex;
    align-items: center;
    gap: 10px;
    animation: fadeInWarning 0.3s ease;
}

.legal-warning-note i {
    color: #f59e0b;
    font-size: 1rem;
}

/* Payment Methods */
.payment-methods {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.payment-method {
    cursor: pointer;
}

.payment-method input {
    display: none;
}

.payment-method-box {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 18px;
    background: rgba(255, 255, 255, 0.03);
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    transition: all 0.3s;
}

.payment-method input:checked + .payment-method-box {
    background: rgba(34, 197, 94, 0.1);
    border-color: #22c55e;
}

.method-icon {
    width: 50px;
    height: 50px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: rgba(255, 255, 255, 0.6);
}

.payment-method input:checked + .payment-method-box .method-icon {
    background: rgba(34, 197, 94, 0.2);
    color: #22c55e;
}

.method-info {
    flex: 1;
}

.method-name {
    display: block;
    color: #fff;
    font-weight: 600;
    margin-bottom: 3px;
}

.method-desc {
    display: block;
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.85rem;
}

.method-check {
    color: rgba(255, 255, 255, 0.2);
    font-size: 1.3rem;
}

.payment-method input:checked + .payment-method-box .method-check {
    color: #22c55e;
}

/* Bank Details */
.bank-info-box {
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    padding: 20px;
    margin-top: 20px;
}

.bank-info-box h4 {
    color: #fff;
    font-size: 1rem;
    margin: 0 0 20px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.bank-info-box h4 i {
    color: #22c55e;
}

.bank-details-grid {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.bank-detail {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 15px;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 8px;
}

.detail-label {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.85rem;
    min-width: 100px;
}

.detail-value {
    color: #fff;
    font-family: monospace;
    font-size: 0.95rem;
    flex: 1;
}

.detail-value.highlight {
    color: #22c55e;
    font-family: inherit;
}

.copy-btn {
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: rgba(255, 255, 255, 0.6);
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s;
}

.copy-btn:hover {
    background: rgba(34, 197, 94, 0.2);
    color: #22c55e;
}

.bank-receipt-upload {
    margin-top: 25px;
    padding-top: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.bank-receipt-upload h5 {
    color: #fff;
    font-size: 1rem;
    margin: 0 0 8px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.bank-receipt-upload h5 i {
    color: #22c55e;
}

/* Card Payment */
.card-payment-box {
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    padding: 25px;
    text-align: center;
    margin-top: 20px;
}

.card-icons {
    display: flex;
    justify-content: center;
    gap: 15px;
    font-size: 2rem;
    color: rgba(255, 255, 255, 0.5);
    margin-bottom: 20px;
}

.card-info {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.9rem;
    margin-bottom: 20px;
}

.card-info i {
    color: #22c55e;
    margin-right: 5px;
}

.wise-pay-btn {
    width: 100%;
    padding: 16px;
    background: linear-gradient(135deg, #9fe870 0%, #37d058 100%);
    border: none;
    border-radius: 10px;
    color: #163300;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.wise-pay-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(55, 208, 88, 0.4);
}

.wise-note {
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.8rem;
    margin-top: 12px;
}

.confirm-booking-btn.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
}

/* Legal Checkboxes */
.legal-section {
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    padding: 20px;
}

.legal-checkbox {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    margin-bottom: 12px;
    cursor: pointer;
}

.legal-checkbox:last-child {
    margin-bottom: 0;
}

.legal-checkbox input {
    display: none;
}

.checkmark {
    width: 22px;
    height: 22px;
    min-width: 22px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 5px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
}

.legal-checkbox input:checked + .checkmark {
    background: #22c55e;
    border-color: #22c55e;
}

.legal-checkbox input:checked + .checkmark::after {
    content: '‚úì';
    color: #fff;
    font-weight: 700;
}

.legal-text {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.85rem;
    line-height: 1.4;
}

.legal-text a {
    color: #22c55e;
    text-decoration: underline;
}

/* Facilitator Disclaimer */
.facilitator-disclaimer {
    display: flex;
    gap: 12px;
    padding: 15px;
    background: rgba(234, 179, 8, 0.1);
    border: 1px solid rgba(234, 179, 8, 0.3);
    border-radius: 10px;
    margin: 20px 0;
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.85rem;
}

.facilitator-disclaimer > i {
    color: #eab308;
    font-size: 1.2rem;
    margin-top: 2px;
}

.facilitator-disclaimer strong {
    color: #eab308;
}

/* Navigation Buttons */
.booking-nav-buttons {
    display: flex;
    gap: 15px;
    margin-top: 25px;
}

.booking-back-btn {
    flex: 1;
    padding: 14px;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    color: rgba(255, 255, 255, 0.7);
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.booking-back-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.2);
}

.booking-next-btn {
    flex: 2;
    padding: 14px;
    background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
    border: none;
    border-radius: 10px;
    color: #fff;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.booking-next-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(34, 197, 94, 0.4);
}

.booking-submit-btn {
    flex: 2;
    padding: 16px;
    background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
    border: none;
    border-radius: 10px;
    color: #fff;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.booking-submit-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(34, 197, 94, 0.4);
}

.booking-submit-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

/* Success State */
.booking-success {
    text-align: center;
    padding: 40px 20px;
}

.success-icon {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 20px;
    font-size: 40px;
    color: #fff;
    animation: successPulse 0.5s ease-out;
}

@keyframes successPulse {
    0% { transform: scale(0); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

.booking-success h3 {
    color: #22c55e;
    font-size: 1.8rem;
    margin: 0 0 10px;
}

.booking-success > p {
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 25px;
}

.success-next-steps {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 20px;
    text-align: left;
    margin-bottom: 25px;
}

.success-next-steps h4 {
    color: #fff;
    margin: 0 0 15px;
}

.success-next-steps ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.success-next-steps li {
    color: rgba(255, 255, 255, 0.8);
    padding: 8px 0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.success-next-steps li i {
    color: #22c55e;
}

.booking-close-success-btn {
    padding: 14px 30px;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    color: #fff;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s;
}

.booking-close-success-btn:hover {
    background: rgba(255, 255, 255, 0.15);
}

/* Help Section */
.booking-help {
    text-align: center;
    padding-top: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    margin-top: 20px;
}

.booking-help > p {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.9rem;
    margin: 0 0 12px;
}

.booking-whatsapp-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 12px 25px;
    background: #25D366;
    border-radius: 30px;
    color: #fff;
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s;
}

.booking-whatsapp-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4);
}

/* Responsive */
@media (max-width: 768px) {
    .booking-modal {
        padding: 20px;
        margin: 10px;
    }

    .booking-form-row,
    .date-inputs {
        grid-template-columns: 1fr;
    }

    .date-option-selector {
        flex-direction: column;
    }

    .booking-nav-buttons {
        flex-direction: column;
    }

    .booking-back-btn,
    .booking-next-btn,
    .booking-submit-btn {
        flex: none;
        width: 100%;
    }

    .booking-progress {
        flex-wrap: wrap;
        gap: 15px;
    }

    .progress-line {
        display: none;
    }

    .bank-detail {
        flex-wrap: wrap;
    }

    .detail-label {
        width: 100%;
        min-width: auto;
    }
}
</style>

<!-- Booking Modal JavaScript -->
<script>
// ========================================
// STEP 3: BOOKING MODAL FUNCTIONALITY
// ========================================

// State
let bookingState = {
    currentStep: 1,
    files: {
        preventivo: null,
        flight: null,
        receipt: null
    },
    paymentMethod: 'card',
    depositAmount: 0
};

// ========================================
// MODAL FUNCTIONS
// ========================================
function openBookingModal() {
    console.log('üîµ openBookingModal() called');
    const overlay = document.getElementById('booking-overlay');
    if (!overlay) {
        console.error('‚ùå booking-overlay element not found!');
        return;
    }
    overlay.classList.add('active');
    console.log('‚úÖ booking-overlay active class added');
    document.body.style.overflow = 'hidden';
    resetBookingForm();

    // GA4 Tracking - popup_open event
    if (typeof gtag === 'function') {
        gtag('event', 'popup_open', {
            'event_category': 'Modal',
            'event_label': 'Booking',
            'modal_name': 'booking',
            'step': 3
        });

        // Track form_start event (booking funnel)
        gtag('event', 'form_start', {
            'event_category': 'Booking',
            'form_name': 'Booking Form',
            'step': 3
        });
    }

    // Meta Pixel - InitiateCheckout (booking is like checkout)
    if (typeof fbq === 'function') {
        fbq('track', 'InitiateCheckout', {
            content_name: 'Booking Form',
            content_category: 'Step 3 - Booking',
            value: 100,
            currency: 'EUR'
        });
    }

    console.log('üìä Tracking: popup_open - Booking Modal');
}

function closeBookingModal() {
    document.getElementById('booking-overlay').classList.remove('active');
    document.body.style.overflow = '';

    // GA4 Tracking - popup_close event
    if (typeof gtag === 'function') {
        gtag('event', 'popup_close', {
            'event_category': 'Modal',
            'event_label': 'Booking',
            'modal_name': 'booking',
            'step': 3,
            'booking_step_reached': bookingState.currentStep,
            'has_preventivo': !!bookingState.files.preventivo,
            'has_flight': !!bookingState.files.flight
        });
    }

    console.log('üìä Tracking: popup_close - Booking Modal');
}

function resetBookingForm() {
    bookingState = {
        currentStep: 1,
        files: { preventivo: null, flight: null, receipt: null },
        paymentMethod: 'card',
        depositAmount: 0
    };

    // Reset deposit amount input
    const depositInput = document.getElementById('deposit-amount-input');
    if (depositInput) depositInput.value = 0;
    currentDepositAmount = 0;
    updateDepositAmount(0);

    // Reset steps
    goToBookingStep(1);

    // Reset file uploads
    ['preventivo', 'flight', 'receipt'].forEach(type => {
        document.getElementById(`${type}-placeholder`).style.display = 'flex';
        document.getElementById(`${type}-preview`).style.display = 'none';
        document.getElementById(`${type}-file`).value = '';
        document.getElementById(`${type}-upload-zone`).classList.remove('has-file');
    });

    // Reset form inputs
    document.getElementById('booking-name').value = '';
    document.getElementById('booking-email').value = '';
    document.getElementById('booking-phone').value = '';
    document.getElementById('booking-notes').value = '';

    // Reset checkboxes
    document.getElementById('accept-terms').checked = false;
    document.getElementById('accept-privacy').checked = false;
    document.getElementById('accept-deposit').checked = false;

    // Hide legal warning
    const legalWarningEl = document.getElementById('legal-warning');
    if (legalWarningEl) legalWarningEl.style.display = 'none';

    // Reset date option
    document.querySelector('input[name="date-option"][value="tbd"]').checked = true;
    toggleDateInputs(false);

    // Hide success
    document.getElementById('booking-success').style.display = 'none';
    document.querySelectorAll('.booking-step-content').forEach(el => el.style.display = 'none');
    document.getElementById('booking-step-1').style.display = 'block';
}

// ========================================
// STEP NAVIGATION
// ========================================
function goToBookingStep(step) {
    // Validation before moving forward
    if (step > bookingState.currentStep) {
        if (!validateCurrentStep()) return;
    }

    // PARTIAL LEAD CAPTURE: When moving from Step 2 to Step 3, send partial lead to CRM
    // This captures contact info even if user abandons before completing payment
    if (bookingState.currentStep === 2 && step === 3) {
        sendPartialLeadToCRM();
    }

    bookingState.currentStep = step;

    // Update progress indicators
    document.querySelectorAll('.progress-step').forEach((el, idx) => {
        el.classList.remove('active', 'completed');
        if (idx + 1 < step) el.classList.add('completed');
        if (idx + 1 === step) el.classList.add('active');
    });

    // Show correct content
    document.querySelectorAll('.booking-step-content').forEach(el => el.style.display = 'none');
    document.getElementById(`booking-step-${step}`).style.display = 'block';

    // Scroll to top of modal
    document.querySelector('.booking-modal').scrollTop = 0;

    // GA4 Tracking - step progression
    const stepNames = { 1: 'Documents', 2: 'Personal Data', 3: 'Payment' };
    if (typeof gtag === 'function') {
        gtag('event', 'booking_step_view', {
            'event_category': 'Booking',
            'event_label': stepNames[step],
            'step_number': step,
            'step_name': stepNames[step]
        });
    }

    // Meta Pixel - Custom event for booking progress
    if (typeof fbq === 'function') {
        fbq('trackCustom', 'BookingStep', {
            step_number: step,
            step_name: stepNames[step],
            content_category: 'Booking Progress'
        });
    }

    console.log('üìä Tracking: booking_step_view - Step', step, stepNames[step]);
}

// ========================================
// PARTIAL LEAD CAPTURE (Step 2 ‚Üí Step 3)
// ========================================
async function sendPartialLeadToCRM() {
    const fullName = document.getElementById('booking-name').value.trim();
    const nameParts = fullName.split(' ');
    const nome = nameParts[0] || '';
    const cognome = nameParts.slice(1).join(' ') || '';
    const email = document.getElementById('booking-email').value.trim();
    const phone = document.getElementById('booking-phone').value.trim();
    const notes = document.getElementById('booking-notes').value.trim();
    const dateOption = document.querySelector('input[name="date-option"]:checked').value;

    // Mark that partial lead was sent (to avoid duplicate if they complete)
    if (bookingState.partialLeadSent) {
        console.log('‚ÑπÔ∏è Partial lead already sent, skipping...');
        return;
    }

    // ========================================
    // 1. GA4 - generate_lead event
    // ========================================
    if (typeof gtag === 'function') {
        gtag('event', 'generate_lead', {
            'event_category': 'Booking',
            'event_label': 'Partial Lead - Step 2 Completed',
            'value': 50,
            'currency': 'EUR',
            'lead_source': 'booking_modal',
            'lead_type': 'partial'
        });
        console.log('üìä GA4: generate_lead event sent');
    }

    // ========================================
    // 2. Google Ads - Conversion tracking with Enhanced Conversions
    // ========================================
    if (typeof gtag === 'function') {
        // Set Enhanced Conversion user data
        const enhancedConversionData = {
            'email': email ? email.toLowerCase().trim() : '',
            'phone_number': phone ? phone.replace(/[^0-9+]/g, '') : '',
            'address': {
                'first_name': nome ? nome.toLowerCase().trim() : '',
                'last_name': cognome ? cognome.toLowerCase().trim() : '',
                'country': 'IT'
            }
        };

        gtag('set', 'user_data', enhancedConversionData);
        console.log('üìä Enhanced conversion user_data set:', enhancedConversionData);
        // Google Ads receives conversion data via GA4 import (generate_lead event above)
    }

    // ========================================
    // 3. Meta Pixel - Lead standard event (browser-side)
    // ========================================
    if (typeof fbq === 'function') {
        fbq('track', 'Lead', {
            content_name: 'Booking Partial Lead',
            content_category: 'Dental Treatment Booking',
            value: 50.00,
            currency: 'EUR',
            lead_type: 'partial',
            step_completed: 2
        });
        console.log('üìä Meta Pixel: Lead event sent');
    }

    // ========================================
    // 4. Meta CAPI - Server-side Lead event
    // ========================================
    sendMetaCAPI({
        event_name: 'Lead',
        event_time: Math.floor(Date.now() / 1000),
        user_data: {
            em: email ? await hashSHA256(email.toLowerCase()) : null,
            ph: phone ? await hashSHA256(phone.replace(/[^0-9]/g, '')) : null,
            fn: nome ? await hashSHA256(nome.toLowerCase()) : null,
            ln: cognome ? await hashSHA256(cognome.toLowerCase()) : null,
            client_ip_address: null, // Will be added server-side
            client_user_agent: navigator.userAgent,
            fbc: getCookie('_fbc') || null,
            fbp: getCookie('_fbp') || null
        },
        custom_data: {
            content_name: 'Booking Partial Lead',
            content_category: 'Dental Treatment Booking',
            value: 50.00,
            currency: 'EUR',
            lead_type: 'partial',
            step_completed: 2
        },
        event_source_url: window.location.href,
        action_source: 'website'
    });

    try {
        const partialPayload = {
            api_key: '6fcfcf06-ba40-4d00-857e-2e684ebc09fc',
            campaign_type: 'fissa',
            platform: 'landing-page',
            source_page_index: 'https://albaniandentalclinic.com/booking-partial',
            leads: [{
                nome: nome,
                cognome: cognome,
                telefono: phone,
                email: email,
                trattamento: 'Prenotazione Trattamento',
                interesse_livello: 'MEDIO',
                come_conosce: 'Landing Page Booking - PARTIAL',
                booking_type: 'partial_booking',
                date_option: dateOption,
                note_cliente: notes,
                abandoned_at_step: 3
            }]
        };

        console.log('üì§ Sending PARTIAL lead to CRM (Step 2 completed):', partialPayload);

        const response = await fetch('https://crm.clinicadentalealbania.it/api/v1/leads/import', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-API-Key': '6fcfcf06-ba40-4d00-857e-2e684ebc09fc'
            },
            body: JSON.stringify(partialPayload)
        });

        const result = await response.json();

        if (response.ok && result.success) {
            console.log('‚úÖ Partial lead sent to CRM:', result);
            bookingState.partialLeadSent = true;
        } else {
            console.error('‚ö†Ô∏è CRM partial lead error:', result);
        }
    } catch (error) {
        console.error('‚ùå Error sending partial lead to CRM:', error);
    }
}

// ========================================
// META CAPI - Server-side Conversions API
// ========================================
async function sendMetaCAPI(eventData) {
    const PIXEL_ID = '1140066248291201';
    const ACCESS_TOKEN = 'EAALp5IHZAlIkBP0fMzrisRb45N9D4sAZCYPITH21IfGxYbQ1v30IlfsLeCeysWaAGswOZB4idHzRZA90k9BpvQyz5FrstjZBYRDeSdWGZCTQmxGAj2OvO9ZBH97Jhdqv1wW8kZBqTy3BZAglBHU4ZB3gBZAhyyZBdI5C63SwgMBZAOk9kGRmPsfQoJv5q1hLYfzxMmQZDZD';

    // Generate event_id for deduplication with browser pixel
    const eventId = 'cda_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);

    const payload = {
        data: [{
            event_name: eventData.event_name,
            event_time: eventData.event_time,
            event_id: eventId,
            event_source_url: eventData.event_source_url,
            action_source: eventData.action_source,
            user_data: eventData.user_data,
            custom_data: eventData.custom_data
        }]
        // Note: Remove test_event_code for production
        // test_event_code: 'TEST12345'
    };

    try {
        const response = await fetch(`https://graph.facebook.com/v18.0/${PIXEL_ID}/events?access_token=${ACCESS_TOKEN}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(payload)
        });

        const result = await response.json();

        if (response.ok) {
            console.log('‚úÖ Meta CAPI: Event sent successfully', result);
        } else {
            console.error('‚ö†Ô∏è Meta CAPI error:', result);
        }

        return result;
    } catch (error) {
        console.error('‚ùå Meta CAPI fetch error:', error);
        return null;
    }
}

// ========================================
// UTILITY: SHA-256 Hashing for CAPI
// ========================================
async function hashSHA256(value) {
    if (!value) return null;
    const encoder = new TextEncoder();
    const data = encoder.encode(value);
    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
}

// ========================================
// UTILITY: Get Cookie Value
// ========================================
function getCookie(name) {
    const value = `; ${document.cookie}`;
    const parts = value.split(`; ${name}=`);
    if (parts.length === 2) return parts.pop().split(';').shift();
    return null;
}

// ========================================
// COMPLIANCE SYSTEM - BOOKING & INVOICING
// ========================================

// KLDA Company Details (for invoices and compliance)
const KLDA_COMPANY = {
    name: 'KLDA Technologies O√ú',
    regNumber: '17270421',
    vatNumber: 'EE102875308',
    address: 'Sepapaja tn 6, Lasnam√§e district, Tallinn, Harju county, 15551',
    country: 'Estonia',
    email: 'info@kldatechnologies.com',
    phone: '+372 5445 0188',
    bank: 'Wise',
    bankAddress: 'Rue du Tr√¥ne 100, 3rd floor, Brussels, 1050, Belgium',
    iban: 'BE41 9055 2686 5510',
    bic: 'TRWIBEB1XXX',
    website: 'https://clinicadentalealbania.it'
};

// Generate unique booking ID
function generateBookingId() {
    const date = new Date();
    const year = date.getFullYear().toString().slice(-2);
    const month = (date.getMonth() + 1).toString().padStart(2, '0');
    const random = Math.random().toString(36).substring(2, 8).toUpperCase();
    return `ADC-${year}${month}-${random}`;
}

// Generate invoice number
function generateInvoiceNumber() {
    const date = new Date();
    const year = date.getFullYear();
    const sequence = Date.now().toString().slice(-6);
    return `INV-${year}-${sequence}`;
}

// Format date for Italian display
function formatDateIT(date) {
    const d = new Date(date);
    return d.toLocaleDateString('it-IT', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric'
    });
}

// Generate payment reference (causale) for bank transfers
function generatePaymentReference(bookingId, customerName) {
    return `Acconto servizio coordinamento ${bookingId} - ${customerName}`;
}

// Generate Stripe statement descriptor (max 22 chars, appears on card statement)
function getStripeStatementDescriptor(bookingId) {
    // Format: "ADC DENTAL [ID]" - what customer sees on their credit card statement
    return `ADC DENTAL ${bookingId.slice(-8)}`;
}

// ========================================
// INVOICE/RECEIPT GENERATOR
// ========================================
function generateInvoiceHTML(bookingData) {
    const invoiceNumber = generateInvoiceNumber();
    const bookingId = bookingData.bookingId;
    const today = formatDateIT(new Date());

    return `
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Booking Receipt ${bookingId}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Arial, sans-serif; font-size: 14px; color: #333; padding: 40px; max-width: 800px; margin: 0 auto; }
        .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 40px; padding-bottom: 20px; border-bottom: 2px solid #10b981; }
        .logo-section h1 { color: #10b981; font-size: 24px; margin-bottom: 5px; }
        .logo-section p { color: #666; font-size: 12px; }
        .invoice-info { text-align: right; }
        .invoice-info h2 { color: #1e40af; font-size: 28px; margin-bottom: 10px; }
        .invoice-info p { color: #666; margin: 3px 0; }
        .parties { display: flex; justify-content: space-between; margin-bottom: 40px; }
        .party { width: 45%; }
        .party h3 { color: #1e40af; font-size: 14px; text-transform: uppercase; margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px solid #e5e7eb; }
        .party p { margin: 4px 0; line-height: 1.5; }
        .details-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
        .details-table th { background: #1e40af; color: white; padding: 12px 15px; text-align: left; font-weight: 600; }
        .details-table td { padding: 12px 15px; border-bottom: 1px solid #e5e7eb; }
        .details-table tr:nth-child(even) { background: #f9fafb; }
        .amount-row td { font-weight: bold; font-size: 16px; }
        .total-section { text-align: right; margin-top: 20px; padding: 20px; background: linear-gradient(135deg, #10b981, #059669); color: white; border-radius: 8px; }
        .total-section .label { font-size: 14px; opacity: 0.9; }
        .total-section .amount { font-size: 32px; font-weight: bold; }
        .notes { background: #f0fdf4; border: 1px solid #10b981; border-radius: 8px; padding: 20px; margin: 30px 0; }
        .notes h4 { color: #10b981; margin-bottom: 10px; }
        .notes ul { margin-left: 20px; }
        .notes li { margin: 8px 0; line-height: 1.5; }
        .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #e5e7eb; text-align: center; color: #666; font-size: 12px; }
        .footer p { margin: 5px 0; }
        .stamp { background: #fef3c7; border: 2px dashed #f59e0b; padding: 15px; text-align: center; margin: 20px 0; border-radius: 8px; }
        .stamp strong { color: #b45309; }
        @media print { body { padding: 20px; } }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo-section">
            <h1>KLDA Technologies O√ú</h1>
            <p>Official Partner - Albanian Dental Clinic</p>
            <p>Dental Tourism Coordination Services</p>
        </div>
        <div class="invoice-info">
            <h2>RECEIPT</h2>
            <p><strong>No.:</strong> ${invoiceNumber}</p>
            <p><strong>Date:</strong> ${today}</p>
            <p><strong>Booking:</strong> ${bookingId}</p>
        </div>
    </div>

    <div class="parties">
        <div class="party">
            <h3>Issuer</h3>
            <p><strong>${KLDA_COMPANY.name}</strong></p>
            <p>Reg. Nr: ${KLDA_COMPANY.regNumber}</p>
            ${KLDA_COMPANY.vatNumber ? `<p>VAT: ${KLDA_COMPANY.vatNumber}</p>` : ''}
            <p>${KLDA_COMPANY.address}</p>
            <p>${KLDA_COMPANY.country}</p>
            <p>Email: ${KLDA_COMPANY.email}</p>
        </div>
        <div class="party">
            <h3>Customer</h3>
            <p><strong>${bookingData.name}</strong></p>
            <p>Email: ${bookingData.email}</p>
            <p>Tel: ${bookingData.phone}</p>
            ${bookingData.codiceFiscale ? `<p>Tax ID: ${bookingData.codiceFiscale}</p>` : ''}
        </div>
    </div>

    <table class="details-table">
        <thead>
            <tr>
                <th>Description</th>
                <th>Details</th>
                <th style="text-align: right;">Amount</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><strong>Dental Travel Coordination Service</strong></td>
                <td>Complete travel organization and clinic booking</td>
                <td style="text-align: right;">‚Ç¨100.00</td>
            </tr>
            <tr>
                <td>Flight Booking Assistance</td>
                <td>Search and coordination of round-trip flights</td>
                <td style="text-align: right;">Included</td>
            </tr>
            <tr>
                <td>Airport Transfer</td>
                <td>Transportation coordination for arrival/departure in Tirana</td>
                <td style="text-align: right;">Included</td>
            </tr>
            <tr>
                <td>Clinic Booking</td>
                <td>Organization of dental treatment appointments</td>
                <td style="text-align: right;">Included</td>
            </tr>
            <tr>
                <td>Dedicated Support</td>
                <td>Assistance before/during/after the trip</td>
                <td style="text-align: right;">Included</td>
            </tr>
            <tr class="amount-row">
                <td colspan="2"><strong>TOTAL PAID</strong></td>
                <td style="text-align: right;"><strong>‚Ç¨100.00</strong></td>
            </tr>
        </tbody>
    </table>

    <div class="total-section">
        <div class="label">Amount Paid</div>
        <div class="amount">‚Ç¨100.00</div>
        <div class="label" style="margin-top: 5px;">Method: ${bookingData.paymentMethod === 'bank' ? 'Bank Transfer' : 'Credit Card'}</div>
    </div>

    <div class="stamp">
        <strong>BOOKING CONFIRMED</strong><br>
        The deposit for the coordination service will be deducted from the total treatment at the clinic.
    </div>

    <div class="notes">
        <h4>Important Information</h4>
        <ul>
            <li><strong>The service deposit will be deducted from the final treatment cost</strong> - it is not an additional cost.</li>
            <li>Payment for the complete treatment will be made directly at the clinic in Albania.</li>
            <li>KLDA Technologies O√ú provides travel coordination and booking services as an authorized partner of Albanian Dental Clinic.</li>
            <li>The service includes: flight assistance, airport transfer, clinic booking and dedicated support.</li>
            <li>For any questions: ${KLDA_COMPANY.email} | ${KLDA_COMPANY.phone}</li>
        </ul>
    </div>

    <div class="footer">
        <p><strong>${KLDA_COMPANY.name}</strong> | Reg. Nr: ${KLDA_COMPANY.regNumber}${KLDA_COMPANY.vatNumber ? ` | VAT: ${KLDA_COMPANY.vatNumber}` : ''}</p>
        <p>${KLDA_COMPANY.address}, ${KLDA_COMPANY.country}</p>
        <p>Bank: ${KLDA_COMPANY.bank} | IBAN: ${KLDA_COMPANY.iban} | BIC: ${KLDA_COMPANY.bic}</p>
        <p style="margin-top: 15px; color: #10b981;">Document generated automatically - ${KLDA_COMPANY.website}</p>
    </div>
</body>
</html>`;
}

// ========================================
// EMAIL CONFIRMATION SYSTEM
// ========================================
async function sendBookingConfirmationEmail(bookingData) {
    const invoiceHTML = generateInvoiceHTML(bookingData);

    // Send via webhook (Zapier/Make/n8n can process and send email)
    const emailPayload = {
        to: bookingData.email,
        subject: `Booking Confirmation ${bookingData.bookingId} - Albanian Dental Clinic`,
        bookingId: bookingData.bookingId,
        customerName: bookingData.name,
        customerEmail: bookingData.email,
        customerPhone: bookingData.phone,
        paymentMethod: bookingData.paymentMethod,
        amount: 100,
        currency: 'EUR',
        invoiceHTML: invoiceHTML,
        timestamp: new Date().toISOString(),
        // Plain text version for email
        textContent: `
Dear ${bookingData.name},

Thank you for confirming your booking at Albanian Dental Clinic!

BOOKING DETAILS:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Booking Number: ${bookingData.bookingId}
Amount Paid: ‚Ç¨100.00
Payment Method: ${bookingData.paymentMethod === 'bank' ? 'Bank Transfer' : 'Credit Card'}
Date: ${formatDateIT(new Date())}

NEXT STEPS:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
1. You will receive a call from our team within 24-48 hours to confirm the details
2. We will help you organize your trip to Tirana (flights, transfer, accommodation)
3. Upon arrival at the clinic, the service deposit will be deducted from the total treatment cost

COORDINATION SERVICE INCLUDES:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚Ä¢ Flight booking assistance
‚Ä¢ Airport transfer coordination
‚Ä¢ Accommodation organization
‚Ä¢ Clinic appointment booking
‚Ä¢ Dedicated support throughout your trip

PAYMENT INFORMATION:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Payment received by: KLDA Technologies O√ú
Authorized partner of Albanian Dental Clinic
Reg. Nr: ${KLDA_COMPANY.regNumber}
VAT: ${KLDA_COMPANY.vatNumber}

The service deposit will be DEDUCTED from the final treatment cost at the clinic.

CONTACTS:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Email: ${KLDA_COMPANY.email}
WhatsApp: ${KLDA_COMPANY.phone}
Website: ${KLDA_COMPANY.website}

Thank you for your trust!
The Albanian Dental Clinic Team
        `
    };

    try {
        // Send to webhook for email processing
        // Replace with your actual webhook URL (Zapier, Make, etc.)
        const webhookUrl = 'https://hooks.zapier.com/hooks/catch/YOUR_ZAPIER_WEBHOOK_ID';

        // For now, log the email data (webhook integration to be configured)
        console.log('üìß Email confirmation prepared:', emailPayload);

        // Uncomment when webhook is configured:
        // const response = await fetch(webhookUrl, {
        //     method: 'POST',
        //     headers: { 'Content-Type': 'application/json' },
        //     body: JSON.stringify(emailPayload)
        // });

        return { success: true, emailPayload };
    } catch (error) {
        console.error('‚ùå Error preparing confirmation email:', error);
        return { success: false, error };
    }
}

// ========================================
// WISE PAYMENT INTEGRATION
// ========================================

// Wise Business Account Details
// IBAN: BE41 9055 2686 5510
// BIC: TRWIBEB1XXX
// Account: KLDA Technologies O√ú

// Current deposit amount (user editable, default 0)
let currentDepositAmount = 0;
let wisePaymentInitiated = false;

// Update deposit amount from input field
function updateDepositAmount(value) {
    const amount = Math.max(0, parseInt(value) || 0);
    currentDepositAmount = amount;

    // Update Wise button display
    const wiseDisplay = document.getElementById('wise-amount-display');
    if (wiseDisplay) {
        wiseDisplay.textContent = amount > 0 ? `‚Ç¨${amount}` : '‚Ç¨0';
    }

    // Hide warning when amount is valid (> 0)
    const warningEl = document.getElementById('deposit-warning');
    if (warningEl && amount > 0) {
        warningEl.style.display = 'none';
    }

    // Store in booking state
    if (typeof bookingState !== 'undefined') {
        bookingState.depositAmount = amount;
    }

    console.log('üí∞ Deposit amount updated:', amount);
}

// Get current deposit amount
function getDepositAmount() {
    return currentDepositAmount;
}

// Initiate Wise Payment
async function initiateWisePayment() {
    const fullName = document.getElementById('booking-name').value.trim();
    const email = document.getElementById('booking-email').value.trim();
    const phone = document.getElementById('booking-phone').value.trim();
    const depositAmount = getDepositAmount();

    if (!fullName || !email) {
        const warningEl = document.getElementById('deposit-warning');
        if (warningEl) {
            warningEl.innerHTML = '<i class="fas fa-exclamation-circle"></i> Please fill in your personal details before proceeding to payment.';
            warningEl.style.display = 'flex';
            warningEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        goToBookingStep(2);
        return;
    }

    // Validate legal checkboxes
    if (!document.getElementById('accept-terms').checked ||
        !document.getElementById('accept-privacy').checked ||
        !document.getElementById('accept-deposit').checked) {
        const legalWarningEl = document.getElementById('legal-warning');
        if (legalWarningEl) {
            legalWarningEl.style.display = 'flex';
            legalWarningEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        return;
    }

    if (depositAmount < 1) {
        const warningEl = document.getElementById('deposit-warning');
        if (warningEl) {
            warningEl.innerHTML = '<i class="fas fa-exclamation-circle"></i> Enter a valid amount to proceed with payment.';
            warningEl.style.display = 'flex';
            warningEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        document.getElementById('deposit-amount-input').focus();
        return;
    }

    // Generate booking ID
    const bookingId = generateBookingId();
    bookingState.bookingId = bookingId;
    bookingState.depositAmount = depositAmount;

    console.log('üí≥ Initiating Wise payment:', {
        bookingId,
        amount: depositAmount,
        customer: { name: fullName, email, phone }
    });

    // Store booking data in localStorage
    const bookingData = {
        bookingId: bookingId,
        name: fullName,
        email: email,
        phone: phone,
        amount: depositAmount,
        paymentMethod: 'card',
        timestamp: new Date().toISOString()
    };
    localStorage.setItem('pendingBooking', JSON.stringify(bookingData));

    // Send partial lead to CRM before redirecting
    try {
        await sendPartialLeadToCRM();
    } catch (e) {
        console.error('Error sending partial lead:', e);
    }

    // Build Wise payment request URL
    // Wise Pay link format: https://wise.com/pay/business/kldatechnologiesou
    const wisePayUrl = `https://wise.com/pay/business/kldatechnologiesou?amount=${depositAmount}&currency=EUR&description=Prenotazione%20CDA%20${bookingId}`;

    console.log('üîó Opening Wise payment:', wisePayUrl);
    console.log('üí∞ Amount to pay: ‚Ç¨' + depositAmount);

    // Mark payment as initiated
    wisePaymentInitiated = true;

    // Show confirmation checkbox
    const confirmBox = document.getElementById('card-payment-confirmation');
    if (confirmBox) {
        confirmBox.style.display = 'block';
    }

    // Open Wise in new tab
    window.open(wisePayUrl, '_blank');

    // Update button to show "Riapri Wise" for retry
    const wiseBtn = document.getElementById('wise-pay-btn');
    if (wiseBtn) {
        wiseBtn.innerHTML = '<i class="fas fa-external-link-alt"></i> Reopen Wise Payment';
    }
}

// Check if user confirmed card payment
function checkPaymentConfirmation() {
    const cardConfirmed = document.getElementById('card-payment-completed')?.checked || false;
    const receiptUploaded = bookingState.files?.receipt || false;
    const paymentMethod = bookingState.paymentMethod || 'card';

    // Enable/disable Conferma Prenotazione based on payment confirmation
    const confirmBtn = document.querySelector('.confirm-booking-btn');
    if (confirmBtn) {
        if (paymentMethod === 'card' && cardConfirmed) {
            confirmBtn.disabled = false;
            confirmBtn.classList.remove('disabled');
        } else if (paymentMethod === 'bank' && receiptUploaded) {
            confirmBtn.disabled = false;
            confirmBtn.classList.remove('disabled');
        } else {
            confirmBtn.disabled = true;
            confirmBtn.classList.add('disabled');
        }
    }

    console.log('üîÑ Payment confirmation check:', { paymentMethod, cardConfirmed, receiptUploaded });
}

// ========================================
// UPDATE BANK REFERENCE DYNAMICALLY
// ========================================
function updateBankReference() {
    const fullName = document.getElementById('booking-name').value.trim() || '[TUO NOME]';
    const bookingId = bookingState.bookingId || generateBookingId();
    bookingState.bookingId = bookingId;

    const reference = generatePaymentReference(bookingId, fullName);
    const referenceElement = document.getElementById('bank-reference');
    if (referenceElement) {
        referenceElement.textContent = reference;
    }

    return { bookingId, reference };
}

function validateCurrentStep() {
    const step = bookingState.currentStep;

    if (step === 1) {
        // Quote is optional - user can proceed with "Da concordare"
        // No validation required for step 1
    }

    if (step === 2) {
        const name = document.getElementById('booking-name').value.trim();
        const email = document.getElementById('booking-email').value.trim();
        const phone = document.getElementById('booking-phone').value.trim();

        if (!name) {
            alert('Please enter your name.');
            document.getElementById('booking-name').focus();
            return false;
        }
        if (!email || !email.includes('@')) {
            alert('Please enter a valid email.');
            document.getElementById('booking-email').focus();
            return false;
        }
        if (!phone) {
            alert('Please enter your phone number.');
            document.getElementById('booking-phone').focus();
            return false;
        }
    }

    return true;
}

// ========================================
// FILE UPLOAD
// ========================================
function handleFileUpload(type, input) {
    const file = input.files[0];
    if (!file) return;

    // Validate file size (10MB max)
    if (file.size > 10 * 1024 * 1024) {
        alert('The file is too large. Maximum 10MB.');
        input.value = '';
        return;
    }

    // Validate file type
    const validTypes = ['application/pdf', 'image/jpeg', 'image/jpg', 'image/png'];
    if (!validTypes.includes(file.type)) {
        alert('File format not supported. Use PDF, JPG or PNG.');
        input.value = '';
        return;
    }

    // Store file reference
    bookingState.files[type] = file;

    // Update UI
    document.getElementById(`${type}-placeholder`).style.display = 'none';
    document.getElementById(`${type}-preview`).style.display = 'flex';
    document.getElementById(`${type}-filename`).textContent = file.name;
    document.getElementById(`${type}-upload-zone`).classList.add('has-file');

    // Track upload
    if (typeof gtag === 'function') {
        gtag('event', 'file_upload', {
            'event_category': 'Booking',
            'file_type': type,
            'file_name': file.name
        });
    }

    // If receipt uploaded, check payment confirmation
    if (type === 'receipt') {
        checkPaymentConfirmation();
    }

    console.log(`‚úÖ File uploaded: ${type} - ${file.name}`);
}

function removeFile(type) {
    bookingState.files[type] = null;
    document.getElementById(`${type}-file`).value = '';
    document.getElementById(`${type}-placeholder`).style.display = 'flex';
    document.getElementById(`${type}-preview`).style.display = 'none';
    document.getElementById(`${type}-upload-zone`).classList.remove('has-file');
}

// ========================================
// DATE SELECTION
// ========================================
function toggleDateInputs(show) {
    document.getElementById('date-inputs').style.display = show ? 'grid' : 'none';
}

// ========================================
// PAYMENT METHOD
// ========================================
function selectPaymentMethod(method) {
    bookingState.paymentMethod = method;

    document.getElementById('bank-details').style.display = method === 'bank' ? 'block' : 'none';
    document.getElementById('card-details').style.display = method === 'card' ? 'block' : 'none';

    // Reset confirmation states when switching methods
    const cardConfirmCheckbox = document.getElementById('card-payment-completed');
    if (cardConfirmCheckbox) {
        cardConfirmCheckbox.checked = false;
    }

    // Check payment confirmation state
    checkPaymentConfirmation();

    // Track selection
    if (typeof gtag === 'function') {
        gtag('event', 'payment_method_select', {
            'event_category': 'Booking',
            'payment_method': method
        });
    }
}

// ========================================
// COPY TO CLIPBOARD
// ========================================
function copyToClipboard(elementId) {
    const text = document.getElementById(elementId).textContent;
    navigator.clipboard.writeText(text).then(() => {
        // Show feedback
        const btn = event.target.closest('.copy-btn');
        const originalHTML = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-check"></i>';
        btn.style.color = '#22c55e';
        setTimeout(() => {
            btn.innerHTML = originalHTML;
            btn.style.color = '';
        }, 2000);
    });
}

// ========================================
// SUBMIT BOOKING
// ========================================
async function submitBooking() {
    // Validate legal checkboxes
    if (!document.getElementById('accept-terms').checked ||
        !document.getElementById('accept-privacy').checked ||
        !document.getElementById('accept-deposit').checked) {
        alert('Please accept all terms and conditions.');
        return;
    }

    // For bank transfer, require receipt
    if (bookingState.paymentMethod === 'bank' && !bookingState.files.receipt) {
        alert('Please upload the bank transfer receipt.');
        return;
    }

    // Disable submit button to prevent double submission
    const submitBtn = document.getElementById('submit-booking-btn');
    if (submitBtn) {
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Invio in corso...';
    }

    // Generate booking ID if not already done
    if (!bookingState.bookingId) {
        bookingState.bookingId = generateBookingId();
    }
    const bookingId = bookingState.bookingId;

    // Collect form data
    const fullName = document.getElementById('booking-name').value.trim();
    const nameParts = fullName.split(' ');
    const nome = nameParts[0] || '';
    const cognome = nameParts.slice(1).join(' ') || '';

    const bookingData = {
        bookingId: bookingId,
        name: fullName,
        nome: nome,
        cognome: cognome,
        email: document.getElementById('booking-email').value.trim(),
        phone: document.getElementById('booking-phone').value.trim(),
        notes: document.getElementById('booking-notes').value.trim(),
        dateOption: document.querySelector('input[name="date-option"]:checked').value,
        datePrima: document.getElementById('booking-date-prima').value,
        dateSeconda: document.getElementById('booking-date-seconda').value,
        paymentMethod: bookingState.paymentMethod,
        paymentReference: generatePaymentReference(bookingId, fullName),
        files: {
            preventivo: bookingState.files.preventivo ? bookingState.files.preventivo.name : null,
            flight: bookingState.files.flight ? bookingState.files.flight.name : null,
            receipt: bookingState.files.receipt ? bookingState.files.receipt.name : null
        },
        timestamp: new Date().toISOString()
    };

    console.log('üìã Booking submission:', bookingData);

    // ========================================
    // SEND TO CRM
    // ========================================
    try {
        const crmPayload = {
            api_key: '6fcfcf06-ba40-4d00-857e-2e684ebc09fc',
            campaign_type: 'fissa',
            platform: 'landing-page',
            source_page_index: 'https://albaniandentalclinic.com/booking',
            leads: [{
                nome: nome,
                cognome: cognome,
                telefono: bookingData.phone,
                email: bookingData.email,
                trattamento: 'Prenotazione Trattamento',
                interesse_livello: 'ALTO',
                come_conosce: 'Landing Page Booking',
                booking_type: 'prenotazione',
                booking_id: bookingId,
                payment_reference: bookingData.paymentReference,
                date_option: bookingData.dateOption,
                data_prima_seduta: bookingData.datePrima || '',
                data_seconda_seduta: bookingData.dateSeconda || '',
                payment_method: bookingData.paymentMethod,
                note_cliente: bookingData.notes,
                terms_accepted: true,
                privacy_accepted: true,
                preventivo_uploaded: !!bookingState.files.preventivo,
                flight_uploaded: !!bookingState.files.flight,
                receipt_uploaded: !!bookingState.files.receipt
            }]
        };

        console.log('üì§ Sending to CRM:', crmPayload);

        const response = await fetch('https://crm.clinicadentalealbania.it/api/v1/leads/import', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-API-Key': '6fcfcf06-ba40-4d00-857e-2e684ebc09fc'
            },
            body: JSON.stringify(crmPayload)
        });

        const result = await response.json();

        if (response.ok && result.success) {
            console.log('‚úÖ Booking sent to CRM:', result);
        } else {
            console.error('‚ö†Ô∏è CRM response error:', result);
        }
    } catch (error) {
        console.error('‚ùå Error sending booking to CRM:', error);
        // Continue anyway - tracking and success message still work
    }

    // ========================================
    // SEND CONFIRMATION EMAIL WITH INVOICE
    // ========================================
    try {
        await sendBookingConfirmationEmail(bookingData);
        console.log('üìß Confirmation email prepared for:', bookingData.email);
    } catch (error) {
        console.error('‚ùå Error preparing confirmation email:', error);
    }

    // GA4 Tracking - Lead submission (main conversion event!) WITH ATTRIBUTION
    if (typeof gtag === 'function') {
        // Get tracking params for attribution
        const bookingTrackingParams = JSON.parse(sessionStorage.getItem('trackingParams') || '{}');

        let bookingSource = 'direct';
        let bookingMedium = 'none';
        let bookingCampaign = '(not set)';

        if (bookingTrackingParams.gclid) {
            bookingSource = 'google';
            bookingMedium = 'cpc';
            bookingCampaign = bookingTrackingParams.utm_campaign || 'google_ads';
        } else if (bookingTrackingParams.fbclid) {
            bookingSource = 'facebook';
            bookingMedium = 'paid';
            bookingCampaign = bookingTrackingParams.utm_campaign || 'meta_ads';
        } else if (bookingTrackingParams.utm_source) {
            bookingSource = bookingTrackingParams.utm_source;
            bookingMedium = bookingTrackingParams.utm_medium || 'referral';
            bookingCampaign = bookingTrackingParams.utm_campaign || '(not set)';
        }

        // close_convert_lead - Lead became a customer (booked treatment)
        gtag('event', 'close_convert_lead', {
            'event_category': 'Booking',
            'event_label': 'Booking Completed',
            'booking_id': bookingId,
            'payment_method': bookingState.paymentMethod,
            'has_flight_ticket': !!bookingState.files.flight,
            'has_preventivo': !!bookingState.files.preventivo,
            'value': 100,
            'currency': 'EUR',
            // ATTRIBUTION DATA
            'traffic_source': bookingSource,
            'traffic_medium': bookingMedium,
            'traffic_campaign': bookingCampaign,
            'utm_source': bookingTrackingParams.utm_source || '',
            'utm_medium': bookingTrackingParams.utm_medium || '',
            'utm_campaign': bookingTrackingParams.utm_campaign || '',
            'gclid': bookingTrackingParams.gclid || '',
            'fbclid': bookingTrackingParams.fbclid || ''
        });
        console.log('‚úÖ GA4 close_convert_lead fired with attribution:', bookingSource, bookingMedium);

        // Enhanced Conversions data for GA4 -> Google Ads
        const enhancedConversionData = {
            'email': bookingData.email ? bookingData.email.toLowerCase().trim() : '',
            'phone_number': bookingData.phone ? bookingData.phone.replace(/[^0-9+]/g, '') : '',
            'address': {
                'first_name': nome ? nome.toLowerCase().trim() : '',
                'last_name': cognome ? cognome.toLowerCase().trim() : '',
                'country': 'IT'
            }
        };

        gtag('set', 'user_data', enhancedConversionData);
        console.log('üìä Enhanced conversion user_data set:', enhancedConversionData);
        // Google Ads receives conversion via GA4 import (close_convert_lead event)
    }

    // Meta Pixel - Lead event (PRIMARY CONVERSION)
    if (typeof fbq === 'function') {
        fbq('track', 'Lead', {
            content_name: 'Booking Completed',
            content_category: 'Step 3 - Booking',
            value: 100,
            currency: 'EUR',
            payment_method: bookingState.paymentMethod
        });

        // Also track Purchase event for booking
        fbq('track', 'Purchase', {
            content_name: 'Dental Treatment Booking',
            content_category: 'Booking',
            value: 100,
            currency: 'EUR',
            payment_method: bookingState.paymentMethod
        });
    }

    // DataLayer push for GTM
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        event: 'close_convert_lead',
        lead_type: 'booking',
        payment_method: bookingState.paymentMethod,
        value: 100
    });

    console.log('üìä Tracking: close_convert_lead - Booking Completed (‚Ç¨100 conversion)');

    // Re-enable button
    if (submitBtn) {
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<i class="fas fa-check-circle"></i> Confirm Booking';
    }

    // Show success
    showBookingSuccess();
}

function showBookingSuccess() {
    document.querySelectorAll('.booking-step-content').forEach(el => el.style.display = 'none');
    document.querySelector('.booking-progress').style.display = 'none';
    document.querySelector('.booking-clinic-info').style.display = 'none';
    document.getElementById('booking-success').style.display = 'block';
}

// ========================================
// LEGAL MODALS (Placeholder)
// ========================================
function openLegalModal(type) {
    event.preventDefault();
    // Open terms/privacy page in new tab
    const url = type === 'terms' ? 'terms-conditions.html' : 'privacy-policy.html';
    window.open(url, '_blank');
}

// ========================================
// DRAG & DROP SUPPORT
// ========================================
['preventivo', 'flight', 'receipt'].forEach(type => {
    const zone = document.getElementById(`${type}-upload-zone`);
    if (!zone) return;

    zone.addEventListener('dragover', (e) => {
        e.preventDefault();
        zone.style.borderColor = '#22c55e';
        zone.style.background = 'rgba(34, 197, 94, 0.1)';
    });

    zone.addEventListener('dragleave', () => {
        zone.style.borderColor = '';
        zone.style.background = '';
    });

    zone.addEventListener('drop', (e) => {
        e.preventDefault();
        zone.style.borderColor = '';
        zone.style.background = '';

        const file = e.dataTransfer.files[0];
        if (file) {
            const input = document.getElementById(`${type}-file`);
            const dt = new DataTransfer();
            dt.items.add(file);
            input.files = dt.files;
            handleFileUpload(type, input);
        }
    });
});

// ========================================
// EVENT LISTENERS
// ========================================
// Close on Escape
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && document.getElementById('booking-overlay').classList.contains('active')) {
        closeBookingModal();
    }
});

// Close on overlay click
document.getElementById('booking-overlay').addEventListener('click', function(e) {
    if (e.target === this) {
        closeBookingModal();
    }
});

// Hide legal warning when all checkboxes are checked
['accept-terms', 'accept-privacy', 'accept-deposit'].forEach(id => {
    const checkbox = document.getElementById(id);
    if (checkbox) {
        checkbox.addEventListener('change', function() {
            const allChecked = document.getElementById('accept-terms').checked &&
                              document.getElementById('accept-privacy').checked &&
                              document.getElementById('accept-deposit').checked;
            const legalWarningEl = document.getElementById('legal-warning');
            if (legalWarningEl && allChecked) {
                legalWarningEl.style.display = 'none';
            }
        });
    }
});

console.log('‚úÖ Booking Modal initialized');

// FALLBACK: Add click listener directly to Step 3 elements
document.addEventListener('DOMContentLoaded', function() {
    console.log('üîß Adding fallback click handlers for Step 3...');

    // Find all booking step elements
    const bookingSteps = document.querySelectorAll('.cf-overview-step-booking');
    bookingSteps.forEach(function(step) {
        step.addEventListener('click', function(e) {
            console.log('üéØ Step 3 clicked via fallback listener');
            openBookingModal();
        });
    });

    // Find all booking buttons
    const bookingBtns = document.querySelectorAll('.cf-overview-btn-booking');
    bookingBtns.forEach(function(btn) {
        btn.addEventListener('click', function(e) {
            e.stopPropagation();
            console.log('üéØ Booking button clicked via fallback listener');
            openBookingModal();
        });
    });

    console.log('‚úÖ Fallback handlers added for ' + bookingSteps.length + ' steps and ' + bookingBtns.length + ' buttons');
});
</script>

<!-- ============================================== -->
<!-- STEP 4: TIRANA EXPERIENCE MODAL -->
<!-- ============================================== -->
<style>
/* ========================================
   STEP 4: TIRANA EXPERIENCE MODAL STYLES
======================================== */
.tirana-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(8px);
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.tirana-overlay.active {
    opacity: 1;
    visibility: visible;
}

.tirana-modal {
    background: var(--white);
    border-radius: 20px;
    width: 100%;
    max-width: 900px;
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
    animation: modalSlideIn 0.3s ease;
}

.tirana-close-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(0, 0, 0, 0.1);
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    transition: all 0.2s;
}

.tirana-close-btn:hover {
    background: rgba(0, 0, 0, 0.2);
}

.tirana-close-btn i {
    font-size: 18px;
    color: var(--gray-700);
}

/* Header */
.tirana-header {
    background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%);
    padding: 40px 30px;
    text-align: center;
    color: white;
    border-radius: 20px 20px 0 0;
    position: relative;
    overflow: hidden;
}

.tirana-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="3" fill="white" opacity="0.1"/><circle cx="80" cy="80" r="3" fill="white" opacity="0.1"/><circle cx="60" cy="30" r="2" fill="white" opacity="0.1"/></svg>');
    background-size: 100px 100px;
}

.tirana-header-icon {
    width: 70px;
    height: 70px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 15px;
    font-size: 30px;
    position: relative;
}

.tirana-header h2 {
    font-size: 1.8rem;
    font-weight: 700;
    margin: 0 0 10px;
    position: relative;
}

.tirana-header-subtitle {
    font-size: 0.95rem;
    opacity: 0.9;
    position: relative;
}

/* Tab Navigation */
.tirana-tabs {
    display: flex;
    border-bottom: 2px solid var(--gray-100);
    background: var(--gray-50);
    overflow-x: auto;
}

.tirana-tab {
    flex: 1;
    padding: 15px 20px;
    border: none;
    background: transparent;
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--gray-500);
    transition: all 0.3s;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    min-width: 100px;
    white-space: nowrap;
}

.tirana-tab i {
    font-size: 1.1rem;
}

.tirana-tab.active {
    color: #8b5cf6;
    border-bottom: 3px solid #8b5cf6;
    background: white;
}

.tirana-tab:hover:not(.active) {
    background: rgba(139, 92, 246, 0.1);
}

/* Tab Content */
.tirana-tab-content {
    display: none;
    padding: 25px;
}

.tirana-tab-content.active {
    display: block;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Place Cards */
.place-section {
    margin-bottom: 30px;
}

.place-section-title {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--gray-900);
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.place-section-title i {
    color: #8b5cf6;
}

.place-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 15px;
}

.place-card {
    background: var(--gray-50);
    border-radius: 12px;
    overflow: hidden;
    transition: all 0.3s;
    cursor: pointer;
}

.place-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
}

.place-card-image {
    height: 140px;
    background-size: cover;
    background-position: center;
    position: relative;
}

.place-card-rating {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background: white;
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 4px;
}

.place-card-rating i {
    color: #fbbf24;
}

.place-card-content {
    padding: 15px;
}

.place-card-name {
    font-weight: 700;
    font-size: 0.95rem;
    color: var(--gray-900);
    margin-bottom: 5px;
}

.place-card-desc {
    font-size: 0.8rem;
    color: var(--gray-500);
    margin-bottom: 10px;
    line-height: 1.4;
}

.place-card-actions {
    display: flex;
    gap: 10px;
}

.place-btn {
    flex: 1;
    padding: 8px 12px;
    border-radius: 8px;
    font-size: 0.75rem;
    font-weight: 600;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
    transition: all 0.2s;
}

.place-btn-maps {
    background: #4285F4;
    color: white;
}

.place-btn-maps:hover {
    background: #3367D6;
}

.place-btn-add {
    background: var(--gray-200);
    color: var(--gray-700);
}

.place-btn-add:hover {
    background: #8b5cf6;
    color: white;
}

.place-btn-add.added {
    background: #22c55e;
    color: white;
}

.place-btn-google {
    background: linear-gradient(135deg, #4285F4, #34A853, #FBBC05, #EA4335);
    background-size: 300% 300%;
    color: white;
    font-weight: 700;
    animation: googleGradient 3s ease infinite;
    position: relative;
    overflow: hidden;
}

@keyframes googleGradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

.place-btn-google:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 15px rgba(66, 133, 244, 0.4);
}

.place-btn-tripadvisor {
    background: #00AF87;
    color: white;
}

.place-btn-tripadvisor:hover {
    background: #009977;
}

.place-btn-web {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
}

.place-btn-web:hover {
    background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
}

/* Search indicator on card hover */
.place-card:hover::after {
    content: "üîç Click to search on Google";
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.8);
    color: white;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.7rem;
    white-space: nowrap;
    z-index: 10;
}

.place-card {
    position: relative;
}

.restaurant-card:hover::after {
    content: "üîç Search reviews";
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.8);
    color: white;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.7rem;
    white-space: nowrap;
    z-index: 10;
}

.restaurant-card {
    position: relative;
}

/* Price/Spending styling */
.place-card-price {
    font-size: 0.8rem;
    color: #16a34a;
    font-weight: 600;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 6px;
}

.place-card-price i {
    color: #22c55e;
}

.restaurant-spending {
    background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
    border-radius: 8px;
    padding: 8px 12px;
    margin-bottom: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.spending-label {
    font-size: 0.75rem;
    color: var(--gray-600);
    display: flex;
    align-items: center;
    gap: 5px;
}

.spending-label i {
    color: #16a34a;
}

.spending-amount {
    font-size: 0.9rem;
    font-weight: 700;
    color: #16a34a;
}

/* Clickable card cursor */
.restaurant-card {
    cursor: pointer;
}

/* Restaurant Cards - special styling */
.restaurant-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 15px;
}

.restaurant-card {
    background: white;
    border: 1px solid var(--gray-200);
    border-radius: 12px;
    padding: 15px;
    transition: all 0.3s;
}

.restaurant-card:hover {
    border-color: #8b5cf6;
    box-shadow: 0 5px 20px rgba(139, 92, 246, 0.15);
}

.restaurant-header {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    margin-bottom: 12px;
}

.restaurant-icon {
    width: 45px;
    height: 45px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
}

.restaurant-icon.breakfast { background: #fef3c7; color: #d97706; }
.restaurant-icon.lunch { background: #dcfce7; color: #16a34a; }
.restaurant-icon.dinner { background: #fce7f3; color: #db2777; }

.restaurant-info h4 {
    font-size: 0.95rem;
    font-weight: 700;
    color: var(--gray-900);
    margin-bottom: 3px;
}

.restaurant-info .cuisine {
    font-size: 0.75rem;
    color: var(--gray-500);
}

.restaurant-rating {
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: 0.8rem;
    margin-bottom: 10px;
}

.restaurant-rating i { color: #fbbf24; }
.restaurant-rating span { color: var(--gray-500); }

.restaurant-price {
    font-size: 0.75rem;
    color: var(--gray-500);
}

/* Support Section */
.support-banner {
    background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
    border-radius: 16px;
    padding: 30px;
    color: white;
    text-align: center;
    margin-bottom: 25px;
}

.support-banner h3 {
    font-size: 1.4rem;
    margin-bottom: 10px;
}

.support-banner p {
    opacity: 0.9;
    font-size: 0.9rem;
    margin-bottom: 20px;
}

.support-features {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin-bottom: 25px;
}

.support-feature {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
    text-align: center;
}

.support-feature-icon {
    width: 50px;
    height: 50px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 10px;
    font-size: 1.3rem;
}

.support-feature h4 {
    font-size: 0.95rem;
    font-weight: 600;
    margin-bottom: 5px;
}

.support-feature p {
    font-size: 0.8rem;
    opacity: 0.8;
}

.support-contact-btns {
    display: flex;
    gap: 15px;
    justify-content: center;
    flex-wrap: wrap;
}

.support-contact-btn {
    padding: 14px 28px;
    border-radius: 100px;
    font-size: 0.95rem;
    font-weight: 600;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: all 0.3s;
}

.support-contact-btn.whatsapp {
    background: #25d366;
    color: white;
}

.support-contact-btn.whatsapp:hover {
    background: #128c7e;
    transform: translateY(-2px);
}

.support-contact-btn.phone {
    background: white;
    color: var(--gray-900);
}

.support-contact-btn.phone:hover {
    background: var(--gray-100);
}

/* Trip Planner */
.trip-planner {
    background: var(--gray-50);
    border-radius: 16px;
    padding: 25px;
}

.trip-planner-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.trip-planner-header h3 {
    font-size: 1.1rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 10px;
}

.trip-planner-header h3 i {
    color: #8b5cf6;
}

.trip-clear-btn {
    padding: 8px 15px;
    background: white;
    border: 1px solid var(--gray-300);
    border-radius: 8px;
    font-size: 0.8rem;
    color: var(--gray-600);
    cursor: pointer;
}

.trip-clear-btn:hover {
    border-color: #e53e3e;
    color: #e53e3e;
}

.trip-empty {
    text-align: center;
    padding: 40px 20px;
    color: var(--gray-500);
}

.trip-empty i {
    font-size: 2.5rem;
    margin-bottom: 15px;
    opacity: 0.5;
}

.trip-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.trip-item {
    background: white;
    border-radius: 10px;
    padding: 15px;
    display: flex;
    align-items: center;
    gap: 15px;
}

.trip-item-icon {
    width: 40px;
    height: 40px;
    border-radius: 10px;
    background: #f3e8ff;
    color: #8b5cf6;
    display: flex;
    align-items: center;
    justify-content: center;
}

.trip-item-info {
    flex: 1;
}

.trip-item-name {
    font-weight: 600;
    font-size: 0.9rem;
}

.trip-item-type {
    font-size: 0.75rem;
    color: var(--gray-500);
}

.trip-item-remove {
    width: 30px;
    height: 30px;
    border: none;
    background: var(--gray-100);
    border-radius: 50%;
    cursor: pointer;
    color: var(--gray-500);
}

.trip-item-remove:hover {
    background: #fee2e2;
    color: #e53e3e;
}

/* Personal Services - Subtle styling */
.personal-services {
    margin-top: 25px;
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    border-radius: 16px;
    padding: 25px;
    border: 1px solid #fbbf24;
}

.personal-services-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 15px;
}

.personal-services-header i {
    font-size: 1.5rem;
    color: #d97706;
}

.personal-services-header h4 {
    font-size: 1rem;
    font-weight: 700;
    color: #92400e;
}

.personal-services p {
    font-size: 0.85rem;
    color: #78350f;
    margin-bottom: 15px;
    line-height: 1.5;
}

.personal-services-list {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.personal-service-tag {
    background: white;
    padding: 8px 15px;
    border-radius: 100px;
    font-size: 0.8rem;
    font-weight: 500;
    color: #92400e;
    display: flex;
    align-items: center;
    gap: 6px;
}

.personal-service-tag i {
    color: #d97706;
}

/* Responsive */
@media (max-width: 768px) {
    .tirana-modal {
        max-height: 95vh;
        margin: 10px;
        border-radius: 16px;
    }

    .tirana-header {
        padding: 30px 20px;
    }

    .tirana-header h2 {
        font-size: 1.5rem;
    }

    .tirana-tab {
        padding: 12px 15px;
        font-size: 0.75rem;
    }

    .tirana-tab-content {
        padding: 20px;
    }

    .support-contact-btns {
        flex-direction: column;
    }

    .support-contact-btn {
        width: 100%;
        justify-content: center;
    }
}
</style>

<!-- Tirana Experience Modal HTML -->
<div class="tirana-overlay" id="tirana-overlay">
    <div class="tirana-modal">
        <button class="tirana-close-btn" onclick="closeTiranaModal()">
            <i class="fas fa-times"></i>
        </button>

        <!-- Header -->
        <div class="tirana-header">
            <div class="tirana-header-icon">
                <i class="fas fa-star"></i>
            </div>
            <h2>Votre Exp√©rience in Tirana</h2>
            <p class="tirana-header-subtitle">Discover the best places and enjoy your stay with our 24/7 support</p>
        </div>

        <!-- Tab Navigation -->
        <div class="tirana-tabs">
            <button class="tirana-tab active" onclick="switchTiranaTab('places')" data-tab="places">
                <i class="fas fa-map-marker-alt"></i>
                Places
            </button>
            <button class="tirana-tab" onclick="switchTiranaTab('restaurants')" data-tab="restaurants">
                <i class="fas fa-utensils"></i>
                Restaurants
            </button>
            <button class="tirana-tab" onclick="switchTiranaTab('support')" data-tab="support">
                <i class="fas fa-headset"></i>
                Support
            </button>
            <button class="tirana-tab" onclick="switchTiranaTab('planner')" data-tab="planner">
                <i class="fas fa-calendar-alt"></i>
                My Trip
            </button>
        </div>

        <!-- Tab Contents -->
        <!-- PLACES TAB -->
        <div class="tirana-tab-content active" id="tab-places">
            <div class="place-section">
                <h3 class="place-section-title"><i class="fas fa-landmark"></i> Main Attractions</h3>
                <div class="place-grid">
                    <div class="place-card" onclick="openGoogleSearch('Piazza Skanderbeg Tirana Albania')">
                        <div class="place-card-image" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-landmark" style="font-size: 3rem; color: white; opacity: 0.8;"></i>
                            <div class="place-card-rating"><i class="fas fa-star"></i> 4.7</div>
                        </div>
                        <div class="place-card-content">
                            <div class="place-card-name">Piazza Skanderbeg</div>
                            <div class="place-card-desc">The heart of Tirana with the statue of the national hero</div>
                            <div class="place-card-price"><i class="fas fa-ticket-alt"></i> Free</div>
                            <div class="place-card-actions">
                                <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Piazza Skanderbeg Tirana')">
                                    <i class="fab fa-google"></i> Search
                                </button>
                                <button class="place-btn place-btn-tripadvisor" onclick="event.stopPropagation(); openTripAdvisor('Skanderbeg Square')">
                                    <i class="fas fa-star"></i> Reviews
                                </button>
                                <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Skanderbeg+Square+Tirana')">
                                    <i class="fas fa-map"></i>
                                </button>
                                <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Piazza Skanderbeg', 'attraction', this)">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="place-card" onclick="openGoogleSearch('BunkArt Museum Tirana Albania')">
                        <div class="place-card-image" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-dungeon" style="font-size: 3rem; color: white; opacity: 0.8;"></i>
                            <div class="place-card-rating"><i class="fas fa-star"></i> 4.8</div>
                        </div>
                        <div class="place-card-content">
                            <div class="place-card-name">Bunk'Art Museum</div>
                            <div class="place-card-desc">Former nuclear bunker transformed into a history museum</div>
                            <div class="place-card-price"><i class="fas fa-ticket-alt"></i> ‚Ç¨5-8 entrance</div>
                            <div class="place-card-actions">
                                <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('BunkArt Museum Tirana')">
                                    <i class="fab fa-google"></i> Search
                                </button>
                                <button class="place-btn place-btn-tripadvisor" onclick="event.stopPropagation(); openTripAdvisor('BunkArt Museum')">
                                    <i class="fas fa-star"></i> Reviews
                                </button>
                                <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('BunkArt+Museum+Tirana')">
                                    <i class="fas fa-map"></i>
                                </button>
                                <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Bunk Art Museum', 'attraction', this)">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="place-card" onclick="openGoogleSearch('Monte Dajti Teleferica Tirana Albania')">
                        <div class="place-card-image" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-mountain" style="font-size: 3rem; color: white; opacity: 0.8;"></i>
                            <div class="place-card-rating"><i class="fas fa-star"></i> 4.6</div>
                        </div>
                        <div class="place-card-content">
                            <div class="place-card-name">Monte Dajti & Teleferica</div>
                            <div class="place-card-desc">Panoramic cable car and breathtaking views of Tirana</div>
                            <div class="place-card-price"><i class="fas fa-ticket-alt"></i> ‚Ç¨8-12 round trip</div>
                            <div class="place-card-actions">
                                <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Dajti Ekspres cable car Tirana')">
                                    <i class="fab fa-google"></i> Search
                                </button>
                                <button class="place-btn place-btn-tripadvisor" onclick="event.stopPropagation(); openTripAdvisor('Dajti Ekspres')">
                                    <i class="fas fa-star"></i> Reviews
                                </button>
                                <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Dajti+Ekspres+Tirana')">
                                    <i class="fas fa-map"></i>
                                </button>
                                <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Monte Dajti', 'attraction', this)">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="place-card" onclick="openGoogleSearch('Blloku District Tirana nightlife')">
                        <div class="place-card-image" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-cocktail" style="font-size: 3rem; color: white; opacity: 0.8;"></i>
                            <div class="place-card-rating"><i class="fas fa-star"></i> 4.5</div>
                        </div>
                        <div class="place-card-content">
                            <div class="place-card-name">Blloku District</div>
                            <div class="place-card-desc">Trendy district with bars, restaurants and nightlife</div>
                            <div class="place-card-price"><i class="fas fa-glass-cheers"></i> ‚Ç¨5-15 per drink</div>
                            <div class="place-card-actions">
                                <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Blloku Tirana nightlife bars')">
                                    <i class="fab fa-google"></i> Search
                                </button>
                                <button class="place-btn place-btn-tripadvisor" onclick="event.stopPropagation(); openTripAdvisor('Blloku Tirana')">
                                    <i class="fas fa-star"></i> Reviews
                                </button>
                                <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Blloku+Tirana')">
                                    <i class="fas fa-map"></i>
                                </button>
                                <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Blloku District', 'attraction', this)">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="place-section">
                <h3 class="place-section-title"><i class="fas fa-shopping-bag"></i> Shopping & Leisure</h3>
                <div class="place-grid">
                    <div class="place-card" onclick="openGoogleSearch('TEG Tirana East Gate shopping mall')">
                        <div class="place-card-image" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-shopping-bag" style="font-size: 3rem; color: white; opacity: 0.8;"></i>
                            <div class="place-card-rating"><i class="fas fa-star"></i> 4.4</div>
                        </div>
                        <div class="place-card-content">
                            <div class="place-card-name">TEG Shopping Center</div>
                            <div class="place-card-desc">The largest shopping center in Albania</div>
                            <div class="place-card-price"><i class="fas fa-shopping-cart"></i> Various shopping</div>
                            <div class="place-card-actions">
                                <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('TEG Tirana East Gate')">
                                    <i class="fab fa-google"></i> Search
                                </button>
                                <button class="place-btn place-btn-tripadvisor" onclick="event.stopPropagation(); openTripAdvisor('TEG Tirana')">
                                    <i class="fas fa-star"></i> Reviews
                                </button>
                                <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('TEG+Shopping+Center+Tirana')">
                                    <i class="fas fa-map"></i>
                                </button>
                                <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('TEG Shopping', 'shopping', this)">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="place-card" onclick="openGoogleSearch('Grand Park Tirana Lake artificial')">
                        <div class="place-card-image" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-tree" style="font-size: 3rem; color: white; opacity: 0.8;"></i>
                            <div class="place-card-rating"><i class="fas fa-star"></i> 4.7</div>
                        </div>
                        <div class="place-card-content">
                            <div class="place-card-name">Grand Park & Lago</div>
                            <div class="place-card-desc">Park with artificial lake, perfect for relaxation</div>
                            <div class="place-card-price"><i class="fas fa-ticket-alt"></i> Free</div>
                            <div class="place-card-actions">
                                <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Grand Park Tirana')">
                                    <i class="fab fa-google"></i> Search
                                </button>
                                <button class="place-btn place-btn-tripadvisor" onclick="event.stopPropagation(); openTripAdvisor('Grand Park Tirana')">
                                    <i class="fas fa-star"></i> Reviews
                                </button>
                                <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Grand+Park+Tirana')">
                                    <i class="fas fa-map"></i>
                                </button>
                                <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Grand Park', 'attraction', this)">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="place-card" onclick="openGoogleSearch('National History Museum Tirana Albania')">
                        <div class="place-card-image" style="background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-university" style="font-size: 3rem; color: white; opacity: 0.8;"></i>
                            <div class="place-card-rating"><i class="fas fa-star"></i> 4.5</div>
                        </div>
                        <div class="place-card-content">
                            <div class="place-card-name">National History Museum</div>
                            <div class="place-card-desc">History of Albania from antiquity to today</div>
                            <div class="place-card-price"><i class="fas fa-ticket-alt"></i> ‚Ç¨3-5 entrance</div>
                            <div class="place-card-actions">
                                <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('National History Museum Tirana')">
                                    <i class="fab fa-google"></i> Search
                                </button>
                                <button class="place-btn place-btn-tripadvisor" onclick="event.stopPropagation(); openTripAdvisor('National History Museum Tirana')">
                                    <i class="fas fa-star"></i> Reviews
                                </button>
                                <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('National+History+Museum+Tirana')">
                                    <i class="fas fa-map"></i>
                                </button>
                                <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Museo Storia', 'attraction', this)">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RESTAURANTS TAB -->
        <div class="tirana-tab-content" id="tab-restaurants">
            <div class="place-section">
                <h3 class="place-section-title"><i class="fas fa-coffee"></i> Breakfast (‚Ç¨3-15 per person)</h3>
                <div class="restaurant-grid">
                    <div class="restaurant-card" onclick="openGoogleSearch('Mon Cheri pasticceria Tirana')">
                        <div class="restaurant-header">
                            <div class="restaurant-icon breakfast"><i class="fas fa-sun"></i></div>
                            <div class="restaurant-info">
                                <h4>Mon Ch√©ri</h4>
                                <span class="cuisine">French pastry shop</span>
                            </div>
                        </div>
                        <div class="restaurant-rating">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
                            <span>4.6 (420 reviews)</span>
                        </div>
                        <div class="restaurant-spending">
                            <span class="spending-label"><i class="fas fa-euro-sign"></i> Average spend:</span>
                            <span class="spending-amount">‚Ç¨5-12</span>
                        </div>
                        <div class="place-card-actions" style="margin-top: 12px;">
                            <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Mon Cheri Tirana reviews')">
                                <i class="fab fa-google"></i> Google
                            </button>
                            <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Mon+Cheri+Tirana')">
                                <i class="fas fa-map"></i> Maps
                            </button>
                            <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Mon Ch√©ri', 'breakfast', this)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <div class="restaurant-card" onclick="openGoogleSearch('Sophie Cafe Tirana brunch')">
                        <div class="restaurant-header">
                            <div class="restaurant-icon breakfast"><i class="fas fa-sun"></i></div>
                            <div class="restaurant-info">
                                <h4>Sophie Caf√©</h4>
                                <span class="cuisine">International brunch</span>
                            </div>
                        </div>
                        <div class="restaurant-rating">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                            <span>4.8 (580 reviews)</span>
                        </div>
                        <div class="restaurant-spending">
                            <span class="spending-label"><i class="fas fa-euro-sign"></i> Average spend:</span>
                            <span class="spending-amount">‚Ç¨8-15</span>
                        </div>
                        <div class="place-card-actions" style="margin-top: 12px;">
                            <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Sophie Cafe Tirana')">
                                <i class="fab fa-google"></i> Google
                            </button>
                            <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Sophie+Cafe+Tirana')">
                                <i class="fas fa-map"></i> Maps
                            </button>
                            <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Sophie Caf√©', 'breakfast', this)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <div class="restaurant-card" onclick="openGoogleSearch('Komiteti Kafe Muzeum Tirana')">
                        <div class="restaurant-header">
                            <div class="restaurant-icon breakfast"><i class="fas fa-sun"></i></div>
                            <div class="restaurant-info">
                                <h4>Komiteti Kafe</h4>
                                <span class="cuisine">Historic caf√© with raki</span>
                            </div>
                        </div>
                        <div class="restaurant-rating">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
                            <span>4.7 (850 reviews)</span>
                        </div>
                        <div class="restaurant-spending">
                            <span class="spending-label"><i class="fas fa-euro-sign"></i> Average spend:</span>
                            <span class="spending-amount">‚Ç¨3-8</span>
                        </div>
                        <div class="place-card-actions" style="margin-top: 12px;">
                            <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Komiteti Kafe Muzeum Tirana')">
                                <i class="fab fa-google"></i> Google
                            </button>
                            <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Komiteti+Kafe+Muzeum+Tirana')">
                                <i class="fas fa-map"></i> Maps
                            </button>
                            <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Komiteti Kafe', 'breakfast', this)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="place-section">
                <h3 class="place-section-title"><i class="fas fa-hamburger"></i> Lunch (‚Ç¨8-30 per person)</h3>
                <div class="restaurant-grid">
                    <div class="restaurant-card" onclick="openGoogleSearch('Oda Restaurant Tirana traditional Albanian')">
                        <div class="restaurant-header">
                            <div class="restaurant-icon lunch"><i class="fas fa-leaf"></i></div>
                            <div class="restaurant-info">
                                <h4>Oda Restaurant</h4>
                                <span class="cuisine">Traditional Albanian cuisine</span>
                            </div>
                        </div>
                        <div class="restaurant-rating">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                            <span>4.9 (1,200 reviews)</span>
                        </div>
                        <div class="restaurant-spending">
                            <span class="spending-label"><i class="fas fa-euro-sign"></i> Average spend:</span>
                            <span class="spending-amount">‚Ç¨10-20</span>
                        </div>
                        <div class="place-card-actions" style="margin-top: 12px;">
                            <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Oda Restaurant Tirana reviews')">
                                <i class="fab fa-google"></i> Google
                            </button>
                            <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Oda+Restaurant+Tirana')">
                                <i class="fas fa-map"></i> Maps
                            </button>
                            <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Oda Restaurant', 'lunch', this)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <div class="restaurant-card" onclick="openGoogleSearch('Era Restaurant Tirana modern Albanian')">
                        <div class="restaurant-header">
                            <div class="restaurant-icon lunch"><i class="fas fa-leaf"></i></div>
                            <div class="restaurant-info">
                                <h4>Era</h4>
                                <span class="cuisine">Modern Albanian cuisine</span>
                            </div>
                        </div>
                        <div class="restaurant-rating">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
                            <span>4.7 (890 reviews)</span>
                        </div>
                        <div class="restaurant-spending">
                            <span class="spending-label"><i class="fas fa-euro-sign"></i> Average spend:</span>
                            <span class="spending-amount">‚Ç¨15-30</span>
                        </div>
                        <div class="place-card-actions" style="margin-top: 12px;">
                            <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Era Restaurant Tirana')">
                                <i class="fab fa-google"></i> Google
                            </button>
                            <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Era+Restaurant+Tirana')">
                                <i class="fas fa-map"></i> Maps
                            </button>
                            <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Era Restaurant', 'lunch', this)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <div class="restaurant-card" onclick="openGoogleSearch('Zgara Korcare Tirana BBQ')">
                        <div class="restaurant-header">
                            <div class="restaurant-icon lunch"><i class="fas fa-leaf"></i></div>
                            <div class="restaurant-info">
                                <h4>Zgara Kor√ßare</h4>
                                <span class="cuisine">Traditional grill</span>
                            </div>
                        </div>
                        <div class="restaurant-rating">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
                            <span>4.6 (650 reviews)</span>
                        </div>
                        <div class="restaurant-spending">
                            <span class="spending-label"><i class="fas fa-euro-sign"></i> Average spend:</span>
                            <span class="spending-amount">‚Ç¨8-18</span>
                        </div>
                        <div class="place-card-actions" style="margin-top: 12px;">
                            <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Zgara Korcare Tirana')">
                                <i class="fab fa-google"></i> Google
                            </button>
                            <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Zgara+Korcare+Tirana')">
                                <i class="fas fa-map"></i> Maps
                            </button>
                            <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Zgara Kor√ßare', 'lunch', this)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="place-section">
                <h3 class="place-section-title"><i class="fas fa-moon"></i> Dinner (‚Ç¨15-60 per person)</h3>
                <div class="restaurant-grid">
                    <div class="restaurant-card" onclick="openGoogleSearch('Mullixhiu Restaurant Tirana fine dining')">
                        <div class="restaurant-header">
                            <div class="restaurant-icon dinner"><i class="fas fa-wine-glass-alt"></i></div>
                            <div class="restaurant-info">
                                <h4>Mullixhiu</h4>
                                <span class="cuisine">Albanian fine dining</span>
                            </div>
                        </div>
                        <div class="restaurant-rating">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                            <span>4.9 (650 reviews)</span>
                        </div>
                        <div class="restaurant-spending">
                            <span class="spending-label"><i class="fas fa-euro-sign"></i> Average spend:</span>
                            <span class="spending-amount">‚Ç¨35-60</span>
                        </div>
                        <div class="place-card-actions" style="margin-top: 12px;">
                            <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Mullixhiu Restaurant Tirana')">
                                <i class="fab fa-google"></i> Google
                            </button>
                            <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Mullixhiu+Restaurant+Tirana')">
                                <i class="fas fa-map"></i> Maps
                            </button>
                            <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Mullixhiu', 'dinner', this)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <div class="restaurant-card" onclick="openGoogleSearch('Marche Restaurant Tirana rooftop')">
                        <div class="restaurant-header">
                            <div class="restaurant-icon dinner"><i class="fas fa-wine-glass-alt"></i></div>
                            <div class="restaurant-info">
                                <h4>March√©</h4>
                                <span class="cuisine">International cuisine</span>
                            </div>
                        </div>
                        <div class="restaurant-rating">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
                            <span>4.6 (520 reviews)</span>
                        </div>
                        <div class="restaurant-spending">
                            <span class="spending-label"><i class="fas fa-euro-sign"></i> Average spend:</span>
                            <span class="spending-amount">‚Ç¨20-40</span>
                        </div>
                        <div class="place-card-actions" style="margin-top: 12px;">
                            <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Marche Restaurant Tirana')">
                                <i class="fab fa-google"></i> Google
                            </button>
                            <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Marche+Restaurant+Tirana')">
                                <i class="fas fa-map"></i> Maps
                            </button>
                            <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('March√©', 'dinner', this)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <div class="restaurant-card" onclick="openGoogleSearch('Juvenilja Restaurant Tirana seafood')">
                        <div class="restaurant-header">
                            <div class="restaurant-icon dinner"><i class="fas fa-wine-glass-alt"></i></div>
                            <div class="restaurant-info">
                                <h4>Juvenilja</h4>
                                <span class="cuisine">Fish and seafood</span>
                            </div>
                        </div>
                        <div class="restaurant-rating">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                            <span>4.8 (380 reviews)</span>
                        </div>
                        <div class="restaurant-spending">
                            <span class="spending-label"><i class="fas fa-euro-sign"></i> Average spend:</span>
                            <span class="spending-amount">‚Ç¨25-50</span>
                        </div>
                        <div class="place-card-actions" style="margin-top: 12px;">
                            <button class="place-btn place-btn-google" onclick="event.stopPropagation(); openGoogleSearch('Juvenilja Restaurant Tirana')">
                                <i class="fab fa-google"></i> Google
                            </button>
                            <button class="place-btn place-btn-maps" onclick="event.stopPropagation(); openGoogleMaps('Juvenilja+Restaurant+Tirana')">
                                <i class="fas fa-map"></i> Maps
                            </button>
                            <button class="place-btn place-btn-add" onclick="event.stopPropagation(); addToTrip('Juvenilja', 'dinner', this)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SUPPORT TAB -->
        <div class="tirana-tab-content" id="tab-support">
            <div class="support-banner">
                <h3><i class="fas fa-shield-alt"></i> 24/7 Support Guaranteed</h3>
                <p>Our team is at your disposal at all times during your stay in Tirana</p>
            </div>

            <div class="support-features">
                <div class="support-feature">
                    <div class="support-feature-icon"><i class="fas fa-headset"></i></div>
                    <h4>Phone Support</h4>
                    <p>English assistance 24 hours a day</p>
                </div>
                <div class="support-feature">
                    <div class="support-feature-icon"><i class="fas fa-car"></i></div>
                    <h4>Airport Transfer</h4>
                    <p>We pick you up at the airport</p>
                </div>
                <div class="support-feature">
                    <div class="support-feature-icon"><i class="fas fa-concierge-bell"></i></div>
                    <h4>Personal Concierge</h4>
                    <p>Dedicated assistant for every need</p>
                </div>
                <div class="support-feature">
                    <div class="support-feature-icon"><i class="fas fa-first-aid"></i></div>
                    <h4>Medical Emergencies</h4>
                    <p>Emergency response when needed</p>
                </div>
            </div>

            <div class="support-contact-btns">
                <a href="https://wa.me/37254450188" target="_blank" class="support-contact-btn whatsapp" onclick="trackTiranaWhatsApp()">
                    <i class="fab fa-whatsapp"></i> Contact on WhatsApp
                </a>
                <a href="tel:+37254450188" class="support-contact-btn phone" onclick="trackTiranaPhone()">
                    <i class="fas fa-phone"></i> Call Now
                </a>
            </div>

            <!-- Personal Services - Subtle -->
            <div class="personal-services">
                <div class="personal-services-header">
                    <i class="fas fa-crown"></i>
                    <h4>Premium Services on Request</h4>
                </div>
                <p>For our patients who want an exclusive experience, we offer personalized services to make your stay even more comfortable and safe.</p>
                <div class="personal-services-list">
                    <span class="personal-service-tag"><i class="fas fa-user-tie"></i> Personal companion</span>
                    <span class="personal-service-tag"><i class="fas fa-car"></i> Car with driver</span>
                    <span class="personal-service-tag"><i class="fas fa-shield-alt"></i> Security service</span>
                    <span class="personal-service-tag"><i class="fas fa-concierge-bell"></i> Exclusive reservations</span>
                    <span class="personal-service-tag"><i class="fas fa-language"></i> Dedicated interpreter</span>
                </div>
            </div>
        </div>

        <!-- PLANNER TAB -->
        <div class="tirana-tab-content" id="tab-planner">
            <div class="trip-planner">
                <div class="trip-planner-header">
                    <h3><i class="fas fa-route"></i> Your Itinerary</h3>
                    <button class="trip-clear-btn" onclick="clearTripPlanner()">
                        <i class="fas fa-trash"></i> Clear
                    </button>
                </div>
                <div id="trip-list-container">
                    <div class="trip-empty" id="trip-empty">
                        <i class="fas fa-map-marked-alt"></i>
                        <p>No places added yet.<br>Explore the Places and Restaurants tabs to create your itinerary!</p>
                    </div>
                    <div class="trip-list" id="trip-list" style="display: none;"></div>
                </div>
            </div>

            <div style="margin-top: 25px; text-align: center;">
                <a href="https://wa.me/37254450188?text=Hello!%20I%20planned%20my%20itinerary%20in%20Tirana%20and%20would%20like%20assistance."
                   target="_blank"
                   class="support-contact-btn whatsapp"
                   onclick="trackTiranaItinerary()">
                    <i class="fab fa-whatsapp"></i> Send Itinerary to ADC Team
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Tirana Experience JavaScript -->
<script>
// ========================================
// STEP 4: TIRANA EXPERIENCE FUNCTIONALITY
// ========================================

let tiranaTrip = [];

function openTiranaModal() {
    document.getElementById('tirana-overlay').classList.add('active');
    document.body.style.overflow = 'hidden';

    // GA4 Tracking - popup_open event
    if (typeof gtag === 'function') {
        gtag('event', 'popup_open', {
            'event_category': 'Modal',
            'event_label': 'Tirana Experience',
            'modal_name': 'tirana_experience',
            'step': 4
        });
    }

    // Meta Pixel - ViewContent
    if (typeof fbq === 'function') {
        fbq('track', 'ViewContent', {
            content_name: 'Tirana Experience',
            content_category: 'Step 4 - Tourism'
        });
    }

    console.log('üìä Tracking: popup_open - Tirana Experience');
}

function closeTiranaModal() {
    document.getElementById('tirana-overlay').classList.remove('active');
    document.body.style.overflow = '';

    // GA4 Tracking - popup_close event
    if (typeof gtag === 'function') {
        gtag('event', 'popup_close', {
            'event_category': 'Modal',
            'event_label': 'Tirana Experience',
            'modal_name': 'tirana_experience',
            'step': 4,
            'places_added': tiranaTrip.length
        });
    }

    console.log('üìä Tracking: popup_close - Tirana Experience');
}

function switchTiranaTab(tabId) {
    // Update tab buttons
    document.querySelectorAll('.tirana-tab').forEach(tab => tab.classList.remove('active'));
    document.querySelector(`.tirana-tab[data-tab="${tabId}"]`).classList.add('active');

    // Update tab content
    document.querySelectorAll('.tirana-tab-content').forEach(content => content.classList.remove('active'));
    document.getElementById(`tab-${tabId}`).classList.add('active');

    // Track tab switch
    if (typeof gtag === 'function') {
        gtag('event', 'element_click', {
            'event_category': 'Tirana Experience',
            'event_label': 'Tab Switch',
            'tab_name': tabId
        });
    }
}

function openGoogleMaps(place) {
    const url = `https://www.google.com/maps/search/${encodeURIComponent(place)}`;
    window.open(url, '_blank');

    // Track click
    if (typeof gtag === 'function') {
        gtag('event', 'outbound_click', {
            'event_category': 'Tirana Experience',
            'event_label': 'Google Maps',
            'place': place
        });
    }
}

function openGoogleSearch(query) {
    const url = `https://www.google.com/search?q=${encodeURIComponent(query)}`;
    window.open(url, '_blank');

    // Track click
    if (typeof gtag === 'function') {
        gtag('event', 'outbound_click', {
            'event_category': 'Tirana Experience',
            'event_label': 'Google Search',
            'search_query': query
        });
    }

    // Meta Pixel tracking
    if (typeof fbq === 'function') {
        fbq('track', 'Search', {
            content_category: 'Tirana Experience',
            search_string: query
        });
    }
}

function openGoogleImages(query) {
    const url = `https://www.google.com/search?tbm=isch&q=${encodeURIComponent(query)}`;
    window.open(url, '_blank');

    // Track click
    if (typeof gtag === 'function') {
        gtag('event', 'outbound_click', {
            'event_category': 'Tirana Experience',
            'event_label': 'Google Images',
            'search_query': query
        });
    }
}

function openTripAdvisor(query) {
    const url = `https://www.tripadvisor.com/Search?q=${encodeURIComponent(query + ' Tirana')}`;
    window.open(url, '_blank');

    // Track click
    if (typeof gtag === 'function') {
        gtag('event', 'outbound_click', {
            'event_category': 'Tirana Experience',
            'event_label': 'TripAdvisor',
            'search_query': query
        });
    }

    // Meta Pixel tracking
    if (typeof fbq === 'function') {
        fbq('track', 'Search', {
            content_category: 'Tirana Experience - TripAdvisor',
            search_string: query
        });
    }
}

function openGoogleReviews(query) {
    const url = `https://www.google.com/search?q=${encodeURIComponent(query + ' reviews')}`;
    window.open(url, '_blank');

    // Track click
    if (typeof gtag === 'function') {
        gtag('event', 'outbound_click', {
            'event_category': 'Tirana Experience',
            'event_label': 'Google Reviews',
            'search_query': query
        });
    }
}

function addToTrip(name, type, btn) {
    // Check if already added
    const existingIndex = tiranaTrip.findIndex(item => item.name === name);
    if (existingIndex >= 0) {
        // Remove from trip
        tiranaTrip.splice(existingIndex, 1);
        btn.classList.remove('added');
        btn.innerHTML = '<i class="fas fa-plus"></i> Add';
    } else {
        // Add to trip
        tiranaTrip.push({ name, type, addedAt: new Date() });
        btn.classList.add('added');
        btn.innerHTML = '<i class="fas fa-check"></i> Added';
    }

    // Update planner UI
    updateTripPlanner();

    // Track action
    if (typeof gtag === 'function') {
        gtag('event', 'element_click', {
            'event_category': 'Tirana Experience',
            'event_label': existingIndex >= 0 ? 'Remove from Trip' : 'Add to Trip',
            'place_name': name,
            'place_type': type
        });
    }
}

function updateTripPlanner() {
    const emptyEl = document.getElementById('trip-empty');
    const listEl = document.getElementById('trip-list');

    if (tiranaTrip.length === 0) {
        emptyEl.style.display = 'block';
        listEl.style.display = 'none';
    } else {
        emptyEl.style.display = 'none';
        listEl.style.display = 'flex';

        const icons = {
            'attraction': 'fa-landmark',
            'shopping': 'fa-shopping-bag',
            'breakfast': 'fa-coffee',
            'lunch': 'fa-utensils',
            'dinner': 'fa-wine-glass-alt'
        };

        listEl.innerHTML = tiranaTrip.map((item, index) => `
            <div class="trip-item">
                <div class="trip-item-icon">
                    <i class="fas ${icons[item.type] || 'fa-map-marker-alt'}"></i>
                </div>
                <div class="trip-item-info">
                    <div class="trip-item-name">${item.name}</div>
                    <div class="trip-item-type">${item.type}</div>
                </div>
                <button class="trip-item-remove" onclick="removeFromTrip(${index})">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        `).join('');
    }
}

function removeFromTrip(index) {
    const removedItem = tiranaTrip[index];
    tiranaTrip.splice(index, 1);
    updateTripPlanner();

    // Update any "Aggiungi" buttons
    document.querySelectorAll('.place-btn-add').forEach(btn => {
        if (btn.onclick && btn.onclick.toString().includes(removedItem.name)) {
            btn.classList.remove('added');
            btn.innerHTML = '<i class="fas fa-plus"></i> Add';
        }
    });
}

function clearTripPlanner() {
    tiranaTrip = [];
    updateTripPlanner();

    // Reset all buttons
    document.querySelectorAll('.place-btn-add').forEach(btn => {
        btn.classList.remove('added');
        btn.innerHTML = '<i class="fas fa-plus"></i> Add';
    });

    // Track
    if (typeof gtag === 'function') {
        gtag('event', 'element_click', {
            'event_category': 'Tirana Experience',
            'event_label': 'Clear Trip Planner'
        });
    }
}

function trackTiranaWhatsApp() {
    if (typeof gtag === 'function') {
        gtag('event', 'click_whatsapp', {
            'event_category': 'Tirana Experience',
            'event_label': 'Support Contact'
        });
    }
    if (typeof fbq === 'function') {
        fbq('track', 'Contact', {
            content_name: 'Tirana Support',
            content_category: 'Step 4 - Tourism'
        });
    }
}

function trackTiranaPhone() {
    if (typeof gtag === 'function') {
        gtag('event', 'click_phone', {
            'event_category': 'Tirana Experience',
            'event_label': 'Support Contact'
        });
    }
}

function trackTiranaItinerary() {
    if (typeof gtag === 'function') {
        // Get tracking params for attribution
        const tiranaTrackingParams = JSON.parse(sessionStorage.getItem('trackingParams') || '{}');

        let tiranaSource = 'direct';
        let tiranaMedium = 'none';

        if (tiranaTrackingParams.gclid) {
            tiranaSource = 'google';
            tiranaMedium = 'cpc';
        } else if (tiranaTrackingParams.fbclid) {
            tiranaSource = 'facebook';
            tiranaMedium = 'paid';
        } else if (tiranaTrackingParams.utm_source) {
            tiranaSource = tiranaTrackingParams.utm_source;
            tiranaMedium = tiranaTrackingParams.utm_medium || 'referral';
        }

        gtag('event', 'working_lead', {
            'event_category': 'Tirana Experience',
            'event_label': 'Itinerary Sent',
            'places_count': tiranaTrip.length,
            // ATTRIBUTION DATA
            'traffic_source': tiranaSource,
            'traffic_medium': tiranaMedium,
            'utm_source': tiranaTrackingParams.utm_source || '',
            'utm_medium': tiranaTrackingParams.utm_medium || '',
            'gclid': tiranaTrackingParams.gclid || '',
            'fbclid': tiranaTrackingParams.fbclid || ''
        });
        console.log('‚úÖ GA4 working_lead fired with attribution:', tiranaSource, tiranaMedium);
    }
    if (typeof fbq === 'function') {
        fbq('track', 'Lead', {
            content_name: 'Itinerary Request',
            content_category: 'Step 4 - Tourism'
        });
    }
}

// Close on Escape
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && document.getElementById('tirana-overlay').classList.contains('active')) {
        closeTiranaModal();
    }
});

// Close on overlay click
document.getElementById('tirana-overlay').addEventListener('click', function(e) {
    if (e.target === this) {
        closeTiranaModal();
    }
});

console.log('‚úÖ Tirana Experience Modal initialized');
</script>

<!-- Cookie banner removed per user request -->

</body>
</html>
